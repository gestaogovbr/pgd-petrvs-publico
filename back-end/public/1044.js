"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[1044],{1044:(Qa,R,r)=>{r.r(R),r.d(R,{ProgramaModule:()=>Va});var f=r(6610),C=r(8069),m=r(1620),p=r(6819),u=r(3308),_=r(1641),b=r(5374),Y=r(7055),U=r(3283),V=r(9047),Q=r(1508),G=r(3535),v=r(9357),N=r(24),w=r(2736),a=r(3279),H=r(114),y=r(9226),X=r(4402),D=r(16),O=r(5524),S=r(3678),J=r(1230),Z=r(2075),q=r(6774),W=r(8857),K=r(368);const x=["unidade"],aa=["tipoAvaliacao"],ea=()=>({instituidora:!0}),ta=i=>({filter:i}),oa=()=>["especie","==","TCR"],ia=i=>[i],na=()=>["SEMANAL","QUINZENAL"],la=()=>["MENSAL","BIMESTRAL","TRIMESTRAL","SEMESTRAL"],ra=()=>["DIAS"];function sa(i,s){if(1&i&&a.nrm(0,"input-select",36),2&i){const t=a.XpG();a.Y8G("size",3)("control",t.form.controls.periodicidade_valor)("items",t.lookup.DIA_SEMANA)}}function da(i,s){if(1&i&&a.nrm(0,"input-number",37),2&i){const t=a.XpG();a.Y8G("size",3)("control",t.form.controls.periodicidade_valor)}}function ua(i,s){if(1&i&&a.nrm(0,"input-number",38),2&i){const t=a.XpG();a.Y8G("size",3)("control",t.form.controls.periodicidade_valor)}}let I=(()=>{class i extends N.n{constructor(t){super(t,v.Y,b.X),this.injector=t,this._tipoAvaliacaoQualitativo=[],this.validate=(o,e)=>{let n=null;return["nome","unidade_id","tipo_avaliacao_plano_trabalho_id","tipo_avaliacao_plano_entrega_id"].indexOf(e)>=0&&!o.value?.length?n="Obrigat\xf3rio":"prazo_max_plano_entrega"==e&&parseInt(o.value||0)>99999?n="Inv\xe1lido":"dias_tolerancia_consolidacao"==e&&parseInt(o.value||0)>10?n="Inv\xe1lido. M\xe1ximo 10 dias":["data_inicio","data_fim"].indexOf(e)>=0&&!this.dao?.validDateTime(o.value)?n="Inv\xe1lido":"periodicidade_valor"==e&&(["SEMANAL","QUINZENAL"].includes(this.form?.controls.periodicidade_consolidacao.value)&&o.value>6&&(n="Inv\xe1lido"),["MENSAL","BIMESTRAL","TRIMESTRAL","SEMESTRAL"].includes(this.form?.controls.periodicidade_consolidacao.value)&&o.value>31&&(n="M\xe1ximo 31"),["DIAS"].includes(this.form?.controls.periodicidade_consolidacao.value)&&o.value<0&&(n="Inv\xe1lido")),n},this.formValidation=o=>{let e=null;return this.form?.controls.data_fim.value&&this.form?.controls.data_inicio.value>this.form?.controls.data_fim.value?e="A data do fim n\xe3o pode ser anterior \xe0 data do inicio!":this.form?.controls.data_fim.value==this.form?.controls.data_inicio.value&&(e="A data do fim n\xe3o pode ser igual \xe0 data do inicio!"),e},this.titleEdit=o=>"Editando "+this.lex.translate("Programa")+": "+(o?.nome||""),this.unidadeDao=t.get(G.s),this.templateDao=t.get(Y.Q),this.tipoDocumentoDao=t.get(V.Y),this.tipoAvaliacaoDao=t.get(U.h),this.tipoJustificativaDao=t.get(Q.s),this.templateService=t.get(w.I),this.modalWidth=700,this.form=this.fh.FormBuilder({unidade_id:{default:""},nome:{default:""},normativa:{default:""},link_normativa:{default:null},link_autorizacao:{default:null},config:{default:null},data_inicio:{default:new Date},data_fim:{default:new Date},template_tcr_id:{default:null},tipo_avaliacao_plano_entrega_id:{default:""},tipo_avaliacao_plano_trabalho_id:{default:""},tipo_documento_tcr_id:{default:null},prazo_max_plano_entrega:{default:365},termo_obrigatorio:{default:!0},periodicidade_consolidacao:{default:"MENSAL"},periodicidade_valor:{default:1},dias_tolerancia_consolidacao:{default:10},registra_comparecimento:{default:!0},plano_trabalho_assinatura_participante:{default:!0},plano_trabalho_assinatura_gestor_lotacao:{default:!0},plano_trabalho_assinatura_gestor_unidade:{default:!0},plano_trabalho_assinatura_gestor_entidade:{default:!1},checklist_avaliacao_entregas_plano_trabalho:{default:[]},checklist_plano_trabalho_texto:{default:""},checklist_avaliacao_entregas_plano_entrega:{default:[]},checklist_plano_entrega_texto:{default:""},plano_trabalho_criterios_avaliacao:{default:[]},plano_trabalho_criterio_avaliacao:{default:""},dias_tolerancia_avaliacao:{default:20},dias_tolerancia_recurso_avaliacao:{default:10},nota_padrao_avaliacao:{default:0},tipo_justificativa_id:{default:null}},this.cdRef,this.validate),this.join=["unidade"]}loadData(t,o){var e=this;return(0,u.A)(function*(){let n=Object.assign({},o.value);yield Promise.all([e.unidade.loadSearch(t.unidade||t.unidade_id)]),t.plano_trabalho_criterios_avaliacao=t.plano_trabalho_criterios_avaliacao||[],t.checklist_avaliacao_entregas_plano_entrega=t.checklist_avaliacao_entregas_plano_entrega||[],t.checklist_avaliacao_entregas_plano_trabalho=t.checklist_avaliacao_entregas_plano_trabalho||[],o.patchValue(e.util.fillForm(n,t))})()}initializeData(t){t.patchValue(new v.Y)}saveData(t){return new Promise((o,e)=>{const n=this.util.fill(new v.Y,this.entity);o(this.util.fillForm(n,this.form.value))})}isTipoAvaliacao(t){let o=this.tipoAvaliacao?.selectedEntity;return o?.tipo==t||!o&&"QUANTITATIVO"==t}get tipoAvaliacaoQualitativo(){let o=this.tipoAvaliacao?.selectedEntity?.notas?.map(e=>Object.assign({},{key:e.nota,value:e.nota}))||[];return JSON.stringify(o)!=JSON.stringify(this._tipoAvaliacaoQualitativo)&&(this._tipoAvaliacaoQualitativo=o),this._tipoAvaliacaoQualitativo}addItemHandlePlanoEntregaChecklist(){let t;const o=this.form.controls.checklist_plano_entrega_texto.value,e=this.util.textHash(o);return o?.length&&this.util.validateLookupItem(this.form.controls.checklist_avaliacao_entregas_plano_entrega.value,e)&&(t={key:e,value:this.form.controls.checklist_plano_entrega_texto.value},this.form.controls.checklist_plano_entrega_texto.setValue("")),t}onClickAbreNormativa(){this.form?.controls.link_normativa?.value?.length&&window.open(this.form?.controls.link_normativa.value)}onClickAbreAutorizacao(){this.form?.controls.link_autorizacao?.value?.length&&window.open(this.form?.controls.link_autorizacao.value)}static{this.\u0275fac=function(o){return new(o||i)(a.rXU(a.zZn))}}static{this.\u0275cmp=a.VBU({type:i,selectors:[["app-programa-form"]],viewQuery:function(o,e){if(1&o&&(a.GBs(_.Q,5),a.GBs(x,5),a.GBs(aa,5)),2&o){let n;a.mGM(n=a.lsd())&&(e.editableForm=n.first),a.mGM(n=a.lsd())&&(e.unidade=n.first),a.mGM(n=a.lsd())&&(e.tipoAvaliacao=n.first)}},features:[a.Vt3],decls:42,vars:81,consts:[["unidade",""],["tipoAvaliacaoEntrega",""],["tipoDocumento",""],["tipoAvaliacao",""],["initialFocus","unidade_id",3,"submit","cancel","form","disabled","title"],["display","","right",""],["key","GERAL","label","Geral"],[1,"row"],["label","Unidade Instituidora","controlName","unidade_id","required","",3,"size","dao","selectParams"],["date","","label","Data de In\xedcio","icon","bi bi-calendar-date","controlName","data_inicio","labelInfo","Data de in\xedcio da vig\xeancia do programa de gest\xe3o na unidade instituidora",3,"size","control"],["date","","label","Data de Fim","icon","bi bi-calendar-date","controlName","data_fim","labelInfo","Data de fim da vig\xeancia do programa de gest\xe3o na unidade instituidora",3,"size","control"],["label","Dura\xe7\xe3o M\xe1x P.E.","icon","bi bi-blockquote-left","controlName","prazo_max_plano_entrega","labelInfo","Limite m\xe1ximo de dias corridos para a dura\xe7\xe3o do plano de entregas a partir da sua data de cria\xe7\xe3o (Zero para n\xe3o limitar)",3,"size","control"],["label","T\xedtulo","icon","bi bi-textarea-t","controlName","nome","required","",3,"size","control"],["controlName","link_autorizacao","label","Link autoriza\xe7\xe3o","labelInfo","Link web da autoriza\xe7\xe3o","iconButton","bi bi-box-arrow-up-right","icon","bi bi-link-45deg",3,"buttonClick","control","size"],["controlName","link_normativa","label","Link institui\xe7\xe3o","labelInfo","Link web da instru\xe7\xe3o normativa","iconButton","bi bi-box-arrow-up-right","icon","bi bi-link-45deg",3,"buttonClick","control","size"],["key","PLANO_ENTREGA",3,"label"],["controlName","tipo_avaliacao_plano_entrega_id","required","",3,"label","size","dao","labelInfo"],[3,"title"],["label","Checklists das entregas","controlName","checklist_avaliacao_entregas_plano_entrega",3,"size","addItemHandle"],["controlName","checklist_plano_entrega_texto",3,"size"],["key","PLANO_TRABALHO",3,"label"],["scale","small","labelPosition","right","controlName","termo_obrigatorio","label","Se o termo \xe9 obrigat\xf3rio",3,"size","disabled"],["scale","small","labelPosition","right","controlName","plano_trabalho_assinatura_participante",3,"size","label","disabled"],["scale","small","labelPosition","right","controlName","plano_trabalho_assinatura_gestor_lotacao",3,"size","label","disabled"],["scale","small","labelPosition","right","controlName","plano_trabalho_assinatura_gestor_unidade",3,"size","label","disabled"],["scale","small","labelPosition","right","controlName","plano_trabalho_assinatura_gestor_entidade",3,"size","label","disabled"],["detailsButton","","labelInfo","Template do termo utilizado no plano de trabalho","controlName","template_tcr_id","required","",3,"details","label","size","dao","where","selectRoute"],["controlName","tipo_documento_tcr_id","labelInfo","Tipo de documento utilizado para exportar o termo para o SEI/SUPER",3,"label","size","dao"],["controlName","tipo_avaliacao_plano_trabalho_id","required","",3,"label","size","dao","labelInfo"],["label","Periodicidade","controlName","periodicidade_consolidacao","labelInfo","Per\xedodo para avalia\xe7\xe3o do plano de trabalho",3,"size","control","items"],["label","Dia da semana","controlName","periodicidade_valor","labelInfo","Representa quantidade de dias para DIAS; dia da semana para SEMANAL e QUINZENAL; e dia do m\xeas para o restante",3,"size","control","items",4,"ngIf"],["label","Dia do m\xeas","controlName","periodicidade_valor","labelInfo","Representa quantidade de dias para DIAS; dia da semana para SEMANAL e QUINZENAL; e dia do m\xeas para o restante",3,"size","control",4,"ngIf"],["label","Qtd. de Dias","controlName","periodicidade_valor","labelInfo","Representa quantidade de dias para DIAS; dia da semana para SEMANAL e QUINZENAL; e dia do m\xeas para o restante",3,"size","control",4,"ngIf"],["label","Toler\xe2ncia","controlName","dias_tolerancia_consolidacao","labelInfo","Dias de toler\xe2ncia para o lan\xe7amento do registro das atividades na consolida\xe7\xe3o, ap\xf3s esses dias ser\xe1 liberado automaticamente para avalia\xe7\xe3o","maxValue","10",3,"size","control"],["label","Toler\xe2ncia p/ avalia\xe7\xe3o","controlName","dias_tolerancia_avaliacao","labelInfo","Dias de toler\xe2ncia para a chefia realizar a avalia\xe7\xe3o ap\xf3s o registro de execu\xe7\xe3o, por parte do participante, segundo o \xa71\xba do art. 20 da IN n\xba 24/2023. Ap\xf3s esse prazo, o registro ser\xe1 considerado como 'N\xe3o avaliado'",3,"size","control","disabled"],["label","Toler\xe2ncia p/ recurso","controlName","dias_tolerancia_recurso_avaliacao","labelInfo","Dias de toler\xe2ncia para recorrer da avalia\xe7\xe3o",3,"size","control","disabled"],["label","Dia da semana","controlName","periodicidade_valor","labelInfo","Representa quantidade de dias para DIAS; dia da semana para SEMANAL e QUINZENAL; e dia do m\xeas para o restante",3,"size","control","items"],["label","Dia do m\xeas","controlName","periodicidade_valor","labelInfo","Representa quantidade de dias para DIAS; dia da semana para SEMANAL e QUINZENAL; e dia do m\xeas para o restante",3,"size","control"],["label","Qtd. de Dias","controlName","periodicidade_valor","labelInfo","Representa quantidade de dias para DIAS; dia da semana para SEMANAL e QUINZENAL; e dia do m\xeas para o restante",3,"size","control"]],template:function(o,e){if(1&o){const n=a.RV6();a.j41(0,"editable-form",4),a.bIt("submit",function(){return a.eBV(n),a.Njj(e.onSaveData())})("cancel",function(){return a.eBV(n),a.Njj(e.onCancel())}),a.j41(1,"tabs",5)(2,"tab",6)(3,"div",7),a.nrm(4,"input-search",8,0),a.k0s(),a.j41(6,"div",7),a.nrm(7,"input-datetime",9)(8,"input-datetime",10)(9,"input-number",11),a.k0s(),a.j41(10,"div",7),a.nrm(11,"input-text",12),a.j41(12,"input-button",13),a.bIt("buttonClick",function(){return a.eBV(n),a.Njj(e.onClickAbreAutorizacao())}),a.k0s(),a.j41(13,"input-button",14),a.bIt("buttonClick",function(){return a.eBV(n),a.Njj(e.onClickAbreNormativa())}),a.k0s()()(),a.j41(14,"tab",15),a.nrm(15,"input-search",16,1),a.j41(17,"separator",17)(18,"input-multiselect",18),a.nrm(19,"input-text",19),a.k0s()()(),a.j41(20,"tab",20),a.nrm(21,"input-switch",21)(22,"input-switch",22)(23,"input-switch",23)(24,"input-switch",24)(25,"input-switch",25),a.j41(26,"input-search",26),a.bIt("details",function(d){return a.eBV(n),a.Njj(e.templateService.details(d))}),a.k0s(),a.nrm(27,"input-search",27,2)(29,"input-search",28,3),a.j41(31,"separator",17)(32,"div",7),a.nrm(33,"input-select",29),a.DNE(34,sa,1,3,"input-select",30)(35,da,1,2,"input-number",31)(36,ua,1,2,"input-number",32),a.nrm(37,"input-number",33),a.k0s()(),a.j41(38,"separator",17)(39,"div",7),a.nrm(40,"input-number",34)(41,"input-number",35),a.k0s()()()()()}2&o&&(a.Y8G("form",e.form)("disabled",e.formDisabled)("title",e.isModal?"":e.title),a.R7$(4),a.Y8G("size",12)("dao",e.unidadeDao)("selectParams",a.eq3(73,ta,a.lJ4(72,ea))),a.R7$(3),a.Y8G("size",4)("control",e.form.controls.data_inicio),a.R7$(),a.Y8G("size",4)("control",e.form.controls.data_fim),a.R7$(),a.Y8G("size",4)("control",e.form.controls.prazo_max_plano_entrega),a.R7$(2),a.Y8G("size",4)("control",e.form.controls.nome),a.BMQ("maxlength",250),a.R7$(),a.Y8G("control",e.form.controls.link_autorizacao)("size",4),a.R7$(),a.Y8G("control",e.form.controls.link_normativa)("size",4),a.R7$(),a.Y8G("label",e.lex.translate("Plano de entrega")),a.R7$(),a.Y8G("label",e.lex.translate("Tipo de avalia\xe7\xe3o do Plano de entrega"))("size",12)("dao",e.tipoAvaliacaoDao)("labelInfo",e.lex.translate("Tipo de avalia\xe7\xe3o")+" que especifica a forma que ser\xe1 avaliado "+e.lex.translate("plano de trabalho")+" e "+e.lex.translate("plano de entrega")),a.R7$(2),a.Y8G("title",e.lex.translate("Avalia\xe7\xe3o")+e.lex.translate(" do Plano de Entrega")),a.R7$(),a.Y8G("size",12)("addItemHandle",e.addItemHandlePlanoEntregaChecklist.bind(e)),a.R7$(),a.Y8G("size",12),a.BMQ("maxlength",250),a.R7$(),a.Y8G("label",e.lex.translate("Plano de trabalho")),a.R7$(),a.Y8G("size",12)("disabled",e.util.isDeveloper()?void 0:"true"),a.R7$(),a.Y8G("size",12)("label","Exige assinatura "+e.lex.translate("do usu\xe1rio")+e.lex.translate(" do plano de trabalho"))("disabled",e.util.isDeveloper()?void 0:"true"),a.R7$(),a.Y8G("size",12)("label","Exige assinatura do gestor da lota\xe7\xe3o "+e.lex.translate("do usu\xe1rio")+" (para "+e.lex.translate("unidade")+" distinta)")("disabled",e.util.isDeveloper()?void 0:"true"),a.R7$(),a.Y8G("size",12)("label","Exige assinatura do gestor "+e.lex.translate("da unidade"))("disabled",e.util.isDeveloper()?void 0:"true"),a.R7$(),a.Y8G("size",12)("label","Exige assinatura do gestor "+e.lex.translate("da entidade"))("disabled",e.util.isDeveloper()?void 0:"true"),a.R7$(),a.Y8G("label","Template "+e.lex.translate("termo")+" (TCR)")("size",12)("dao",e.templateDao)("where",a.eq3(76,ia,a.lJ4(75,oa)))("selectRoute",e.templateService.selectRoute("TCR",null==e.form||null==e.form.controls||null==e.form.controls.template_tcr_id?null:e.form.controls.template_tcr_id.value)),a.R7$(),a.Y8G("label","Tipo de documento "+e.lex.translate("termo"))("size",12)("dao",e.tipoDocumentoDao),a.R7$(2),a.Y8G("label",e.lex.translate("Tipo de avalia\xe7\xe3o do registro de execu\xe7\xe3o do plano de trabalho"))("size",12)("dao",e.tipoAvaliacaoDao)("labelInfo",e.lex.translate("Tipo de avalia\xe7\xe3o")+" que especifica a forma que ser\xe1 avaliado "+e.lex.translate("plano de trabalho")+" e "+e.lex.translate("plano de entrega")),a.R7$(2),a.Y8G("title",e.lex.translate("Consolida\xe7\xe3o")+e.lex.translate(" do Plano de trabalho")),a.R7$(2),a.Y8G("size",6)("control",e.form.controls.periodicidade_consolidacao)("items",e.lookup.PERIODICIDADE_CONSOLIDACAO),a.R7$(),a.Y8G("ngIf",a.lJ4(78,na).includes(e.form.controls.periodicidade_consolidacao.value)),a.R7$(),a.Y8G("ngIf",a.lJ4(79,la).includes(e.form.controls.periodicidade_consolidacao.value)),a.R7$(),a.Y8G("ngIf",a.lJ4(80,ra).includes(e.form.controls.periodicidade_consolidacao.value)),a.R7$(),a.Y8G("size",3)("control",e.form.controls.dias_tolerancia_consolidacao),a.R7$(),a.Y8G("title",e.lex.translate("Avalia\xe7\xe3o")+e.lex.translate(" da Consolida\xe7\xe3o")),a.R7$(2),a.Y8G("size",6)("control",e.form.controls.dias_tolerancia_avaliacao)("disabled",e.util.isDeveloper()?void 0:"true"),a.R7$(),a.Y8G("size",6)("control",e.form.controls.dias_tolerancia_recurso_avaliacao)("disabled",e.util.isDeveloper()?void 0:"true"))},dependencies:[f.bT,_.Q,H.S,y.O,X.E,D.H,O.r,S.K,J.b,Z.O,q.j,W.F,K.n]})}}return i})();var E=r(5611),z=r(9062),ca=r(8790),F=r(2034),B=r(5852),L=r(7772),M=r(2305),$=r(6764);const ma=i=>({metadata:i});function pa(i,s){1&i&&a.nrm(0,"toolbar")}function ha(i,s){if(1&i&&(a.j41(0,"span"),a.EFF(1),a.k0s(),a.nrm(2,"br"),a.j41(3,"small"),a.EFF(4),a.k0s()),2&i){const t=s.row;a.R7$(),a.SpI(" ",t.nome,""),a.R7$(3),a.SpI(" ",t.normativa,"")}}function fa(i,s){if(1&i&&(a.j41(0,"span"),a.EFF(1),a.k0s(),a.nrm(2,"br"),a.j41(3,"small"),a.EFF(4),a.k0s()),2&i){const t=s.row;a.R7$(),a.SpI(" ",t.unidade.nome,""),a.R7$(3),a.SpI(" ",t.unidade.sigla,"")}}function ga(i,s){if(1&i&&(a.j41(0,"span"),a.EFF(1),a.k0s(),a.nrm(2,"br")),2&i){const t=s.row,o=a.XpG();a.R7$(),a.SpI(" ",o.dao.getDateFormatted(t.data_inicio),"")}}function _a(i,s){if(1&i&&(a.j41(0,"span"),a.EFF(1),a.k0s()),2&i){const t=s.row,o=a.XpG();a.R7$(),a.SpI(" ",o.dao.getDateFormatted(t.data_fim),"")}}let ba=(()=>{class i extends z.P{constructor(t,o){super(t,v.Y,b.X),this.injector=t,this.vigentesUnidadeExecutora=!1,this.todosUnidadeExecutora=!1,this.filterWhere=e=>{let n=[],l=e.value;return this.vigentesUnidadeExecutora&&n.push(["vigentesUnidadeExecutora","==",this.auth.unidade.id]),(this.todosUnidadeExecutora||!this.util.isDeveloper())&&n.push(["todosUnidadeExecutora","==",this.auth.unidade.id]),l.nome?.length&&n.push(["nome","like","%"+l.nome.trim().replace(" ","%")+"%"]),n},this.concluir=e=>{this.dialog.confirm("Concluir?","Ao encerrar este regramento, todos os planos de entregas e planos de trabalho ser\xe3o automaticamente conclu\xeddos. Al\xe9m disso, todos os agentes p\xfablicos ser\xe3o automaticamente desligados do PGD. Voc\xea confirma?").then(n=>{n&&this.dao.concluir(e).then(()=>{(this.grid?.query||this.query).refreshId(e.id),this.dialog.topAlert("Regramento conclu\xeddo com sucesso!",5e3)}).catch(l=>this.dialog.alert("Erro","Erro ao concluir: "+(l?.message?l?.message:l)))})},this.programaService=t.get(ca.t),this.title=this.lex.translate("Programas de Gest\xe3o"),this.code="MOD_PRGT",this.join=["unidade:id, nome"],this.filter=this.fh.FormBuilder({nome:{default:""}}),this.addOption(this.OPTION_INFORMACOES),this.addOption(this.OPTION_EXCLUIR,"MOD_PRGT_EXCL"),this.addOption(this.OPTION_LOGS,"MOD_AUDIT_LOG"),this.auth.hasPermissionTo("MOD_PART")&&this.options.push({icon:"bi bi-people",label:"Participantes",onClick:e=>this.go.navigate({route:["gestao","programa",e.id,"participantes"]},{metadata:{programa:e}})}),this.BOTAO_CONCLUIR={label:"Concluir",icon:"bi bi-journal-check",onClick:this.concluir.bind(this)}}dynamicButtons(t){return this.auth.hasPermissionTo("MOD_PRGT_CONCL")&&this.programaService.programaVigente(t),[]}ngOnInit(){super.ngOnInit(),this.vigentesUnidadeExecutora=this.metadata?.vigentesUnidadeExecutora,this.todosUnidadeExecutora=this.metadata?.todosUnidadeExecutora}static{this.\u0275fac=function(o){return new(o||i)(a.rXU(a.zZn),a.rXU(b.X))}}static{this.\u0275cmp=a.VBU({type:i,selectors:[["app-programa-list"]],viewQuery:function(o,e){if(1&o&&a.GBs(E._,5),2&o){let n;a.mGM(n=a.lsd())&&(e.grid=n.first)}},features:[a.Vt3],decls:20,vars:32,consts:[["columnTituloNormativa",""],["columnUnidadeInstituidora",""],["columnInicioVigencia",""],["columnFimVigencia",""],[3,"select","dao","add","title","orderBy","groupBy","join","selectable","hasAdd","hasEdit","addMetadata"],[4,"ngIf"],[3,"deleted","form","where","submit","collapseChange","collapsed"],[1,"row"],["controlName","nome",3,"size","label","control","placeholder"],["title","T\xedtulo/Normativa",3,"template"],["title","Unidade instituidora",3,"template"],["title","In\xedcio da Vig\xeancia",3,"template"],["title","Fim da Vig\xeancia",3,"template"],["type","options",3,"onEdit","options","dynamicButtons"],[3,"rows"]],template:function(o,e){if(1&o){const n=a.RV6();a.j41(0,"grid",4),a.bIt("select",function(d){return a.eBV(n),a.Njj(e.onSelect(d))}),a.DNE(1,pa,1,0,"toolbar",5),a.j41(2,"filter",6)(3,"div",7),a.nrm(4,"input-text",8),a.k0s()(),a.j41(5,"columns")(6,"column",9),a.DNE(7,ha,5,2,"ng-template",null,0,a.C5r),a.k0s(),a.j41(9,"column",10),a.DNE(10,fa,5,2,"ng-template",null,1,a.C5r),a.k0s(),a.j41(12,"column",11),a.DNE(13,ga,3,1,"ng-template",null,2,a.C5r),a.k0s(),a.j41(15,"column",12),a.DNE(16,_a,2,1,"ng-template",null,3,a.C5r),a.k0s(),a.nrm(18,"column",13),a.k0s(),a.nrm(19,"pagination",14),a.k0s()}if(2&o){const n=a.sdS(8),l=a.sdS(11),d=a.sdS(14),h=a.sdS(17);a.Y8G("dao",e.dao)("add",e.add)("title",e.isModal?"":e.title)("orderBy",e.orderBy)("groupBy",e.groupBy)("join",e.join)("selectable",e.selectable)("hasAdd",e.auth.hasPermissionTo("MOD_PRGT_INCL"))("hasEdit",e.auth.hasPermissionTo("MOD_PRGT_EDT"))("addMetadata",a.eq3(30,ma,e.todosUnidadeExecutora)),a.R7$(),a.Y8G("ngIf",!e.selectable),a.R7$(),a.Y8G("deleted",e.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",e.filter)("where",e.filterWhere)("submit",e.filterSubmit.bind(e))("collapseChange",e.filterCollapseChange.bind(e))("collapsed",!e.selectable&&e.filterCollapsed),a.R7$(2),a.Y8G("size",12)("label","Nome do "+e.lex.translate("programa"))("control",e.filter.controls.nome)("placeholder","Nome do "+e.lex.translate("programa")),a.BMQ("maxlength",250),a.R7$(2),a.Y8G("template",n),a.R7$(3),a.Y8G("template",l),a.R7$(3),a.Y8G("template",d),a.R7$(3),a.Y8G("template",h),a.R7$(3),a.Y8G("onEdit",e.edit)("options",e.options)("dynamicButtons",e.dynamicButtons.bind(e)),a.R7$(),a.Y8G("rows",e.rowsLimit)}},dependencies:[f.bT,E._,F.T,B.I,L.i,M.H,$.e,D.H]})}}return i})();var j=r(5025),c=r.n(j),va=r(1999),T=r(5413),P=r(3130),Ea=r(5201);const Pa=["programaSearch"],Aa=i=>["vigentesUnidadeExecutora","==",i],Da=i=>[i],Ia=()=>({vigentesUnidadeExecutora:!0});function Ta(i,s){1&i&&a.nrm(0,"toolbar")}function Ra(i,s){if(1&i&&(a.j41(0,"div",19)(1,"span")(2,"strong"),a.EFF(3),a.k0s()()()),2&i){const t=a.XpG();a.R7$(3),a.JRh(t.lex.translate("Usu\xe1rios"))}}function Ca(i,s){1&i&&(a.j41(0,"label",22),a.EFF(1,"Usu\xe1rio Externo"),a.k0s())}function Ga(i,s){1&i&&(a.j41(0,"label",23),a.EFF(1,"Teletrabalho indispon\xedvel"),a.k0s())}function Na(i,s){if(1&i&&(a.j41(0,"strong"),a.EFF(1),a.k0s(),a.nrm(2,"br"),a.DNE(3,Ca,2,0,"label",20)(4,Ga,2,0,"label",21)),2&i){const t=s.row;a.R7$(),a.JRh(t.nome),a.R7$(2),a.Y8G("ngIf",t.usuario_externo),a.R7$(),a.Y8G("ngIf",t.pedagio)}}function ya(i,s){if(1&i&&(a.j41(0,"small",27),a.EFF(1),a.k0s()),2&i){const t=a.XpG().$implicit;a.R7$(),a.JRh(t.programa.nome)}}function Oa(i,s){if(1&i&&(a.qex(0),a.DNE(1,ya,2,1,"small",26),a.bVm()),2&i){const t=s.$implicit;a.R7$(),a.Y8G("ngIf",1==t.habilitado)}}function Sa(i,s){if(1&i&&(a.j41(0,"badge",28),a.EFF(1),a.k0s()),2&i){const t=a.XpG(2);a.Y8G("color","danger"),a.R7$(),a.JRh(t.lex.translate("Sem participa\xe7\xe3o"))}}function za(i,s){if(1&i&&a.DNE(0,Oa,2,1,"ng-container",24)(1,Sa,2,2,"badge",25),2&i){const t=s.row;a.Y8G("ngForOf",t.participacoes_programas),a.R7$(),a.Y8G("ngIf",0==t.participacoes_programas.length)}}function Fa(i,s){if(1&i&&(a.j41(0,"div")(1,"small"),a.EFF(2),a.k0s()()),2&i){const t=s.$implicit;a.R7$(2),a.JRh(null==t.unidade?null:t.unidade.sigla)}}function Ba(i,s){1&i&&a.DNE(0,Fa,3,1,"div",24),2&i&&a.Y8G("ngForOf",s.row.areas_trabalho)}function La(i,s){if(1&i&&(a.j41(0,"span"),a.EFF(1),a.k0s()),2&i){const t=s.row,o=a.XpG();a.R7$(),a.JRh(o.hasPlanoTrabalhoAtivo(t)?"sim":"n\xe3o")}}let k=(()=>{class i extends z.P{constructor(t){var o;super(t,P.P,T._),o=this,this.injector=t,this.multiselectMenu=[],this.programa=null,this.BOTAO_HABILITAR={label:this.lex.translate("Habilitar"),hint:this.lex.translate("Habilitar"),icon:"bi bi-person-check-fill",color:"btn-outline-success",onClick:this.habilitarParticipante.bind(this)},this.BOTAO_DESABILITAR={label:this.lex.translate("Desabilitar"),hint:this.lex.translate("Desabilitar"),icon:"bi bi-person-x-fill",color:"btn-outline-danger",onClick:this.desabilitarParticipante.bind(this)},this.condicoes=[{key:"1",value:this.lex.translate("Habilitados")},{key:"0",value:this.lex.translate("Desabilitados")}],this.validate=(e,n)=>{let l=null;return["programa_id"].indexOf(n)>=0&&!e.value?.length&&(l="Obrigat\xf3rio"),l},this.filterWhere=e=>{let n=[],l=e.value;return l.unidade_id?.length&&n.push(["lotacao","==",l.unidade_id]),l.nome_usuario?.length&&n.push(["nome","like","%"+l.nome_usuario.trim().replace(" ","%")+"%"]),n.push(["habilitado","==",this.filter?.controls.habilitados.value]),n.push(["programa_id","==",this.programa?.id||this.metadata?.programa.id]),n},this.unidadeDao=t.get(G.s),this.programaParticipanteDao=t.get(va.F),this.programaDao=t.get(b.X),this.usuarioDao=t.get(T._),this.code="MOD_PART",this.filter=this.fh.FormBuilder({programa_id:{default:this.programa?.id},unidade_id:{default:this.auth.unidade?.id},nome_usuario:{default:""},habilitados:{default:null}},this.cdRef,this.validate),this.auth.hasPermissionTo("MOD_PART_HAB")&&this.multiselectMenu.push({icon:"bi bi-person-check-fill",label:this.lex.translate("Habilitar"),color:"btn-outline-success",onClick:this.habilitarParticipantes.bind(this)}),this.auth.hasPermissionTo("MOD_PART_DESAB")&&this.multiselectMenu.push({icon:"bi bi-person-x-fill",label:this.lex.translate("Desabilitar"),color:"btn-outline-danger",onClick:this.desabilitarParticipantes.bind(this)}),this.BOTAO_PEDAGIO={label:"Tornar teletrabalho indispon\xedvel",icon:"bi bi-ban",color:"btn-outline-danger",onClick:e=>{var n;this.go.navigate({route:["gestao","programa","pedagio",e.id]},{metadata:{usuario:e},modalClose:(n=(0,u.A)(function*(l){l&&(o.refresh(l.id),o.cdRef.detectChanges())}),function(d){return n.apply(this,arguments)})})}},this.BOTAO_REMOVE_PEDAGIO={label:"Tornar teletrabalho dispon\xedvel novamente",icon:"bi bi-check2-circle",color:"btn-outline-primary",onClick:this.removePedagio.bind(this)},this.join=["areasTrabalho.unidade:id,sigla","planos_trabalho:id,status","participacoes_programas.programa:id"],this.title=this.lex.translate("Habilita\xe7\xf5es"),this.orderBy=[["nome","asc"]]}dynamicButtons(t){let o=[];return t.usuario_externo||(this.auth.hasPermissionTo("MOD_PART_HAB")&&!this.isHabilitado(t)&&o.push(this.BOTAO_HABILITAR),this.auth.hasPermissionTo("MOD_PART_DESAB")&&this.isHabilitado(t)&&o.push(this.BOTAO_DESABILITAR),this.auth.hasPermissionTo("MOD_PART_PEDAGIO")&&!t.pedagio&&o.push(this.BOTAO_PEDAGIO),this.auth.hasPermissionTo("MOD_PART_PEDAGIO")&&t.pedagio&&o.push(this.BOTAO_REMOVE_PEDAGIO)),o}ngAfterViewInit(){var t=this;super.ngAfterViewInit(),this.grid.BUTTON_MULTISELECT_SELECIONAR="Marcar",this.grid.BUTTON_MULTISELECT_CANCELAR_SELECAO="Cancelar Marca\xe7\xe3o",this.grid.BUTTON_MULTISELECT.label="Marcar",(0,u.A)(function*(){t.loading=!0;try{t.programa=t.metadata?.programa,t.programa||(yield t.programaDao.query({where:[["vigentesUnidadeExecutora","==",t.auth.unidade.id]],orderBy:[["unidade.path","desc"]]}).asPromise().then(o=>{t.programa=o[0]}))}finally{t.programaSearch?.loadSearch(t.programa),t.loading=!1}})()}filterClear(t){t.controls.unidade_id.setValue(void 0),t.controls.nome_usuario.setValue(""),t.controls.habilitados.setValue("1")}habilitarParticipante(t){var o=this;return(0,u.A)(function*(){return yield o.programaParticipanteDao.habilitar([t.id],o.programa.id,1,!1).then(e=>{(o.grid?.query||o.query).refreshId(t.id),o.cdRef.detectChanges()}).catch(e=>{o.dialog.alert("Erro",e)}),!1})()}desabilitarParticipante(t){var o=this;return(0,u.A)(function*(){if(yield o.dialog.confirm("Desabilitar ?","Deseja DESABILITAR "+o.lex.translate("o servidor")+" "+t.nome.toUpperCase()+" "+o.lex.translate("do programa")+" "+(o.programa?.nome).toUpperCase()+" ?")){let n=!1;o.hasPlanoTrabalhoAtivo(t)&&(n=yield o.dialog.confirm("ATEN\xc7\xc3O",o.lex.translate("O servidor")+" possui "+o.lex.translate("Plano de Trabalho")+" ativo vinculado a "+o.lex.translate("este Programa")+"! Deseja continuar com a desabilita\xe7\xe3o, suspendendo o seu "+o.lex.translate("Plano de Trabalho ?"))),(!o.hasPlanoTrabalhoAtivo(t)||n)&&(yield o.programaParticipanteDao.habilitar([t.id],o.programa.id,0,n).then(l=>{(o.grid?.query||o.query).refreshId(t.id),o.cdRef.detectChanges()},l=>{o.dialog.alert("Erro",l)}))}})()}habilitarParticipantes(){var t=this;return(0,u.A)(function*(){if(t.grid.multiselectedCount){const o=t;t.dialog.confirm("Habilitar Participantes ?","Confirma a habilita\xe7\xe3o de todos esses participantes?").then(e=>{if(e){const n=Object.values(t.grid.multiselected).map(l=>l.id);t.programaParticipanteDao.habilitar(n,t.programa.id,1,!1).then(()=>{o.dialog.topAlert("Participantes habilitados com sucesso!",5e3),(o.grid?.query||o.query).refresh()}).catch(l=>{o.dialog.alert("Erro",l)}),t.grid?.enableMultiselect(!1),o.cdRef.detectChanges()}})}else t.dialog.alert("Selecione","Nenhum participante selecionado para a habilita\xe7\xe3o")})()}desabilitarParticipantes(){var t=this;return(0,u.A)(function*(){let o=Object.keys(t.grid.multiselected);t.dialog.confirm("Desabilitar ?","Deseja DESABILITAR, "+t.lex.translate("do programa")+" "+(t.programa?.nome).toUpperCase()+" todos "+t.lex.translate("os usu\xe1rios")+" selecionados ?").then(function(){var e=(0,u.A)(function*(n){if(n){const l=t;let d=0;yield t.programaParticipanteDao.quantidadePlanosTrabalhoAtivos(o).then(g=>{d=g});let h=!1;if(d&&(yield t.dialog.confirm("ATEN\xc7\xc3O","H\xe1 "+d+t.lex.translate(1==d?" usu\xe1rio":" usu\xe1rios")+" com "+t.lex.translate("Plano de Trabalho")+" ativo vinculado a "+t.lex.translate("este Programa")+"! Deseja continuar com a desabilita\xe7\xe3o, suspendendo "+(1==d?"o seu ":"todos ")+t.lex.translate(1==d?"Plano de Trabalho":"os Planos de Trabalho")+" ?").then(g=>{h=g})),!d||h){const g=Object.values(t.grid.multiselected).map(A=>A.id);t.programaParticipanteDao.habilitar(g,t.programa.id,0,h).then(A=>{l.dialog.topAlert("Participantes desabilitados com sucesso!",5e3),(t.grid?.query||t.query).refresh()}).catch(function(A){l.grid&&(l.grid.error=A)}),t.grid?.enableMultiselect(!1),t.cdRef.detectChanges()}}});return function(n){return e.apply(this,arguments)}}())})()}onProgramaChange(){this.programa=this.programaSearch?.selectedItem?.entity,this.programa&&this.grid?.reloadFilter()}isHabilitado(t){return!!t.participacoes_programas.find(o=>1==o.habilitado&&o.programa_id==this.programa?.id)}hasPlanoTrabalhoAtivo(t){return!!t.planos_trabalho?.find(o=>"ATIVO"==o.status&&this.util.between((0,j.now)(),{start:o.data_inicio,end:o.data_fim}))}removePedagio(t){var o=this;return(0,u.A)(function*(){o.dialog.confirm("Remover teletrabalho indispon\xedvel ?","Deseja tornar a modalidade teletrabalho dispon\xedvel para o participante "+t.nome.toUpperCase()+" ?").then(function(){var e=(0,u.A)(function*(n){n&&(yield o.usuarioDao.removePedagio(t.id).then(l=>{(o.grid?.query||o.query).refreshId(t.id),o.cdRef.detectChanges()},l=>{o.dialog.alert("Erro",l)}))});return function(n){return e.apply(this,arguments)}}())})()}static{this.\u0275fac=function(o){return new(o||i)(a.rXU(a.zZn))}}static{this.\u0275cmp=a.VBU({type:i,selectors:[["app-programa-participantes"]],viewQuery:function(o,e){if(1&o&&(a.GBs(E._,5),a.GBs(Pa,5)),2&o){let n;a.mGM(n=a.lsd())&&(e.grid=n.first),a.mGM(n=a.lsd())&&(e.programaSearch=n.first)}},features:[a.Vt3],decls:27,vars:57,consts:[["programaSearch",""],["unidade",""],["columnUsuario",""],["columnPrograma",""],["columnLotacao",""],["columnPlanoTrabalho",""],["multiselect","","editable","",3,"select","dao","title","orderBy","groupBy","join","selectable","hasAdd","hasEdit","hasDelete","multiselectMenu"],[4,"ngIf"],[3,"deleted","form","where","clear","submit","collapseChange","collapsed"],[1,"row"],["controlName","programa_id","required","",3,"change","size","disabled","control","dao","where","metadata","value"],["controlName","habilitados","itemTodos","- Todos -",3,"size","items","label","control","valueTodos"],["controlName","nome_usuario",3,"size","label","control","placeholder"],["controlName","unidade_id",3,"size","control","label","labelInfo","dao"],["class","mt-2 mb-4",4,"ngIf"],[3,"title","template"],[3,"title","align","template"],["type","options",3,"dynamicButtons"],[3,"rows"],[1,"mt-2","mb-4"],["class","badge text-bg-warning",4,"ngIf"],["class","badge text-bg-danger",4,"ngIf"],[1,"badge","text-bg-warning"],[1,"badge","text-bg-danger"],[4,"ngFor","ngForOf"],[3,"color",4,"ngIf"],["class","text-success",4,"ngIf"],[1,"text-success"],[3,"color"]],template:function(o,e){if(1&o){const n=a.RV6();a.j41(0,"grid",6),a.bIt("select",function(d){return a.eBV(n),a.Njj(e.onSelect(d))}),a.DNE(1,Ta,1,0,"toolbar",7),a.j41(2,"filter",8)(3,"div",9)(4,"input-search",10,0),a.bIt("change",function(){return a.eBV(n),a.Njj(e.onProgramaChange())}),a.k0s(),a.nrm(6,"input-select",11),a.k0s(),a.j41(7,"div",9),a.nrm(8,"input-text",12)(9,"input-search",13,1),a.k0s()(),a.DNE(11,Ra,4,1,"div",14),a.j41(12,"columns")(13,"column",15),a.DNE(14,Na,5,3,"ng-template",null,2,a.C5r),a.k0s(),a.j41(16,"column",15),a.DNE(17,za,2,2,"ng-template",null,3,a.C5r),a.k0s(),a.j41(19,"column",15),a.DNE(20,Ba,1,1,"ng-template",null,4,a.C5r),a.k0s(),a.j41(22,"column",16),a.DNE(23,La,2,1,"ng-template",null,5,a.C5r),a.k0s(),a.nrm(25,"column",17),a.k0s(),a.nrm(26,"pagination",18),a.k0s()}if(2&o){const n=a.sdS(15),l=a.sdS(18),d=a.sdS(21),h=a.sdS(24);a.Y8G("dao",e.dao)("title",e.isModal?"":e.title)("orderBy",e.orderBy)("groupBy",e.groupBy)("join",e.join)("selectable",e.selectable)("hasAdd",!1)("hasEdit",!1)("hasDelete",!1)("multiselectMenu",e.multiselectMenu),a.R7$(),a.Y8G("ngIf",!e.selectable),a.R7$(),a.Y8G("deleted",e.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",e.filter)("where",e.filterWhere)("clear",e.filterClear.bind(e))("submit",e.filterSubmit.bind(e))("collapseChange",e.filterCollapseChange.bind(e))("collapsed",!e.selectable&&e.filterCollapsed),a.R7$(2),a.Y8G("size",8)("disabled",e.isModal?"true":void 0)("control",e.filter.controls.programa_id)("dao",e.programaDao)("where",a.eq3(54,Da,a.eq3(52,Aa,e.auth.unidade.id)))("metadata",a.lJ4(56,Ia))("value",null==e.programa?null:e.programa.nome),a.R7$(2),a.Y8G("size",4)("items",e.condicoes)("label","Situa\xe7\xe3o "+e.lex.translate("no programa"))("control",e.filter.controls.habilitados)("valueTodos",null),a.R7$(2),a.Y8G("size",6)("label","Nome do "+e.lex.translate("usu\xe1rio"))("control",e.filter.controls.nome_usuario)("placeholder","Nome do "+e.lex.translate("usuario")+"..."),a.BMQ("maxlength",250),a.R7$(),a.Y8G("size",6)("control",e.filter.controls.unidade_id)("label",e.lex.translate("Unidade ")+e.lex.translate("de lota\xe7\xe3o"))("labelInfo","Se a op\xe7\xe3o TODOS estiver OFF, exibe apenas "+e.lex.translate("os usu\xe1rios")+" habilitados lotados "+e.lex.translate("nessa unidade")+". Se a op\xe7\xe3o TODOS estiver ON, exibe todos "+e.lex.translate("os usu\xe1rios")+" lotados "+e.lex.translate("nessa unidade")+", habilitados, desabilitados e inabilitados.")("dao",e.unidadeDao),a.R7$(2),a.Y8G("ngIf",null==e.grid||null==e.grid.filterRef?null:e.grid.filterRef.collapsed),a.R7$(2),a.Y8G("title",e.lex.translate("Usu\xe1rio"))("template",n),a.R7$(3),a.Y8G("title",e.lex.translate("Programa de Gest\xe3o"))("template",l),a.R7$(3),a.Y8G("title",e.lex.translate("V\xednculos"))("template",d),a.R7$(3),a.Y8G("title",e.lex.translate("Plano de Trabalho")+" ativo?")("align","center")("template",h),a.R7$(3),a.Y8G("dynamicButtons",e.dynamicButtons.bind(e)),a.R7$(),a.Y8G("rows",e.rowsLimit)}},dependencies:[f.Sq,f.bT,E._,F.T,B.I,L.i,M.H,$.e,y.O,D.H,S.K,Ea.n],styles:[".habilitado[_ngcontent-%COMP%]{background:#198754;border:2px solid #1B5E20}.desabilitado[_ngcontent-%COMP%]{background:#dc3545;border:2px solid #B71C1C}"]})}}return i})();var Ma=r(9742);const ja=[{path:"",component:ba,canActivate:[m.q],resolve:{config:p.L},runGuardsAndResolvers:"always",data:{title:"Programas"}},{path:"new",component:I,canActivate:[m.q],resolve:{config:p.L},runGuardsAndResolvers:"always",data:{title:"Inclus\xe3o de Programa",modal:!0}},{path:"participantes",component:k,canActivate:[m.q],resolve:{config:p.L},runGuardsAndResolvers:"always",data:{title:"Participantes do Programa"}},{path:":id/edit",component:I,canActivate:[m.q],resolve:{config:p.L},runGuardsAndResolvers:"always",data:{title:"Edi\xe7\xe3o de Programa",modal:!0}},{path:":id/consult",component:I,canActivate:[m.q],resolve:{config:p.L},runGuardsAndResolvers:"always",data:{title:"Consulta a Programa",modal:!0}},{path:":id/participantes",component:k,canActivate:[m.q],resolve:{config:p.L},runGuardsAndResolvers:"always",data:{title:"Participantes do Programa",modal:!0}},{path:"pedagio/:idUsuario",component:(()=>{class i extends N.n{constructor(t){super(t,P.P,T._),this.injector=t,this.OPTIONS=[{key:"1",value:"Art 10, \xa72\xba, INC SEGES/SPGRT n\xba 24/2024- Primeiro ano do Est\xe1gio Probat\xf3rio."},{key:"2",value:"Art 10, \xa73\xba, INC SEGES/SPGRT n\xba 24/2024- Movimenta\xe7\xe3o entre \xf3rg\xe3os h\xe1 menos de 6 (seis) meses."}],this.validate=(o,e)=>null,this.formValidation=o=>{let e=null;return this.form?.controls.data_final_pedagio.value&&this.form?.controls.data_inicial_pedagio.value&&(c()(this.form?.controls.data_final_pedagio.value).isBefore(c()(this.form?.controls.data_inicial_pedagio.value))&&(e="Data de in\xedcio n\xe3o pode ser maior que a data de fim."),"1"==this.form?.controls.tipo_pedagio.value&&c()(this.form?.controls.data_final_pedagio.value).diff(c()(this.form?.controls.data_inicial_pedagio.value),"days")<364&&(e="Data de fim deve ser maior que 365 dias."),"2"==this.form?.controls.tipo_pedagio.value&&c()(this.form?.controls.data_final_pedagio.value).diff(c()(this.form?.controls.data_inicial_pedagio.value),"days")<179&&(e="Data de fim deve ser maior que 180 dias.")),e},this.form=this.fh.FormBuilder({tipo_pedagio:{default:""},data_inicial_pedagio:{default:""},data_final_pedagio:{default:""}},this.cdRef,this.validate)}loadData(t,o){var e=this;return(0,u.A)(function*(){e.entity=e.metadata?.usuario||t,e.form=o,e.form.controls.data_inicial_pedagio.setValue(c()(e.entity?.data_inicial_pedagio).toDate()),e.form.controls.data_final_pedagio.setValue(c()(e.entity?.data_final_pedagio).toDate()),e.form.controls.tipo_pedagio.setValue(e.entity?.tipo_pedagio)})()}saveData(t){var o=this;return(0,u.A)(function*(){return new Promise((e,n)=>{const l=o.util.fill(new P.P,o.entity);e(o.util.fillForm(l,o.form.value))})})()}initializeData(t){this.entity=new P.P,this.loadData(this.entity,t)}atualizaPedagio(){var t=this;return(0,u.A)(function*(){let o;t.submitting=!0;const e={usuario_id:t.entity?.id,data_inicial_pedagio:t.form?.controls.data_inicial_pedagio.value,data_final_pedagio:t.form?.controls.data_final_pedagio.value,tipo_pedagio:t.form?.controls.tipo_pedagio.value};try{o=yield t.dao?.atualizaPedagio(e),t.dialog.alert("Sucesso","Teletrabalho indispon\xedvel para o per\xedodo"),t.go.setModalResult(t.modalRoute?.queryParams?.idroute,o),t.close()}catch(n){throw n}finally{t.submitting=!1}return o})()}updateDates(t){this.updateDateFields(t.target.value,c()().startOf("day"))}onDataInicioChange(t){const o=this.form?.controls.tipo_pedagio.value,e=c()(t.target.value);e.isValid()?this.updateDateFields(o,e):this.form?.controls.data_final_pedagio.setValue(null)}updateDateFields(t,o){this.form?.controls.data_inicial_pedagio.setValue(o.toDate());const e="1"===t?365:"2"===t?180:0;e>0&&this.form?.controls.data_final_pedagio.setValue(o.add(e,"days").toDate())}onDataFimChange(t){}static{this.\u0275fac=function(o){return new(o||i)(a.rXU(a.zZn))}}static{this.\u0275cmp=a.VBU({type:i,selectors:[["app-pedagio-form"]],viewQuery:function(o,e){if(1&o&&a.GBs(_.Q,5),2&o){let n;a.mGM(n=a.lsd())&&(e.editableForm=n.first)}},features:[a.Vt3],decls:8,vars:10,consts:[["confirmLabel","Confirmar",3,"submit","cancel","form","title"],[1,"row"],[1,"col-md-12","situacao"],["label","Selecione a hip\xf3tese normativa aplic\xe1vel ao impedimento para a modalidade Teletrabalho:","controlName","tipo_pedagio","circle","true","required","",3,"change","size","items"],[1,"col-md-6"],["date","","label","Data In\xedcio","icon","bi bi-calendar-date","controlName","data_inicial_pedagio","required","",3,"change","size","control","labelInfo"],["date","","label","Data Fim","icon","bi bi-calendar-date","controlName","data_final_pedagio","required","",3,"change","size","control","labelInfo"]],template:function(o,e){1&o&&(a.j41(0,"editable-form",0),a.bIt("submit",function(){return e.atualizaPedagio()})("cancel",function(){return e.onCancel()}),a.j41(1,"div",1)(2,"div",2)(3,"input-radio",3),a.bIt("change",function(l){return e.updateDates(l)}),a.k0s()(),a.j41(4,"div",4)(5,"input-datetime",5),a.bIt("change",function(l){return e.onDataInicioChange(l)}),a.k0s()(),a.j41(6,"div",4)(7,"input-datetime",6),a.bIt("change",function(l){return e.onDataFimChange(l)}),a.k0s()()()()),2&o&&(a.Y8G("form",e.form)("title",e.isModal?"":e.title),a.R7$(3),a.Y8G("size",3)("items",e.OPTIONS),a.R7$(2),a.Y8G("size",3)("control",e.form.controls.data_inicial_pedagio)("labelInfo","In\xedcio do per\xedodo de ped\xe1gio"),a.R7$(2),a.Y8G("size",3)("control",e.form.controls.data_final_pedagio)("labelInfo","Fim do per\xedodo de ped\xe1gio"))},dependencies:[_.Q,O.r,Ma.t]})}}return i})(),canActivate:[m.q],resolve:{config:p.L},runGuardsAndResolvers:"always",data:{title:"Tornar a modalidade teletrabalho indispon\xedvel para o agente p\xfablico",modal:!0}}];let ka=(()=>{class i{static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275mod=a.$C({type:i})}static{this.\u0275inj=a.G2t({imports:[C.iI.forChild(ja),C.iI]})}}return i})();var Ya=r(9455),Ua=r(8832);let Va=(()=>{class i{static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275mod=a.$C({type:i})}static{this.\u0275inj=a.G2t({imports:[f.MD,Ya.h,Ua.X1,ka]})}}return i})()}}]);
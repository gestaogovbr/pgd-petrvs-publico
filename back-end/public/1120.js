"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[1120],{1120:(Ce,G,l)=>{l.r(G),l.d(G,{UsuarioModule:()=>Ue});var g=l(6610),A=l(8069),h=l(1620),v=l(6819),c=l(3308),I=l(1641),k=l(6867),y=l(3535),E=l(5413),_=l(3130),Y=l(24),b=l(5611),U=l(4489),$=l(4795),B=l(5723),C=l(9419),e=l(3279),N=l(2034),O=l(5852),F=l(9226),T=l(3678),V=l(1230),P=l(9209),z=l(5201);const M=["unidade"],X=["perfil"],H=a=>["nivel",">=",a],Q=a=>[a];function w(a,u){if(1&a&&(e.j41(0,"span")(1,"strong"),e.EFF(2),e.k0s()()),2&a){const i=e.XpG();e.R7$(2),e.JRh("Servidor: "+(null==i.entity?null:i.entity.nome))}}function J(a,u){if(1&a&&e.nrm(0,"top-alert",20),2&a){const i=e.XpG();e.Y8G("message","N\xe3o \xe9 poss\xedvel excluir ou alterar "+i.lex.translate("a lota\xe7\xe3o")+" "+i.lex.translate("do servidor")+". ")}}function K(a,u){if(1&a&&(e.j41(0,"strong"),e.EFF(1),e.k0s(),e.j41(2,"span"),e.EFF(3),e.k0s(),e.nrm(4,"br"),e.j41(5,"span"),e.EFF(6),e.k0s()),2&a){const i=u.row;e.R7$(),e.JRh(i.unidade_sigla||""),e.R7$(2),e.SpI(" ",i.informal?"(Unidade Informal)":"(C\xf3digo: "+(i.unidade_codigo||"")+")",""),e.R7$(3),e.SpI("",i.unidade_nome||""," ")}}function Z(a,u){if(1&a){const i=e.RV6();e.j41(0,"input-search",21,7),e.bIt("change",function(t){e.eBV(i);const o=e.XpG();return e.Njj(o.onUnidadeChange(t))}),e.k0s()}if(2&a){const i=e.XpG(),n=e.sdS(10);e.Y8G("disabled",null!=n&&n.adding?void 0:"true")("size",12)("dao",i.unidadeDao)}}function W(a,u){if(1&a&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&a){const i=u.row,n=e.XpG();e.R7$(),e.SpI("",n.util.getDateFormatted(i.ultima_atualizacao)," ")}}function x(a,u){if(1&a&&(e.j41(0,"div"),e.nrm(1,"badge",23)(2,"br"),e.k0s()),2&a){const i=u.$implicit,n=e.XpG(2);e.R7$(),e.Y8G("color",n.lookup.getColor(n.lookup.UNIDADE_INTEGRANTE_TIPO,i||""))("icon",n.lookup.getIcon(n.lookup.UNIDADE_INTEGRANTE_TIPO,i||""))("label",n.lookup.getValue(n.lookup.UNIDADE_INTEGRANTE_TIPO,i||""))}}function q(a,u){1&a&&e.DNE(0,x,3,3,"div",22),2&a&&e.Y8G("ngForOf",u.row.atribuicoes)}function ee(a,u){if(1&a&&(e.j41(0,"input-multiselect",24),e.nrm(1,"input-select",25),e.k0s()),2&a){const i=e.XpG();e.Y8G("size",8)("addItemHandle",i.addItemHandle.bind(i))("deleteItemHandle",i.deleteItemHandle.bind(i)),e.R7$(),e.Y8G("size",12)("items",i.atribuicoes)}}let R=(()=>{class a extends $.g{set control(i){super.control=i}get control(){return super.control}set entity(i){super.entity=i}get entity(){return super.entity}set noPersist(i){super.noPersist=i}get noPersist(){return super.noPersist}constructor(i){var n;super(i),n=this,this.injector=i,this.items=[],this.perfilUsuario="",this.atribuicoes=[],this.editando=!1,this.validate=(t,o)=>{let r=null;return["unidade_id","perfil_id","atribuicoes"].includes(o)&&!t.value?.length&&(r="Obrigat\xf3rio"),"unidade_id"==o&&this.grid?.adding&&this.items.map(s=>s.id).includes(t.value)&&(r="O usu\xe1rio j\xe1 \xe9 integrante desta unidade. Edite-a, ao inv\xe9s de inclu\xed-la novamente!"),r},this.asyncFormValidation=function(){var t=(0,c.A)(function*(o){if(n.util.array_diff(["GESTOR","GESTOR_SUBSTITUTO","GESTOR_DELEGADO"],o.controls.atribuicoes.value.map(m=>m.key)||[]).length<2)return"A um mesmo servidor s\xf3 pode ser atribu\xedda uma fun\xe7\xe3o de gestor (titular, substituto ou delegado), para uma mesma Unidade!";if(o.controls.atribuicoes.value.filter(m=>"CURADOR"==m.key).length>0){const m=n.form?.controls.unidade_id.value;if(m&&!(yield n.unidadeDao.getById(m))?.instituidora)return"N\xe3o \xe9 poss\xedvel associar atribui\xe7\xe3o de Curador a Unidade n\xe3o Instituidora"}});return function(o){return t.apply(this,arguments)}}(),this.integranteService=i.get(B.H),this.integranteDao=i.get(U.f),this.unidadeDao=i.get(y.s),this.usuarioDao=i.get(E._),this.perfilDao=i.get(C.e),this.form=this.fh.FormBuilder({unidade_id:{default:""},atribuicoes:{default:void 0},atribuicao:{default:""}},this.cdRef,this.validate),this.formPerfil=this.fh.FormBuilder({perfil_id:{default:""}},this.cdRef,this.validate),this.join=["integracaoServidor"]}ngOnInit(){super.ngOnInit(),this.entity=this.entity??this.metadata?.entity}onUnidadeChange(i){var n=this;return(0,c.A)(function*(){const t=n.form?.controls.unidade_id.value;let o=n.lookup.UNIDADE_INTEGRANTE_TIPO;t?((yield n.unidadeDao.getById(t))?.instituidora||(o=n.lookup.UNIDADE_INTEGRANTE_TIPO.filter(s=>"CURADOR"!==s.key)),n.perfil&&(yield n.perfilDao.getById(n.perfil.currentValue).then(s=>{s&&6===s.nivel&&(o=o.filter(m=>"CURADOR"!==m.key&&"GESTOR_SUBSTITUTO"!==m.key))})),n.atribuicoes=o,n.form?.controls.atribuicao.setValue("COLABORADOR")):n.atribuicoes=[]})()}ngAfterViewInit(){var i=this;(0,c.A)(function*(){yield i.loadData(i.entity||{},i.form)})()}loadData(i,n){var t=this;return(0,c.A)(function*(){if(i.id){t.editando=!0;let o=[];try{yield t.integranteDao.carregarIntegrantes("",i.id).then(r=>o=r.integrantes.filter(s=>s.atribuicoes?.length>0))}finally{t.perfilUsuario=i.perfil_id,t.formPerfil.controls.perfil_id.setValue(t.perfilUsuario),t.items=[],o.forEach(r=>t.items?.push(t.integranteService.completarIntegrante(r,r.id,i.id,r.atribuicoes))),t.items=t.integranteService.ordenarIntegrantes(t.items),t.cdRef.detectChanges(),t.grid.loading=!1}}})()}salvarPerfil(){var i=this;return(0,c.A)(function*(){i.submitting=!0,i.usuarioDao?.update(i.entity.id,{perfil_id:i.formPerfil.controls.perfil_id.value},[]).then(n=>{i.perfilUsuario=n.perfil_id,i.submitting=!1})})()}addItemHandle(){let i;const n=this.lookup.getValue(this.lookup.UNIDADE_INTEGRANTE_TIPO,this.form.controls.atribuicao.value),t=this.form.controls.atribuicao.value;return n?.length&&this.util.validateLookupItem(this.form.controls.atribuicao.value,t)&&(i={key:t,value:n,icon:this.lookup.getIcon(this.lookup.UNIDADE_INTEGRANTE_TIPO,this.form.controls.atribuicao.value),color:this.lookup.getColor(this.lookup.UNIDADE_INTEGRANTE_TIPO,this.form.controls.atribuicao.value)},this.form.controls.atribuicao.setValue("")),i}deleteItemHandle(i){return"LOTADO"!=i.key}carregarIntegrante(i,n){var t=this;return(0,c.A)(function*(){i.controls.unidade_id.setValue(t.grid?.adding?n.unidade_id:n.id),i.controls.atribuicoes.setValue(t.integranteService.converterAtribuicoes(n.atribuicoes)),i.controls.atribuicao.setValue("")})()}adicionarIntegrante(){var i=this;return(0,c.A)(function*(){return i.editando=!0,i.grid&&(i.grid.error=""),{id:i.integranteDao.generateUuid(),unidade_id:"",atribuicoes:[],usuario_externo:!0}})()}removerIntegrante(i){var n=this;return(0,c.A)(function*(){if(i.atribuicoes.includes("LOTADO"))yield n.dialog.alert("IMPOSS\xcdVEL EXCLUIR !","O v\xednculo que inclui "+n.lex.translate("a lota\xe7\xe3o")+" "+n.lex.translate("do servidor")+" n\xe3o pode ser exclu\xeddo. Se deseja excluir as demais atribui\xe7\xf5es, edite o v\xednculo. Se deseja alterar "+n.lex.translate("a lota\xe7\xe3o")+", lote-o em outra "+n.lex.translate("Unidade")+".");else if(yield n.dialog.confirm("Exclui ?","Deseja realmente excluir todas as atribui\xe7\xf5es de "+n.entity.nome.toUpperCase()+" "+n.lex.translate("na unidade")+" "+i.unidade_sigla?.toUpperCase()+" ?")){let o;try{if(n.isNoPersist)return Object.assign(i,{_status:"DELETE",atribuicoes:[]}),!1;n.loading=!0,yield n.integranteDao.salvarIntegrantes([n.integranteService.completarIntegrante(i,i.id,n.entity.id,[])]).then(r=>{(o=r.find(s=>s._metadata.msg?.length)?._metadata.msg)&&n.grid&&(n.grid.error=o)}),yield n.loadData({id:n.entity.id},n.form)}finally{n.loading=!1}}return!1})()}salvarIntegrante(i,n){var t=this;return(0,c.A)(function*(){let o=t.lookup.uniqueLookupItem(i.controls.atribuicoes.value);i.controls.atribuicoes.setValue(o),t.grid&&(t.grid.error=""),t.cdRef.detectChanges();let r=yield t.asyncFormValidation(i);if(r)yield t.dialog.alert("IMPOSS\xcdVEL INCLUIR/ALTERAR A UNIDADE !",r);else{let s=t.grid?.items||[],m=!0,f=t.integranteService.haAlteracaoGestor(o.map(d=>d.key),Object.assign(n,{unidade_sigla:t.unidade?.selectedItem?.entity.sigla}),s,t.entity?.nome||t.parent?.form?.controls.nome.value||"");if("nenhuma"!=f[0]){if(m=yield t.dialog.confirm("CONFIRMA A ALTERA\xc7\xc3O DA CHEFIA ?",f[2]),!m)return;switch(f[0]){case"ganho":if(f[3]){let d=t.grid?.items.findIndex(p=>p.atribuicoes.includes("LOTADO"));d&&(t.grid.items[d].atribuicoes=t.grid.items[d].atribuicoes.filter(p=>"LOTADO"!=p))}break;case"troca":t.grid.items[f[1]].atribuicoes=t.grid.items[f[1]].atribuicoes.filter(d=>!["GESTOR","LOTADO"].includes(d))}o=t.integranteService.inserirAtribuicao(o,"LOTADO"),i.controls.atribuicoes.setValue(o),t.loading=!0}else{let d=t.integranteService.haAlteracaoLotacao(i,Object.assign(n,{unidade_sigla:t.unidade?.selectedItem?.entity.sigla}),s,t.entity?.nome||"");if(d[0]){if(t.grid?.items[d[1]].atribuicoes.includes("GESTOR"))return void(yield t.dialog.alert("IMPOSS\xcdVEL ALTERAR A LOTA\xc7\xc3O !",d[3]));if(m=yield t.dialog.confirm("CONFIRMA A ALTERA\xc7\xc3O DA LOTA\xc7\xc3O ?",d[2]),!m)return;t.grid.items[d[1]].atribuicoes=t.grid.items[d[1]].atribuicoes.filter(p=>"LOTADO"!=p)}}try{t.isNoPersist?(n.id=t.unidade?.selectedEntity.id,t.grid.items=t.integranteService.substituirItem({id:n.id,itens:t.grid?.items||[],apelidoOuSigla:t.unidade?.selectedItem?.entity.sigla,nome:t.unidade?.selectedItem?.entity.nome,codigo:t.unidade?.selectedItem?.entity.codigo},o.map(d=>d.key),new _.P(t.entity)),t.cdRef.detectChanges()):(yield t.integranteDao.salvarIntegrantes([t.integranteService.completarIntegrante(n,i.controls.unidade_id.value,t.entity.id,o.map(d=>d.key))]).then(d=>{let p;(p=d?.find(j=>j._metadata.msg?.length)?._metadata.msg)&&t.dialog.alert("ATEN\xc7\xc3O: ERRO!",p)}),yield t.loadData({id:t.entity.id},t.form),t.grid&&(t.grid.error=""))}catch(d){t.grid&&(t.grid.error=d),yield t.loadData({id:t.entity.id},t.form)}finally{t.loading=!1}}})()}isNoButtons(){return this.isNoPersist||this.formPerfil.controls.perfil_id.value==this.perfilUsuario?"true":void 0}autoGerenciar(){return(this.entity?.id??"")==(this.auth?.usuario?.id??"")&&"ADD"!=this.entity?._status?(this.entity?.perfil?.nivel??0)<3:this.auth?.hasPermissionTo("MOD_USER_ATRIB")??!1}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(e.zZn))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["usuario-integrante"]],viewQuery:function(n,t){if(1&n&&(e.GBs(b._,5),e.GBs(M,5),e.GBs(X,5)),2&n){let o;e.mGM(o=e.lsd())&&(t.grid=o.first),e.mGM(o=e.lsd())&&(t.unidade=o.first),e.mGM(o=e.lsd())&&(t.perfil=o.first)}},inputs:{control:"control",entity:"entity",noPersist:"noPersist",parent:"parent"},features:[e.Vt3],decls:27,vars:32,consts:[["perfil",""],["grid",""],["columnUnidade",""],["editUnidade",""],["columnDataSIAPE",""],["columnAtribuicoes",""],["editAtribuicoes",""],["unidade",""],[4,"ngIf"],[1,"row"],[1,"col-4"],["title","",3,"submit","form","noButtons","disabled"],["controlName","perfil_id","required","",3,"change","disabled","label","dao","where"],[1,"col"],["type","warning",3,"message"],["editable","",3,"items","minHeight","form","hasEdit","hasAdd","hasDelete","add","load","remove","save"],["type","alert",3,"message",4,"ngIf"],[3,"title","template","editTemplate"],[3,"title","template"],["type","options"],["type","alert",3,"message"],["label","","icon","","controlName","unidade_id",3,"change","disabled","size","dao"],[4,"ngFor","ngForOf"],[3,"color","icon","label"],["controlName","atribuicoes",3,"size","addItemHandle","deleteItemHandle"],["label","","icon","fas fa-sign-out-alt","controlName","atribuicao",3,"size","items"]],template:function(n,t){if(1&n){const o=e.RV6();e.DNE(0,w,3,1,"span",8),e.j41(1,"div",9)(2,"div",10)(3,"editable-form",11),e.bIt("submit",function(){return e.eBV(o),e.Njj(t.salvarPerfil())}),e.j41(4,"div",9)(5,"input-select",12,0),e.bIt("change",function(s){return e.eBV(o),e.Njj(t.onUnidadeChange(s))}),e.k0s()()()(),e.j41(7,"div",13),e.nrm(8,"top-alert",14),e.k0s()(),e.j41(9,"grid",15,1),e.DNE(11,J,1,1,"top-alert",16),e.j41(12,"columns")(13,"column",17),e.DNE(14,K,7,3,"ng-template",null,2,e.C5r)(16,Z,2,3,"ng-template",null,3,e.C5r),e.k0s(),e.j41(18,"column",18),e.DNE(19,W,2,1,"ng-template",null,4,e.C5r),e.k0s(),e.j41(21,"column",17),e.DNE(22,q,1,1,"ng-template",null,5,e.C5r)(24,ee,2,5,"ng-template",null,6,e.C5r),e.k0s(),e.nrm(26,"column",19),e.k0s()()}if(2&n){const o=e.sdS(15),r=e.sdS(17),s=e.sdS(20),m=e.sdS(23),f=e.sdS(25);e.Y8G("ngIf",!t.isNoPersist),e.R7$(3),e.Y8G("form",t.formPerfil)("noButtons",t.isNoButtons())("disabled",t.formDisabled),e.R7$(2),e.Y8G("disabled",t.auth.hasPermissionTo("MOD_CFG_USER_PERFIL")?void 0:"true")("label",t.lex.translate("Perfil"))("dao",t.perfilDao)("where",e.eq3(30,Q,e.eq3(28,H,!t.editando||null!=t.entity&&t.entity.usuario_externo?6:0))),e.R7$(3),e.Y8G("message","Ao conceder a "+t.lex.translate("um usu\xe1rio")+" a atribui\xe7\xe3o de "+t.lookup.getValue(t.lookup.UNIDADE_INTEGRANTE_TIPO,"GESTOR")+", "+t.lookup.getValue(t.lookup.UNIDADE_INTEGRANTE_TIPO,"GESTOR_SUBSTITUTO")+" ou de "+t.lookup.getValue(t.lookup.UNIDADE_INTEGRANTE_TIPO,"GESTOR_DELEGADO")+" em "+t.lex.translate("uma unidade")+", deve lhe ser concedido tamb\xe9m "+t.lex.translate("o n\xedvel de acesso")+" correspondente."),e.R7$(),e.Y8G("items",t.items)("minHeight",500)("form",t.form)("hasEdit",t.autoGerenciar())("hasAdd",t.autoGerenciar())("hasDelete",t.autoGerenciar())("add",t.adicionarIntegrante.bind(t))("load",t.carregarIntegrante.bind(t))("remove",t.removerIntegrante.bind(t))("save",t.salvarIntegrante.bind(t)),e.R7$(2),e.Y8G("ngIf",!t.isNoPersist),e.R7$(2),e.Y8G("title",t.lex.translate("Unidades"))("template",o)("editTemplate",r),e.R7$(5),e.Y8G("title",t.lex.translate("\xdaltima data SIAPE"))("template",s),e.R7$(3),e.Y8G("title",t.lex.translate("Atribui\xe7\xf5es"))("template",m)("editTemplate",f)}},dependencies:[g.Sq,g.bT,b._,N.T,O.I,I.Q,F.O,T.K,V.b,P.P,z.n]})}}return a})();var S=l(16),te=l(5524),ie=l(2075),ne=l(6774),L=l(5825),ae=l(6336),oe=l(5295);const le=["lotacao"];function re(a,u){if(1&a&&(e.j41(0,"tab",20)(1,"div",4),e.nrm(2,"input-editor",21),e.k0s()()),2&a){const i=e.XpG();e.R7$(2),e.Y8G("label","")("dataset",i.planoDataset)}}function se(a,u){if(1&a&&e.nrm(0,"document-preview",24),2&a){const i=e.XpG(2);e.Y8G("html",(null==i.entity||null==i.entity.ultimo_plano_trabalho_ativo||null==i.entity.ultimo_plano_trabalho_ativo.documentos||null==i.entity.ultimo_plano_trabalho_ativo.documentos[0]?null:i.entity.ultimo_plano_trabalho_ativo.documentos[0].conteudo)||"")}}function ue(a,u){if(1&a&&(e.j41(0,"tab",22),e.DNE(1,se,1,1,"document-preview",23),e.k0s()),2&a){const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==i.entity?null:i.entity.ultimo_plano_trabalho_ativo)}}function de(a,u){if(1&a&&(e.j41(0,"small")(1,"span",25),e.EFF(2),e.k0s()()),2&a){const i=e.XpG();e.R7$(2),e.Lme("** Cadastro realizado por ",(null==i.entity||null==i.entity.audits_externo[0]?null:i.entity.audits_externo[0].performed_by)||"carregando..."," em ",(null==i.entity||null==i.entity.audits_externo[0]?null:i.entity.audits_externo[0].created_at)||"carregando..."," ")}}let D=(()=>{class a extends Y.n{constructor(i){super(i,_.P,E._),this.injector=i,this.validate=(n,t)=>{let o=null;return"cpf"==t&&!this.util.validarCPF(n.value)&&(o="Inv\xe1lido"),"data_nascimento"==t&&null==n.value||["data_nascimento"].indexOf(t)>=0&&!this.dao?.validDateTime(n.value)&&(o="Inv\xe1lido"),o},this.formValidation=n=>this.unidadesIntegrantes?.formPerfil.controls.perfil_id.value?.length?"new"!=this.action&&this.unidadesIntegrantes?.grid?.items.find((t,o,r)=>!(t.unidade_id.length&&t.usuario_id.length))?"Na aba 'Atribui\xe7\xf5es' h\xe1 "+this.lex.translate("unidade")+" com edi\xe7\xe3o n\xe3o conclu\xedda. Conclua-a antes de salvar "+this.lex.translate("o servidor")+"!":void 0:"\xc9 obrigat\xf3rio a defini\xe7\xe3o de um "+this.lex.translate("perfil")+" para "+this.lex.translate("o servidor")+". Utilize a aba 'Atribui\xe7\xf5es'.",this.titleEdit=n=>"Editando "+this.lex.translate("Usu\xe1rio")+": "+(n?.nome||""),this.unidadeDao=i.get(y.s),this.integranteDao=i.get(U.f),this.planoTrabalhoDao=i.get(k.x),this.form=this.fh.FormBuilder({email:{default:""},nome:{default:""},cpf:{default:""},apelido:{default:""},usuario_externo:{default:!0},telefone:{default:""},uf:{default:""},sexo:{default:null},url_foto:{default:""},texto_complementar_plano:{default:""},data_nascimento:{default:null}},this.cdRef,this.validate),this.planoDataset=this.planoTrabalhoDao.dataset(),this.join=["auditsExterno","ultimoPlanoTrabalhoAtivo.documentos"]}loadData(i,n){var t=this;return(0,c.A)(function*(){let o=Object.assign({},n.value);n.patchValue(t.util.fillForm(o,i)),yield t.unidadesIntegrantes?.loadData(i)})()}initializeData(i){this.entity=new _.P,this.loadData(this.entity,i)}saveData(i){var n=this;return new Promise(function(){var t=(0,c.A)(function*(o,r){n.unidadesIntegrantes.grid.confirm();let s=n.util.fill(new _.P,n.entity);s=n.util.fillForm(s,n.form.value),s.perfil_id=n.unidadesIntegrantes?.formPerfil.controls.perfil_id.value;let m=n.unidadesIntegrantes?.items||[],f=m.findIndex(d=>d.atribuicoes.includes("LOTADO"));m.forEach((d,p,j)=>{p!=f&&"DELETE"==d._status&&(d.atribuicoes=[])}),s.integrantes=m,o(s)});return function(o,r){return t.apply(this,arguments)}}())}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(e.zZn))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-usuario-form"]],viewQuery:function(n,t){if(1&n&&(e.GBs(I.Q,5),e.GBs(R,5),e.GBs(le,5)),2&n){let o;e.mGM(o=e.lsd())&&(t.editableForm=o.first),e.mGM(o=e.lsd())&&(t.unidadesIntegrantes=o.first),e.mGM(o=e.lsd())&&(t.lotacao=o.first)}},features:[e.Vt3],decls:23,vars:30,consts:[["unidadesIntegrantes",""],["initialFocus","cpf",3,"submit","cancel","form","disabled","title"],["display","","right",""],["key","PRINCIPAL","label","Principal"],[1,"row"],[1,"form-group","col-md-3","text-center"],[1,"mt-5",3,"url","size"],[1,"form-group","col-md-9"],["label","CPF","controlName","cpf","required","",3,"disabled","size","maskFormat"],["label","E-mail","controlName","email","textCase","lower","required","",3,"disabled","size"],["date","","label","Nascimento","noIcon","","controlName","data_nascimento",3,"size","labelInfo","disabled"],["label","Nome","controlName","nome","required","",3,"size","disabled"],["label","UF","icon","bi bi-flag","controlName","uf",3,"size","items","disabled"],["label","Telefone","controlName","telefone",3,"size","maskFormat"],["key","CONFIGURACOES","label","TCR- Particularidades do participante",4,"ngIf"],["key","TCR","label","TCR compilado",4,"ngIf"],["key","ATRIBUICOES",3,"label"],["type","alert",3,"message"],["noPersist","",3,"entity"],[4,"ngIf"],["key","CONFIGURACOES","label","TCR- Particularidades do participante"],["controlName","texto_complementar_plano",3,"label","dataset"],["key","TCR","label","TCR compilado"],["emptysDocumentMensage","Vazio",3,"html",4,"ngIf"],["emptysDocumentMensage","Vazio",3,"html"],[1,"fs-6","text-danger"]],template:function(n,t){if(1&n){const o=e.RV6();e.j41(0,"editable-form",1),e.bIt("submit",function(){return e.eBV(o),e.Njj(t.onSaveData())})("cancel",function(){return e.eBV(o),e.Njj(t.onCancel())}),e.j41(1,"tabs",2)(2,"tab",3)(3,"div",4)(4,"div",5),e.nrm(5,"profile-picture",6),e.k0s(),e.j41(6,"div",7)(7,"div",4),e.nrm(8,"input-text",8)(9,"input-text",9)(10,"input-datetime",10),e.k0s(),e.j41(11,"div",4),e.nrm(12,"input-text",11),e.k0s(),e.j41(13,"div",4),e.nrm(14,"input-select",12)(15,"input-text",13),e.k0s()()()(),e.DNE(16,re,3,2,"tab",14)(17,ue,2,1,"tab",15),e.j41(18,"tab",16),e.nrm(19,"top-alert",17)(20,"usuario-integrante",18,0),e.k0s()()(),e.DNE(22,de,3,2,"small",19)}2&n&&(e.Y8G("form",t.form)("disabled",t.formDisabled)("title",t.isModal?"":t.title),e.R7$(5),e.Y8G("url",t.form.controls.url_foto.value)("size",150),e.R7$(3),e.Y8G("disabled",null!=t.entity&&t.entity.usuario_externo?void 0:"true")("size",3)("maskFormat","000.000.000-00"),e.BMQ("maxlength",15),e.R7$(),e.Y8G("disabled",null!=t.entity&&t.entity.usuario_externo?void 0:"true")("size",6),e.BMQ("maxlength",250),e.R7$(),e.Y8G("size",3)("labelInfo","Data de nascimento")("disabled",null!=t.entity&&t.entity.usuario_externo?void 0:"true"),e.R7$(2),e.Y8G("size",12)("disabled",null!=t.entity&&t.entity.usuario_externo?void 0:"true"),e.BMQ("maxlength",250),e.R7$(2),e.Y8G("size",6)("items",t.lookup.UF)("disabled",null!=t.entity&&t.entity.usuario_externo?void 0:"true"),e.R7$(),e.Y8G("size",6)("maskFormat","(00) 0000-0000||(00) 0 0000-0000"),e.BMQ("maxlength",250),e.R7$(),e.Y8G("ngIf",(null==t.entity?null:t.entity.id)&&!(null!=t.entity&&t.entity.usuario_externo)),e.R7$(),e.Y8G("ngIf",(null==t.entity?null:t.entity.id)&&!(null!=t.entity&&t.entity.usuario_externo)),e.R7$(),e.Y8G("label",t.lex.translate("Atribui\xe7\xf5es")),e.R7$(),e.Y8G("message"," N\xe3o \xe9 poss\xedvel excluir ou alterar "+t.lex.translate("a lota\xe7\xe3o")+" "+t.lex.translate("do servidor")+". "),e.R7$(),e.Y8G("entity",t.entity),e.R7$(2),e.Y8G("ngIf",(null==t.entity?null:t.entity.id)&&(null==t.entity?null:t.entity.usuario_externo)))},dependencies:[g.bT,I.Q,S.H,te.r,T.K,ie.O,ne.j,P.P,L.r,ae.p,oe.F,R]})}}return a})();var me=l(9062),ce=l(7772),fe=l(2305),pe=l(6764),ge=l(3542);function he(a,u){if(1&a&&(e.j41(0,"h3",20),e.EFF(1),e.k0s()),2&a){const i=e.XpG();e.R7$(),e.JRh(i.title)}}function ve(a,u){1&a&&e.nrm(0,"toolbar")}function _e(a,u){if(1&a&&e.nrm(0,"profile-picture",21),2&a){const i=u.row;e.Y8G("url",i.url_foto)("size",40)("hint",i.nome)}}function be(a,u){if(1&a&&e.nrm(0,"i",23),2&a){const i=e.XpG().row,n=e.XpG();e.Y8G("title","Em ped\xe1gio at\xe9: "+n.dao.getDateFormatted(i.data_inicial_pedagio)),e.BMQ("data-bs-toggle","tooltip")}}function Ie(a,u){1&a&&e.DNE(0,be,1,2,"i",22),2&a&&e.Y8G("ngIf",u.row.pedagio)}function ye(a,u){1&a&&(e.j41(0,"label",25),e.EFF(1,"Usu\xe1rio Externo"),e.k0s())}function Ee(a,u){if(1&a&&(e.EFF(0),e.nrm(1,"br"),e.DNE(2,ye,2,0,"label",24)),2&a){const i=u.row;e.SpI(" ",i.nome,""),e.R7$(2),e.Y8G("ngIf",i.usuario_externo)}}function Te(a,u){if(1&a&&(e.j41(0,"strong"),e.EFF(1),e.k0s()),2&a){const i=u.row;e.R7$(),e.JRh((null==i.perfil?null:i.perfil.nome)||"")}}const Re=[{path:"",component:(()=>{class a extends me.P{constructor(i){super(i,_.P,E._),this.injector=i,this.filterWhere=n=>{let t=[];return n?.controls.usuario?.value?.length&&t.push(["nome","like","%"+n?.controls.usuario?.value.trim().replace(" ","%")+"%"]),n?.controls.unidade_id?.value?.length&&t.push(["lotacao","==",n?.controls.unidade_id.value]),n?.controls.perfil_id?.value?.length&&t.push(["perfil_id","==",n?.controls.perfil_id?.value]),n?.controls.atribuicoes?.value?.length&&t.push(["atribuicoes","==",n?.controls.atribuicoes?.value]),t},this.unidadeDao=i.get(y.s),this.perfilDao=i.get(C.e),this.title=this.lex.translate("Usu\xe1rios"),this.code="MOD_CFG_USER",this.join=["perfil:id,nome"],this.filter=this.fh.FormBuilder({usuario:{default:""},unidade_id:{default:""},perfil_id:{default:null},atribuicoes:{default:null}}),this.addOption(this.OPTION_INFORMACOES,"MOD_USER")}dynamicOptions(i){let n=[];return this.auth.hasPermissionTo("MOD_USER_ATRIB")&&n.push({label:"Atribui\xe7\xf5es",icon:"bi bi-list-task",onClick:t=>{this.go.navigate({route:["configuracoes","usuario",t.id,"integrante"]},{metadata:{entity:i}})}}),n}static{this.\u0275fac=function(n){return new(n||a)(e.rXU(e.zZn))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-usuario-list"]],viewQuery:function(n,t){if(1&n&&e.GBs(b._,5),2&n){let o;e.mGM(o=e.lsd())&&(t.grid=o.first)}},features:[e.Vt3],decls:25,vars:42,consts:[["columnFoto",""],["columnPedagio",""],["columnNome",""],["columnPerfil",""],["class","my-2",4,"ngIf"],[3,"select","dao","add","orderBy","groupBy","join","selectable","hasAdd","hasEdit"],[4,"ngIf"],[3,"form","where","submit","collapseChange","collapsed"],[1,"row"],["controlName","usuario","placeholder","Nome",3,"size","label","control"],["controlName","unidade_id",3,"size","label","control","dao"],["controlName","perfil_id","nullable","",3,"size","label","control","dao"],["controlName","atribuicoes",3,"size","label","control","items","inline"],["icon","bi-person",3,"align","template"],["title","Ped\xe1gio","field","pedagio",3,"template"],["title","CPF","field","cpf"],["title","Nome","field","nome","orderBy","nome",3,"template"],[3,"title","template"],["type","options",3,"onEdit","dynamicOptions","options"],[3,"rows"],[1,"my-2"],[3,"url","size","hint"],["class","bi bi-exclamation-triangle text-danger",3,"title",4,"ngIf"],[1,"bi","bi-exclamation-triangle","text-danger",3,"title"],["class","badge text-bg-warning",4,"ngIf"],[1,"badge","text-bg-warning"]],template:function(n,t){if(1&n){const o=e.RV6();e.DNE(0,he,2,1,"h3",4),e.j41(1,"grid",5),e.bIt("select",function(s){return e.eBV(o),e.Njj(t.onSelect(s))}),e.DNE(2,ve,1,0,"toolbar",6),e.j41(3,"filter",7)(4,"div",8),e.nrm(5,"input-text",9)(6,"input-search",10)(7,"input-select",11)(8,"input-check",12),e.k0s()(),e.j41(9,"columns")(10,"column",13),e.DNE(11,_e,1,3,"ng-template",null,0,e.C5r),e.k0s(),e.j41(13,"column",14),e.DNE(14,Ie,1,1,"ng-template",null,1,e.C5r),e.k0s(),e.nrm(16,"column",15),e.j41(17,"column",16),e.DNE(18,Ee,3,2,"ng-template",null,2,e.C5r),e.k0s(),e.j41(20,"column",17),e.DNE(21,Te,2,1,"ng-template",null,3,e.C5r),e.k0s(),e.nrm(23,"column",18),e.k0s(),e.nrm(24,"pagination",19),e.k0s()}if(2&n){const o=e.sdS(12),r=e.sdS(15),s=e.sdS(19),m=e.sdS(22);e.Y8G("ngIf",!t.isModal),e.R7$(),e.Y8G("dao",t.dao)("add",t.add)("orderBy",t.orderBy)("groupBy",t.groupBy)("join",t.join)("selectable",t.selectable)("hasAdd",t.auth.hasPermissionTo("MOD_USER_INCL"))("hasEdit",t.auth.hasPermissionTo("MOD_USER_EDT")),e.R7$(),e.Y8G("ngIf",!t.selectable),e.R7$(),e.Y8G("form",t.filter)("where",t.filterWhere)("submit",t.filterSubmit.bind(t))("collapseChange",t.filterCollapseChange.bind(t))("collapsed",!t.selectable&&t.filterCollapsed),e.R7$(2),e.Y8G("size",4)("label",t.lex.translate("Usu\xe1rio"))("control",t.filter.controls.usuario),e.BMQ("maxlength",250),e.R7$(),e.Y8G("size",4)("label",t.lex.translate("Lota\xe7\xe3o"))("control",t.filter.controls.unidade_id)("dao",t.unidadeDao),e.R7$(),e.Y8G("size",4)("label",t.lex.translate("Perfil"))("control",t.filter.controls.perfil_id)("dao",t.perfilDao),e.R7$(),e.Y8G("size",12)("label",t.lex.translate("Atribui\xe7\xf5es"))("control",t.filter.controls.atribuicoes)("items",t.lookup.UNIDADE_INTEGRANTE_TIPO)("inline",!0),e.R7$(2),e.Y8G("align","center")("template",o),e.R7$(3),e.Y8G("template",r),e.R7$(4),e.Y8G("template",s),e.R7$(3),e.Y8G("title",t.lex.translate("Perfil"))("template",m),e.R7$(3),e.Y8G("onEdit",t.edit)("dynamicOptions",t.dynamicOptions.bind(t))("options",t.options),e.R7$(),e.Y8G("rows",t.rowsLimit)}},dependencies:[g.bT,b._,N.T,O.I,ce.i,fe.H,pe.e,F.O,S.H,T.K,L.r,ge.e]})}}return a})(),canActivate:[h.q],resolve:{config:v.L},runGuardsAndResolvers:"always",data:{title:"Usu\xe1rios"}},{path:"new",component:D,canActivate:[h.q],resolve:{config:v.L},runGuardsAndResolvers:"always",data:{title:"Inclus\xe3o de Usu\xe1rio",modal:!0}},{path:":id/edit",component:D,canActivate:[h.q],resolve:{config:v.L},runGuardsAndResolvers:"always",data:{title:"Edi\xe7\xe3o de Usu\xe1rio",modal:!0}},{path:":id/consult",component:D,canActivate:[h.q],resolve:{config:v.L},runGuardsAndResolvers:"always",data:{title:"Consulta a Usu\xe1rio",modal:!0}},{path:":id/integrante",component:R,canActivate:[h.q],resolve:{config:v.L},runGuardsAndResolvers:"always",data:{title:"Atribui\xe7\xf5es do Usu\xe1rio",modal:!0}}];let De=(()=>{class a{static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275mod=e.$C({type:a})}static{this.\u0275inj=e.G2t({imports:[A.iI.forChild(Re),A.iI]})}}return a})();var Ge=l(9455),Ae=l(8832);let Ue=(()=>{class a{static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275mod=e.$C({type:a})}static{this.\u0275inj=e.G2t({imports:[g.MD,Ge.h,Ae.X1,De]})}}return a})()}}]);
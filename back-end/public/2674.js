"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[2674],{2674:(Oe,T,l)=>{l.r(T),l.d(T,{ProdutoModule:()=>ke});var v=l(6610),j=l(1260),d=l(3308),z=l(6409),c=l(5611),b=l(4423),t=l(3279);let f=(()=>{class i extends b.F{constructor(e){super("Produto",e),this.injector=e,this.inputSearchConfig.searchFields=["nome"]}static{this.\u0275fac=function(s){return new(s||i)(t.KVO(t.zZn))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var P=l(291);class C extends P.C{constructor(a){super(),this.identificador=0,this.nome="",this.responsavel_id="",this.data_ativado=new Date,this.data_desativado=new Date,this.nome_fantasia="",this.tipo="produto",this.descricao="",this.url="",this.produto_processo_cadeia_valor=[],this.produto_produto=[],this.produto_cliente=[],this.produto_solucoes=[],this.unidade_id="",this.initialization(a)}}var U=l(9062),k=l(4796);let J=(()=>{class i{constructor(e){this.auth=e,this.produto=[]}static{this.\u0275fac=function(s){return new(s||i)(t.KVO(k.u))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var y=l(2034),F=l(5852),Q=l(7772),X=l(2305),H=l(6764),K=l(114),S=l(16),Z=l(5201);function W(i,a){1&i&&t.nrm(0,"toolbar")}function q(i,a){1&i&&(t.j41(0,"span"),t.EFF(1,"Nome"),t.k0s())}function x(i,a){1&i&&(t.j41(0,"span"),t.EFF(1,"#ID"),t.k0s())}function tt(i,a){1&i&&(t.j41(0,"span"),t.EFF(1,"Cliente"),t.k0s())}function et(i,a){1&i&&(t.j41(0,"span"),t.EFF(1,"Unidade"),t.k0s())}function ot(i,a){1&i&&(t.j41(0,"span"),t.EFF(1,"Status"),t.k0s())}function it(i,a){if(1&i&&(t.j41(0,"div",23),t.EFF(1," Filtros aplicados: "),t.DNE(2,q,2,0,"span",6)(3,x,2,0,"span",6)(4,tt,2,0,"span",6)(5,et,2,0,"span",6)(6,ot,2,0,"span",6),t.k0s()),2&i){const e=t.XpG();t.R7$(2),t.Y8G("ngIf",e.filter.controls.nome.value.length>0),t.R7$(),t.Y8G("ngIf",e.filter.controls.id.value.length>0),t.R7$(),t.Y8G("ngIf",e.filter.controls.cliente_id.value.length>0),t.R7$(),t.Y8G("ngIf",e.filter.controls.unidade_id.value.length>0),t.R7$(),t.Y8G("ngIf",!e.isSearching&&e.filter.controls.status.value.length>0)}}function st(i,a){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s(),t.nrm(2,"br")),2&i){const e=a.row;t.R7$(),t.SpI(" ",e.identificador,"")}}function nt(i,a){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s(),t.nrm(2,"br")),2&i){const e=a.row;t.R7$(),t.SpI(" ",e.nome,"")}}function at(i,a){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s(),t.nrm(2,"br")),2&i){const e=a.row;t.R7$(),t.SpI(" ",e.nome_fantasia,"")}}function rt(i,a){1&i&&t.nrm(0,"badge",27)}function lt(i,a){1&i&&t.nrm(0,"badge",28)}function dt(i,a){if(1&i&&t.DNE(0,rt,1,0,"badge",25)(1,lt,1,0,"badge",26),2&i){const e=a.row,s=t.XpG(2);t.Y8G("ngIf",s.ativo(e)),t.R7$(),t.Y8G("ngIf",!s.ativo(e))}}function ut(i,a){if(1&i&&(t.j41(0,"column",24),t.DNE(1,dt,2,2,"ng-template",null,3,t.C5r),t.k0s()),2&i){const e=t.sdS(2);t.Y8G("template",e)}}function ct(i,a){if(1&i){const e=t.RV6();t.j41(0,"input-switch",30),t.bIt("change",function(){const o=t.eBV(e).row,n=t.XpG(2);return t.Njj(n.ativarDesativar(o))}),t.k0s()}if(2&i){const e=a.row;t.Y8G("size",12)("value",e.data_desativado?"false":"true")("valueOn","true")("valueOff","false")}}function mt(i,a){if(1&i&&(t.j41(0,"column",29),t.DNE(1,ct,1,4,"ng-template",null,4,t.C5r),t.k0s()),2&i){const e=t.sdS(2);t.Y8G("template",e)}}let pt=(()=>{class i extends U.P{constructor(e,s){super(e,C,f),this.injector=e,this.isUpdating=!1,this.isChefe=!1,this.isCurador=!1,this.isSearching=!1,this.filterWhere=o=>{let n=[],r=o.value;return r.nome?.length&&n.push(["nome","like","%"+r.nome.trim().replace(" ","%")+"%"]),r.id?.length&&n.push(["identificador","=",r.id]),r.unidade_id?.length&&n.push(["unidade_id","==",r.unidade_id]),r.cliente_id?.length&&n.push(["produtos_do_cliente","==",r.cliente_id]),r.status&&"ativo"==r.status&&n.push(["data_ativado","!=",null]),r.status&&"inativo"==r.status&&n.push(["data_ativado","==",null]),n},this.produtoService=e.get(J),this.title=this.lex.translate("Produtos"),this.filter=this.fh.FormBuilder({nome:{default:this.metadata?.nome??""},unidade_id:{default:""},cliente_id:{default:""},id:{default:""},status:{default:""}}),this.join=["produtoProcessoCadeiaValor"],this.isChefe=this.auth.isUsuarioDeveloper()||this.auth.isGestorAlgumaAreaTrabalho(!1),this.isCurador=this.auth.isUsuarioCurador(),this.BOTAO_EXCLUIR={label:"Excluir",icon:"bi bi-trash",onClick:this.delete.bind(this),color:"btn-outline-danger"}}ngOnInit(){super.ngOnInit(),this.isSearching="search"==this.queryParams.mode||"search-ativos"==this.queryParams.mode,this.isSearching&&(this.filter?.controls.status.setValue("ativo"),this.saveUsuarioConfig())}dynamicButtons(e){let s=[];return e._status||s.push({label:"Detalhes",icon:"bi bi-eye",color:"btn-outline-success",onClick:this.showDetalhes.bind(this)}),1!=e._metadata?.vinculoEntregas&&this.isChefe&&s.push(this.BOTAO_EXCLUIR),s}dynamicOptions(e){return[]}showDetalhes(e){var s=this;return(0,d.A)(function*(){s.go.navigate({route:["gestao","produto",e.id,"show"]},{metadata:{produto:e}})})()}ativarDesativar(e){var s=this;return(0,d.A)(function*(){if(s.isUpdating)return void console.log("Aguarde o t\xe9rmino do processo anterior");s.isUpdating=!0;let o=s.ativo(e);e.data_desativado=null,e.data_ativado=null,o?e.data_desativado=new Date:e.data_ativado=new Date;let n="";try{yield s.dao?.update(e.id,{id:e.id,data_desativado:e.data_desativado,data_ativado:e.data_ativado})}catch(r){if(r instanceof z.yz&&(n=r.error.message),r.validationErrors){let u=r.validationErrors;n="",Object.keys(u).forEach(h=>{u[h].forEach(p=>{n+=`${h}: ${p}\n`})})}n=n||"Erro inesperado",s.dialog.alert("Erro ao ativar/inativar o produto",n,"Fechar","fa fa-exclamation-triangle")}finally{s.isUpdating=!1}})()}onBuscaAvancada(){var s,e=this;this.go.navigate({route:["gestao","produto","filter"]},{metadata:{nome:this.filter?.controls.nome.value,id:this.filter?.controls.id.value,status:this.filter?.controls.status.value,unidade_id:this.filter?.controls.unidade_id.value,cliente_id:this.filter?.controls.cliente_id.value,enableStatus:"search-ativos"!=this.queryParams.mode},modalClose:(s=(0,d.A)(function*(o){o&&e.filter&&(e.filter?.controls.nome.setValue(o.nome),e.filter?.controls.id.setValue(o.id),e.filter?.controls.status.setValue(o.status),e.filter?.controls.unidade_id.setValue(o.unidade_id),e.filter?.controls.cliente_id.setValue(o.cliente_id),e.grid.reloadFilter())}),function(n){return s.apply(this,arguments)})})}onFilterClear(){this.filter?.reset(),this.grid.reloadFilter()}filtrosDefinidos(){return this.filter?.controls.nome.value.length>0||this.filter?.controls.id.value.length>0||this.filter?.controls.unidade_id.value.length>0||this.filter?.controls.cliente_id.value.length>0||this.filter?.controls.status.value.length>0}ativo(e){return!e.data_desativado}static{this.\u0275fac=function(s){return new(s||i)(t.rXU(t.zZn),t.rXU(f))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-produto-list"]],viewQuery:function(s,o){if(1&s&&t.GBs(c._,5),2&s){let n;t.mGM(n=t.lsd())&&(o.grid=n.first)}},features:[t.Vt3],decls:28,vars:31,consts:[["columnID",""],["columnNome",""],["columnSigla",""],["columnStatus",""],["columnAtivar",""],[3,"select","dao","add","title","orderBy","groupBy","join","selectable","hasAdd","hasEdit"],[4,"ngIf"],[3,"deleted","form","where","submit","collapseChange","collapsed"],[1,"row"],[1,"col-md-4"],["controlName","nome",3,"size","label","control","placeholder"],[1,"col-md-3","busca-avancada"],[1,"busca-avancada-link"],[3,"click"],[1,"busca-avancada-clear"],["class","busca-avancada-filtros-aplicados",4,"ngIf"],["title","ID",3,"template"],["title","Nome",3,"template"],["title","Sigla/Nome Fantasia",3,"template"],["title","Status",3,"template",4,"ngIf"],["title","Ativar/Desativar",3,"template",4,"ngIf"],["type","options",3,"onEdit","dynamicOptions","dynamicButtons"],[3,"rows"],[1,"busca-avancada-filtros-aplicados"],["title","Status",3,"template"],["color","success","label","Ativo",4,"ngIf"],["color","danger","label","Inativo",4,"ngIf"],["color","success","label","Ativo"],["color","danger","label","Inativo"],["title","Ativar/Desativar",3,"template"],["scale","small",3,"change","size","value","valueOn","valueOff"]],template:function(s,o){if(1&s){const n=t.RV6();t.j41(0,"grid",5),t.bIt("select",function(u){return t.eBV(n),t.Njj(o.onSelect(u))}),t.DNE(1,W,1,0,"toolbar",6),t.j41(2,"filter",7)(3,"div",8)(4,"div",9),t.nrm(5,"input-text",10),t.k0s(),t.j41(6,"div",11)(7,"div",12)(8,"a",13),t.bIt("click",function(){return t.eBV(n),t.Njj(o.onBuscaAvancada())}),t.EFF(9,"Busca Avan\xe7ada"),t.k0s()(),t.j41(10,"div",14)(11,"a",13),t.bIt("click",function(){return t.eBV(n),t.Njj(o.onFilterClear())}),t.EFF(12,"Limpar filtros de busca"),t.k0s()(),t.DNE(13,it,7,5,"div",15),t.k0s()()(),t.j41(14,"columns")(15,"column",16),t.DNE(16,st,3,1,"ng-template",null,0,t.C5r),t.k0s(),t.j41(18,"column",17),t.DNE(19,nt,3,1,"ng-template",null,1,t.C5r),t.k0s(),t.j41(21,"column",18),t.DNE(22,at,3,1,"ng-template",null,2,t.C5r),t.k0s(),t.DNE(24,ut,3,1,"column",19)(25,mt,3,1,"column",20),t.nrm(26,"column",21),t.k0s(),t.nrm(27,"pagination",22),t.k0s()}if(2&s){const n=t.sdS(17),r=t.sdS(20),u=t.sdS(23);t.Y8G("dao",o.dao)("add",o.add)("title",o.isModal?"":o.title)("orderBy",o.orderBy)("groupBy",o.groupBy)("join",o.join)("selectable",o.selectable)("hasAdd",o.isChefe)("hasEdit",o.isChefe),t.R7$(),t.Y8G("ngIf",!o.selectable),t.R7$(),t.Y8G("deleted",o.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",o.filter)("where",o.filterWhere)("submit",o.filterSubmit.bind(o))("collapseChange",o.filterCollapseChange.bind(o))("collapsed",!o.selectable&&o.filterCollapsed),t.R7$(3),t.Y8G("size",12)("label","Nome do "+o.lex.translate("produto"))("control",o.filter.controls.nome)("placeholder","Nome do "+o.lex.translate("produto")),t.BMQ("maxlength",250),t.R7$(8),t.Y8G("ngIf",o.filtrosDefinidos),t.R7$(2),t.Y8G("template",n),t.R7$(3),t.Y8G("template",r),t.R7$(3),t.Y8G("template",u),t.R7$(3),t.Y8G("ngIf",!o.isCurador&&!o.isSearching),t.R7$(),t.Y8G("ngIf",o.isCurador&&!o.isSearching),t.R7$(),t.Y8G("onEdit",o.edit)("dynamicOptions",o.dynamicOptions.bind(o))("dynamicButtons",o.dynamicButtons.bind(o)),t.R7$(),t.Y8G("rows",o.rowsLimit)}},dependencies:[v.bT,c._,y.T,F.I,Q.i,X.H,H.e,K.S,S.H,Z.n],styles:["filter[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{align-items:end}.busca-avancada[_ngcontent-%COMP%]   .busca-avancada-link[_ngcontent-%COMP%], .busca-avancada[_ngcontent-%COMP%]   .busca-avancada-clear[_ngcontent-%COMP%]{margin-bottom:6px}.busca-avancada[_ngcontent-%COMP%]   .busca-avancada-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .busca-avancada[_ngcontent-%COMP%]   .busca-avancada-clear[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-weight:700;text-decoration:none;cursor:pointer;color:#000}.busca-avancada[_ngcontent-%COMP%]   .busca-avancada-filtros-aplicados[_ngcontent-%COMP%]{margin-top:4px;font-size:12px}.busca-avancada[_ngcontent-%COMP%]   .busca-avancada-filtros-aplicados[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;background-color:#ccc;padding:1px 5px;margin-right:3px;border-radius:3px}"]})}}return i})();var E=l(1620),R=l(6819),m=l(1641),O=l(3535),A=l(5413),ft=l(24),_=l(9226),ht=l(158),G=l(3678),I=l(2075),$=l(6774),_t=l(8467),gt=l(242);let vt=(()=>{class i extends b.F{constructor(e){super("ProdutoProcesso",e),this.injector=e}static{this.\u0275fac=function(s){return new(s||i)(t.KVO(t.zZn))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();class V extends P.C{constructor(a){super(),this.cadeia_valor_processo_id="",this.produto_id="",this.initialization(a)}}var D=l(4795);const bt=["cadeiaValor"],Pt=["cadeiaProcesso"],Ct=()=>["unidade"],yt=i=>["unidade_id","==",i],Ft=i=>[i],Et=i=>({unidade_id:i}),Rt=i=>({filter:i});function Dt(i,a){1&i&&(t.j41(0,"div",12)(1,"span")(2,"strong"),t.EFF(3,"Cadeia de valor"),t.k0s()()())}function jt(i,a){if(1&i&&(t.j41(0,"div",13)(1,"p"),t.EFF(2),t.k0s()()),2&i){const e=a.row;t.R7$(2),t.JRh(null==e.cadeia_valor_processo||null==e.cadeia_valor_processo.cadeia_valor?null:e.cadeia_valor_processo.cadeia_valor.nome)}}function St(i,a){if(1&i){const e=t.RV6();t.j41(0,"input-search",14,7),t.bIt("change",function(o){t.eBV(e);const n=t.XpG();return t.Njj(n.onCadeiaChange(o))}),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("placeholder","Selecione a "+e.lex.translate("cadeia de valor"))("join",t.lJ4(5,Ct))("where",t.eq3(8,Ft,t.eq3(6,yt,null==e.auth.unidade?null:e.auth.unidade.id)))("selectParams",t.eq3(12,Rt,t.eq3(10,Et,null==e.auth.unidade?null:e.auth.unidade.id)))("dao",e.cadeiaValorDao)}}function Gt(i,a){1&i&&(t.j41(0,"div",12)(1,"span")(2,"strong"),t.EFF(3,"Processo"),t.k0s()()())}function Tt(i,a){if(1&i&&(t.j41(0,"div",13)(1,"p"),t.EFF(2),t.k0s()()),2&i){const e=a.row;t.R7$(2),t.JRh(null==e.cadeia_valor_processo?null:e.cadeia_valor_processo.nome)}}function kt(i,a){if(1&i&&t.nrm(0,"input-select",15,8),2&i){const e=t.XpG();t.Y8G("control",e.form.controls.cadeia_valor_processo_id)("items",e.processos)}}let Ot=(()=>{class i extends D.g{set control(e){super.control=e}get control(){return super.control}set entity(e){super.entity=e}get entity(){return super.entity}set disabled(e){this._disabled!=e&&(this._disabled=e)}get disabled(){return this._disabled}set noPersist(e){super.noPersist=e}get noPersist(){return super.noPersist}get items(){return this.gridControl.value||this.gridControl.setValue(new V),this.gridControl.value.produto_processo_cadeia_valor||(this.gridControl.value.produto_processo_cadeia_valor=[]),this.gridControl.value.produto_processo_cadeia_valor}constructor(e){super(e),this.injector=e,this.processos=[],this._disabled=!1,this.dao=e.get(vt),this.cdRef=e.get(t.gRc),this.cadeiaValorDao=e.get(_t.X),this.processosDao=e.get(gt.p),this.form=this.fh.FormBuilder({cadeia_valor_processo_id:{default:null},cadeia_valor_id:{default:null}},this.cdRef),this.join=["cadeiaValorProcesso.cadeiaValor"]}ngOnInit(){var e=()=>super.ngOnInit,s=this;return(0,d.A)(function*(){e().call(s),s.entity=s.metadata?.entity||s.entity})()}addProcesso(){var e=this;return(0,d.A)(function*(){return Object.assign(new V,{_status:"ADD",id:e.dao.generateUuid(),cadeia_valor_processo_id:""})})()}loadProcesso(e,s){return(0,d.A)(function*(){"ADD"!=s._status&&(e.controls.cadeia_valor_id.setValue(s.cadeia_valor_processo.cadeia_valor.id),e.controls.cadeia_valor_processo_id.setValue(s.cadeia_valor_processo.id))})()}removeProcesso(e){var s=this;return(0,d.A)(function*(){if(yield s.dialog.confirm("Exclui ?","Deseja realmente excluir?")){s.loading=!0;try{s.isNoPersist?Object.assign(e,{_status:"DELETE"}):yield s.dao?.delete(e.id)}finally{s.loading=!1}return!s.isNoPersist}return!1})()}saveProcesso(e,s){var o=this;return(0,d.A)(function*(){let n;return o.form.markAllAsTouched(),o.form.valid&&(s.id="NEW"==s.id?o.dao.generateUuid():s.id,s.cadeia_valor_processo=o.cadeiaProcesso.selectedItem?.data,s.cadeia_valor_processo.cadeia_valor=o.cadeiaValor.selectedEntity,s.cadeia_valor_processo_id=o.form.controls.cadeia_valor_processo_id.value,n=s,o.cdRef.detectChanges()),n})()}saveEndProcesso(e){}onCadeiaChange(e){var s=this;return(0,d.A)(function*(){s.cdRef.detectChanges(),s.loadProcessoCadeiaValor()})()}loadProcessoCadeiaValor(){try{let e=this.form.controls.cadeia_valor_id.value;this.processosDao?.query({where:[["cadeia_valor_id","=",e]]}).asPromise().then(s=>{this.processos=s.map(o=>({key:o.id,value:o.nome,data:o}))})}catch(e){console.error("Error loading processo cadeia valor:",e),this.processos=[]}}static{this.\u0275fac=function(s){return new(s||i)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["produto-list-processo"]],viewQuery:function(s,o){if(1&s&&(t.GBs(m.Q,5),t.GBs(c._,5),t.GBs(bt,5),t.GBs(Pt,5)),2&s){let n;t.mGM(n=t.lsd())&&(o.editableForm=n.first),t.mGM(n=t.lsd())&&(o.grid=n.first),t.mGM(n=t.lsd())&&(o.cadeiaValor=n.first),t.mGM(n=t.lsd())&&(o.cadeiaProcesso=n.first)}},inputs:{control:"control",entity:"entity",disabled:"disabled",noPersist:"noPersist",cdRef:"cdRef"},features:[t.Vt3],decls:18,vars:26,consts:[["gridProcessos",""],["titleCadeia",""],["columnCadeia",""],["editCadeia",""],["titleProcesso",""],["columnProcesso",""],["editProcesso",""],["cadeiaValor",""],["cadeiaProcesso",""],["noMargin","","editable","",3,"items","form","selectable","minHeight","join","groupBy","add","remove","save","load","saveEnd","hasDelete","hasEdit","hasAdd"],[3,"titleTemplate","template","editTemplate","verticalAlign","width","align"],["type","options"],[1,"text-center"],[1,"w-100","d-flex","justify-content-center"],["label","","controlName","cadeia_valor_id","required","",3,"change","placeholder","join","where","selectParams","dao"],["fullEntity","","controlName","cadeia_valor_processo_id","controlName","cadeia_valor_processo_id","required","",3,"control","items"]],template:function(s,o){if(1&s&&(t.j41(0,"grid",9,0)(2,"columns")(3,"column",10),t.DNE(4,Dt,4,0,"ng-template",null,1,t.C5r)(6,jt,3,1,"ng-template",null,2,t.C5r)(8,St,2,14,"ng-template",null,3,t.C5r),t.k0s(),t.j41(10,"column",10),t.DNE(11,Gt,4,0,"ng-template",null,4,t.C5r)(13,Tt,3,1,"ng-template",null,5,t.C5r)(15,kt,2,2,"ng-template",null,6,t.C5r),t.k0s(),t.nrm(17,"column",11),t.k0s()()),2&s){const n=t.sdS(5),r=t.sdS(7),u=t.sdS(9),h=t.sdS(12),g=t.sdS(14),p=t.sdS(16);t.Y8G("items",o.items)("form",o.form)("selectable",!1)("minHeight",o.items.length>2?0:300)("join",o.join)("groupBy",o.groupBy)("add",o.addProcesso.bind(o))("remove",o.removeProcesso.bind(o))("save",o.saveProcesso.bind(o))("load",o.loadProcesso.bind(o))("saveEnd",o.saveEndProcesso.bind(o))("hasDelete",!0)("hasEdit",!0)("hasAdd",!0),t.R7$(3),t.Y8G("titleTemplate",n)("template",r)("editTemplate",u)("verticalAlign","middle")("width",300)("align","center"),t.R7$(7),t.Y8G("titleTemplate",h)("template",g)("editTemplate",p)("verticalAlign","middle")("width",300)("align","center")}},dependencies:[c._,y.T,F.I,_.O,G.K]})}}return i})(),At=(()=>{class i extends b.F{constructor(e){super("ProdutoProduto",e),this.injector=e}static{this.\u0275fac=function(s){return new(s||i)(t.KVO(t.zZn))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var It=l(5492);class N extends P.C{constructor(a){super(),this.produto_base_id="",this.produto_id="",this.tipo="",this.initialization(a)}}const $t=["produtoRelacionado"],Vt=i=>["id","!=",i],Nt=i=>[i];function Bt(i,a){1&i&&(t.j41(0,"div",9)(1,"span")(2,"strong"),t.EFF(3,"Produto/Servi\xe7o"),t.k0s()()())}function Lt(i,a){if(1&i&&(t.j41(0,"div",10)(1,"p"),t.EFF(2),t.k0s()()),2&i){const e=a.row;t.R7$(2),t.JRh(null==e.produto_relacionado?null:e.produto_relacionado.nome)}}function Yt(i,a){if(1&i&&t.nrm(0,"input-search",11,4),2&i){const e=t.XpG();t.Y8G("control",e.form.controls.produto_id)("dao",e.produtoDao)("where",t.eq3(5,Nt,t.eq3(3,Vt,null==e.entity?null:e.entity.id)))}}let Mt=(()=>{class i extends D.g{set control(e){super.control=e}get control(){return super.control}set entity(e){super.entity=e}get entity(){return super.entity}set disabled(e){this._disabled!=e&&(this._disabled=e)}get disabled(){return this._disabled}set noPersist(e){super.noPersist=e}get noPersist(){return super.noPersist}get items(){return this.gridControl.value||this.gridControl.setValue(new N),this.gridControl.value.produto_produto||(this.gridControl.value.produto_produto=[]),this.gridControl.value.produto_produto}constructor(e){super(e),this.injector=e,this._disabled=!1,this.clientes=[],this.dao=e.get(At),this.produtoDao=e.get(f),this.tipoClienteDao=e.get(It.E),this.cdRef=e.get(t.gRc),this.form=this.fh.FormBuilder({tipo_cliente_id:{default:null},cliente_id:{default:null},produto_id:{default:null},tipo:{default:""}},this.cdRef),this.join=["produtoProduto.produtoRelacionado"]}addProduto(){var e=this;return(0,d.A)(function*(){return Object.assign(new N,{_status:"ADD",id:e.dao.generateUuid(),produto_id:""})})()}loadProduto(e,s){return(0,d.A)(function*(){"ADD"!=s._status&&(e.controls.produto_id.setValue(s.produto_id),e.controls.tipo.setValue(s.tipo))})()}removeProduto(e){var s=this;return(0,d.A)(function*(){if(yield s.dialog.confirm("Exclui ?","Deseja realmente excluir?")){s.loading=!0;try{s.isNoPersist?Object.assign(e,{_status:"DELETE"}):yield s.dao?.delete(e.id)}finally{s.loading=!1}return!s.isNoPersist}return!1})()}saveProduto(e,s){var o=this;return(0,d.A)(function*(){let n;return o.form.markAllAsTouched(),o.form.valid&&(s.id="NEW"==s.id?o.dao.generateUuid():s.id,s.produto_id=o.form.controls.produto_id.value,s.tipo=o.form.controls.tipo.value,s.produto_relacionado=o.produtoRelacionado?.selectedEntity,n=s,o.cdRef.detectChanges()),n})()}alteraTipoCliente(e){var s=this;return(0,d.A)(function*(){let o=s.form.controls.tipo_cliente_id.value;const n=(yield s.clienteDao?.query({where:[["tipo_cliente_id","=",o]]}).asPromise())||[];s.clientes=n.map(r=>({value:r.id,key:r.nome}))})()}static{this.\u0275fac=function(s){return new(s||i)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["produto-list-produto"]],viewQuery:function(s,o){if(1&s&&(t.GBs(m.Q,5),t.GBs(c._,5),t.GBs($t,5)),2&s){let n;t.mGM(n=t.lsd())&&(o.editableForm=n.first),t.mGM(n=t.lsd())&&(o.grid=n.first),t.mGM(n=t.lsd())&&(o.produtoRelacionado=n.first)}},inputs:{control:"control",entity:"entity",disabled:"disabled",noPersist:"noPersist",cdRef:"cdRef"},features:[t.Vt3],decls:13,vars:19,consts:[["gridProdutos",""],["titleProduto",""],["columnProduto",""],["editProduto",""],["produtoRelacionado",""],["role","alert",1,"alert","alert-info"],["noMargin","","editable","",3,"items","form","selectable","minHeight","join","groupBy","add","remove","save","load","hasDelete","hasEdit","hasAdd"],[3,"titleTemplate","template","editTemplate","verticalAlign","width","align"],["type","options"],[1,"text-center"],[1,"w-100","d-flex","justify-content-center"],["fullEntity","","controlName","produto_id","required","",3,"control","dao","where"]],template:function(s,o){if(1&s&&(t.j41(0,"div",5),t.EFF(1," Outros produtos ou servi\xe7os que complementam ou s\xe3o necess\xe1rios para a execu\xe7\xe3o deste produto ou servi\xe7o.\n"),t.k0s(),t.j41(2,"grid",6,0)(4,"columns")(5,"column",7),t.DNE(6,Bt,4,0,"ng-template",null,1,t.C5r)(8,Lt,3,1,"ng-template",null,2,t.C5r)(10,Yt,2,7,"ng-template",null,3,t.C5r),t.k0s(),t.nrm(12,"column",8),t.k0s()()),2&s){const n=t.sdS(7),r=t.sdS(9),u=t.sdS(11);t.R7$(2),t.Y8G("items",o.items)("form",o.form)("selectable",!1)("minHeight",o.items.length>2?0:300)("join",o.join)("groupBy",o.groupBy)("add",o.addProduto.bind(o))("remove",o.removeProduto.bind(o))("save",o.saveProduto.bind(o))("load",o.loadProduto.bind(o))("hasDelete",!0)("hasEdit",!0)("hasAdd",!0),t.R7$(3),t.Y8G("titleTemplate",n)("template",r)("editTemplate",u)("verticalAlign","middle")("width",300)("align","center")}},dependencies:[c._,y.T,F.I,_.O]})}}return i})();var B=l(5099);let wt=(()=>{class i extends b.F{constructor(e){super("ProdutoCliente",e),this.injector=e}static{this.\u0275fac=function(s){return new(s||i)(t.KVO(t.zZn))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();class L extends P.C{constructor(a){super(),this.produto_id="",this.cliente_id="",this.initialization(a)}}const zt=["cliente"],Ut=()=>["tipoCliente"],Jt=()=>["cadastros","cliente"],Qt=i=>({route:i});function Xt(i,a){1&i&&(t.j41(0,"div",8)(1,"span")(2,"strong"),t.EFF(3,"Cliente"),t.k0s()()())}function Ht(i,a){if(1&i&&(t.j41(0,"div",9)(1,"small"),t.EFF(2),t.k0s(),t.nrm(3,"br"),t.j41(4,"b",10),t.EFF(5),t.k0s()()),2&i){const e=a.row;t.R7$(2),t.JRh(null==e.cliente.tipo_cliente?null:e.cliente.tipo_cliente.nome),t.R7$(3),t.JRh(e.cliente.nome)}}function Kt(i,a){if(1&i&&t.nrm(0,"input-search",11,4),2&i){const e=t.XpG();t.Y8G("placeholder","Selecione o cliente")("join",t.lJ4(4,Ut))("dao",e.clienteDao)("selectRoute",t.eq3(6,Qt,t.lJ4(5,Jt)))}}let Zt=(()=>{class i extends D.g{set control(e){super.control=e}get control(){return super.control}set entity(e){super.entity=e}get entity(){return super.entity}set disabled(e){this._disabled!=e&&(this._disabled=e)}get disabled(){return this._disabled}set noPersist(e){super.noPersist=e}get noPersist(){return super.noPersist}get items(){return this.gridControl.value||this.gridControl.setValue(new L),this.gridControl.value.produto_cliente||(this.gridControl.value.produto_cliente=[]),this.gridControl.value.produto_cliente}constructor(e){super(e),this.injector=e,this._disabled=!1,this.dao=e.get(wt),this.produtoDao=e.get(f),this.clienteDao=e.get(B.K),this.cdRef=e.get(t.gRc),this.form=this.fh.FormBuilder({cliente_id:{default:""}},this.cdRef),this.join=["produtoCliente.cliente.tipoCliente"]}addCliente(){var e=this;return(0,d.A)(function*(){return Object.assign(new L,{_status:"ADD",id:e.dao.generateUuid(),cliente_id:""})})()}loadCliente(e,s){return(0,d.A)(function*(){"ADD"!=s._status&&e.controls.cliente_id.setValue(s.cliente_id)})()}removeCliente(e){var s=this;return(0,d.A)(function*(){if(yield s.dialog.confirm("Exclui ?","Deseja realmente excluir?")){s.loading=!0;try{s.isNoPersist?Object.assign(e,{_status:"DELETE"}):yield s.dao?.delete(e.id)}finally{s.loading=!1}return!s.isNoPersist}return!1})()}saveCliente(e,s){var o=this;return(0,d.A)(function*(){let n;return o.form.markAllAsTouched(),o.form.valid&&(s.id="NEW"==s.id?o.dao.generateUuid():s.id,s.cliente_id=o.form.controls.cliente_id.value,s.cliente=o.cliente.selectedEntity,n=s,o.cdRef.detectChanges()),n})()}static{this.\u0275fac=function(s){return new(s||i)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["produto-list-cliente"]],viewQuery:function(s,o){if(1&s&&(t.GBs(m.Q,5),t.GBs(c._,5),t.GBs(zt,5)),2&s){let n;t.mGM(n=t.lsd())&&(o.editableForm=n.first),t.mGM(n=t.lsd())&&(o.grid=n.first),t.mGM(n=t.lsd())&&(o.cliente=n.first)}},inputs:{control:"control",entity:"entity",disabled:"disabled",noPersist:"noPersist",cdRef:"cdRef"},features:[t.Vt3],decls:11,vars:19,consts:[["gridClientes",""],["titleCliente",""],["columnCliente",""],["editCliente",""],["cliente",""],["noMargin","","editable","",3,"items","form","selectable","minHeight","join","groupBy","add","remove","save","load","hasDelete","hasEdit","hasAdd"],[3,"titleTemplate","template","editTemplate","verticalAlign","width","align"],["type","options"],[1,"text-left"],[1,"w-100"],[1,""],["label","","controlName","cliente_id","required","",3,"placeholder","join","dao","selectRoute"]],template:function(s,o){if(1&s&&(t.j41(0,"grid",5,0)(2,"columns")(3,"column",6),t.DNE(4,Xt,4,0,"ng-template",null,1,t.C5r)(6,Ht,6,2,"ng-template",null,2,t.C5r)(8,Kt,2,8,"ng-template",null,3,t.C5r),t.k0s(),t.nrm(10,"column",7),t.k0s()()),2&s){const n=t.sdS(5),r=t.sdS(7),u=t.sdS(9);t.Y8G("items",o.items)("form",o.form)("selectable",!1)("minHeight",o.items.length>2?0:300)("join",o.join)("groupBy",o.groupBy)("add",o.addCliente.bind(o))("remove",o.removeCliente.bind(o))("save",o.saveCliente.bind(o))("load",o.loadCliente.bind(o))("hasDelete",!0)("hasEdit",!0)("hasAdd",!0),t.R7$(3),t.Y8G("titleTemplate",n)("template",r)("editTemplate",u)("verticalAlign","middle")("width",300)("align","left")}},dependencies:[c._,y.T,F.I,_.O]})}}return i})(),Wt=(()=>{class i extends b.F{constructor(e){super("ProdutoSolucao",e),this.injector=e}static{this.\u0275fac=function(s){return new(s||i)(t.KVO(t.zZn))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var qt=l(9175);class Y extends P.C{constructor(a){super(),this.produto_id="",this.solucao_id="",this.initialization(a)}}const xt=["solucao"],te=()=>["gestao","solucao"],ee=()=>({mode:"search"}),oe=(i,a)=>({route:i,params:a});function ie(i,a){1&i&&(t.j41(0,"div",8)(1,"span")(2,"strong"),t.EFF(3,"Solu\xe7\xe3o"),t.k0s()()())}function se(i,a){if(1&i&&(t.j41(0,"div",9)(1,"p"),t.EFF(2),t.k0s()()),2&i){const e=a.row;t.R7$(2),t.JRh(e.solucao.nome)}}function ne(i,a){if(1&i&&t.nrm(0,"input-search",10,4),2&i){const e=t.XpG();t.Y8G("placeholder","Selecione a solu\xe7\xe3o")("dao",e.solucaoDao)("selectRoute",t.l_i(5,oe,t.lJ4(3,te),t.lJ4(4,ee)))}}let ae=(()=>{class i extends D.g{set control(e){super.control=e}get control(){return super.control}set entity(e){super.entity=e}get entity(){return super.entity}set disabled(e){this._disabled!=e&&(this._disabled=e)}get disabled(){return this._disabled}set noPersist(e){super.noPersist=e}get noPersist(){return super.noPersist}get items(){return this.gridControl.value||this.gridControl.setValue(new Y),this.gridControl.value.produto_solucoes||(this.gridControl.value.produto_solucoes=[]),this.gridControl.value.produto_solucoes}constructor(e){var s;super(e),s=this,this.injector=e,this._disabled=!1,this.asyncValidate=function(){var o=(0,d.A)(function*(n,r){let u=null;if(["solucao_id"].indexOf(r)>=0)if(n.value?.length)if(s.items.some(g=>g.solucao_id===n.value))u="Solu\xe7\xe3o j\xe1 inserida neste Produto";else try{yield s.solucaoDao?.getById(n.value);const p=yield s.solucaoUnidadeDao?.getOne(n.value,s.entity?.unidade?.id).asPromise();console.log(p),(!p||!p[0]||!p[0].status)&&(u="Solu\xe7\xe3o inativa n\xe3o pode ser usada")}catch{u="Erro ao verificar a Solu\xe7\xe3o"}else u="Obrigat\xf3rio";return u});return function(n,r){return o.apply(this,arguments)}}(),this.dao=e.get(Wt),this.produtoDao=e.get(f),this.solucaoDao=e.get(qt.Y),this.cdRef=e.get(t.gRc),this.form=this.fh.FormBuilder({solucao_id:{default:"",async:!0}},this.cdRef,void 0,this.asyncValidate),this.join=["produtoSolucao.solucao"]}addSolucao(){var e=this;return(0,d.A)(function*(){return Object.assign(new Y,{_status:"ADD",id:e.dao.generateUuid(),solucao_id:""})})()}loadSolucao(e,s){return(0,d.A)(function*(){"ADD"!=s._status&&e.controls.solucao_id.setValue(s.solucao_id)})()}removeSolucao(e){var s=this;return(0,d.A)(function*(){if(yield s.dialog.confirm("Excluir?","Deseja realmente excluir a Solu\xe7\xe3o?")){s.loading=!0;try{s.isNoPersist?Object.assign(e,{_status:"DELETE"}):yield s.dao?.delete(e.id)}finally{s.loading=!1}return!s.isNoPersist}return!1})()}saveSolucao(e,s){var o=this;return(0,d.A)(function*(){let n;return o.form.markAllAsTouched(),o.form.valid&&(s.id="NEW"==s.id?o.dao.generateUuid():s.id,s.solucao_id=o.form.controls.solucao_id.value,s.solucao=o.solucao.selectedEntity,n=s,o.cdRef.detectChanges()),n})()}static{this.\u0275fac=function(s){return new(s||i)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["produto-list-solucao"]],viewQuery:function(s,o){if(1&s&&(t.GBs(m.Q,5),t.GBs(c._,5),t.GBs(xt,5)),2&s){let n;t.mGM(n=t.lsd())&&(o.editableForm=n.first),t.mGM(n=t.lsd())&&(o.grid=n.first),t.mGM(n=t.lsd())&&(o.solucao=n.first)}},inputs:{control:"control",entity:"entity",disabled:"disabled",noPersist:"noPersist",cdRef:"cdRef"},features:[t.Vt3],decls:11,vars:19,consts:[["gridSolucoes",""],["titleSolucao",""],["columnSolucao",""],["editSolucao",""],["solucao",""],["noMargin","","editable","",3,"items","form","selectable","minHeight","join","groupBy","add","remove","save","load","hasDelete","hasEdit","hasAdd"],[3,"titleTemplate","template","editTemplate","verticalAlign","width","align"],["type","options"],[1,"text-center"],[1,"w-100","d-flex","justify-content-center"],["label","","required","","controlName","solucao_id",3,"placeholder","dao","selectRoute"]],template:function(s,o){if(1&s&&(t.j41(0,"grid",5,0)(2,"columns")(3,"column",6),t.DNE(4,ie,4,0,"ng-template",null,1,t.C5r)(6,se,3,1,"ng-template",null,2,t.C5r)(8,ne,2,8,"ng-template",null,3,t.C5r),t.k0s(),t.nrm(10,"column",7),t.k0s()()),2&s){const n=t.sdS(5),r=t.sdS(7),u=t.sdS(9);t.Y8G("items",o.items)("form",o.form)("selectable",!1)("minHeight",o.items.length>2?0:300)("join",o.join)("groupBy",o.groupBy)("add",o.addSolucao.bind(o))("remove",o.removeSolucao.bind(o))("save",o.saveSolucao.bind(o))("load",o.loadSolucao.bind(o))("hasDelete",!0)("hasEdit",!0)("hasAdd",!0),t.R7$(3),t.Y8G("titleTemplate",n)("template",r)("editTemplate",u)("verticalAlign","middle")("width",300)("align","center")}},dependencies:[c._,y.T,F.I,_.O]})}}return i})();const re=["unidade"],le=["usuario"],de=()=>["configuracoes","usuario"],ue=()=>["CURADOR"],ce=i=>({atribuicoes:i}),me=i=>({filter:i}),pe=(i,a)=>({route:i,params:a});let M=(()=>{class i extends ft.n{constructor(e){super(e,C,f),this.injector=e,this.campoDesabilitado=!1,this.unidadeDao=e.get(O.s),this.usuarioDao=e.get(A._),this.join=["produtoProcessoCadeiaValor.cadeiaValorProcesso.cadeiaValor","produtoProduto.produtoRelacionado","produtoCliente.cliente.tipoCliente:nome","produtoSolucoes.solucao"],this.form=this.fh.FormBuilder({responsavel_id:{default:""},nome:{default:""},nome_fantasia:{default:""},descricao:{default:""},url:{default:""},tipo:{default:""},unidade_id:{default:""},produto_processo_cadeia_valor:{default:[]},produto_produto:{default:[]},produto_cliente:{default:[]},produto_solucoes:{default:[]},solucao:{default:[]}})}loadData(e,s){var o=this;return(0,d.A)(function*(){let n=Object.assign({},s.value);e.unidade_id=e.unidade?.id||o.auth.unidade.id,e.responsavel_id=e.responsavel?.id||o.auth.usuario.id,o.campoDesabilitado=1==e._metadata?.vinculoEntregas,s.patchValue(o.util.fillForm(n,e))})()}initializeData(e){var s=this;return(0,d.A)(function*(){e.patchValue(new C),s.entity=new C,yield s.loadData(s.entity,s.form)})()}saveData(e){return new Promise((s,o)=>{const n=this.util.fill(new C,this.entity);s(this.util.fillForm(n,this.form.value))})}static{this.\u0275fac=function(s){return new(s||i)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-produto-form"]],viewQuery:function(s,o){if(1&s&&(t.GBs(m.Q,5),t.GBs(re,5),t.GBs(le,5)),2&s){let n;t.mGM(n=t.lsd())&&(o.editableForm=n.first),t.mGM(n=t.lsd())&&(o.unidade=n.first),t.mGM(n=t.lsd())&&(o.usuario=n.first)}},features:[t.Vt3],decls:28,vars:44,consts:[["usuario",""],["unidade",""],["clientes",""],["solucoes",""],["processos",""],["produtos",""],["initialFocus","nome",3,"submit","cancel","form","disabled","title"],[1,"row"],["label","Nome do produto","icon","bi bi-textarea-t","controlName","nome","required","","labelInfo","Nome formal do produto ou servi\xe7o. Ex: Programa de Gest\xe3o e Desempenho",3,"size","disabled","control"],["label","Sigla/Nome fantasia","icon","bi bi-textarea-t","controlName","nome_fantasia","labelInfo","Nome informal do produto ou servi\xe7o. Ex: PGD",3,"size","disabled","control"],["required","","controlName","responsavel_id","rou","","label","Curador",3,"size","disabled","dao","selectRoute"],["label","Tipo","icon","bi bi-arrow-up-right-circle","controlName","tipo","required","",3,"size","disabled","items"],["label","URL","icon","bi bi-textarea-t","controlName","url","labelInfo","P\xe1gina oficial do produto ou servi\xe7o",3,"size","control"],["label","Descri\xe7\xe3o","required","",3,"control"],["controlName","unidade_id","required","",3,"size","control","disabled","dao"],[1,"row","abas"],["key","CLIENTES","label","Clientes"],["noPersist","",3,"disabled","entity"],["key","SOLUCOES","label","Solu\xe7\xf5es"],["key","PROCESSOS","label","Processos (cadeia de valor)"],["key","INSUMOS","label","Produtos relacionados"]],template:function(s,o){if(1&s){const n=t.RV6();t.j41(0,"editable-form",6),t.bIt("submit",function(){return t.eBV(n),t.Njj(o.onSaveData())})("cancel",function(){return t.eBV(n),t.Njj(o.onCancel())}),t.j41(1,"div",7)(2,"div",7),t.nrm(3,"input-text",8)(4,"input-text",9)(5,"input-search",10,0),t.k0s(),t.j41(7,"div",7),t.nrm(8,"input-select",11)(9,"input-text",12),t.k0s(),t.j41(10,"div",7),t.nrm(11,"input-textarea",13)(12,"input-search",14,1),t.k0s(),t.j41(14,"div",15)(15,"tabs")(16,"tab",16),t.nrm(17,"produto-list-cliente",17,2),t.k0s(),t.j41(19,"tab",18),t.nrm(20,"produto-list-solucao",17,3),t.k0s(),t.j41(22,"tab",19),t.nrm(23,"produto-list-processo",17,4),t.k0s(),t.j41(25,"tab",20),t.nrm(26,"produto-list-produto",17,5),t.k0s()()()()()}2&s&&(t.Y8G("form",o.form)("disabled",o.formDisabled)("title",o.isModal?"":o.title),t.R7$(3),t.Y8G("size",6)("disabled",o.campoDesabilitado?"true":void 0)("control",o.form.controls.nome),t.BMQ("maxlength",250),t.R7$(),t.Y8G("size",3)("disabled",o.campoDesabilitado?"true":void 0)("control",o.form.controls.nome_fantasia),t.BMQ("maxlength",250),t.R7$(),t.Y8G("size",3)("disabled",o.campoDesabilitado?"true":void 0)("dao",o.usuarioDao)("selectRoute",t.l_i(41,pe,t.lJ4(35,de),t.eq3(39,me,t.eq3(37,ce,t.lJ4(36,ue))))),t.R7$(3),t.Y8G("size",4)("disabled",o.campoDesabilitado?"true":void 0)("items",o.lookup.TIPO_PRODUTO),t.R7$(),t.Y8G("size",8)("control",o.form.controls.url),t.BMQ("maxlength",250),t.R7$(2),t.Y8G("control",o.form.controls.descricao),t.BMQ("maxlength",250),t.R7$(),t.Y8G("size",4)("control",o.form.controls.unidade_id)("disabled",o.campoDesabilitado?"true":void 0)("dao",o.unidadeDao),t.R7$(5),t.Y8G("disabled",o.formDisabled)("entity",o.entity),t.R7$(3),t.Y8G("disabled",o.formDisabled)("entity",o.entity),t.R7$(3),t.Y8G("disabled",o.formDisabled)("entity",o.entity),t.R7$(3),t.Y8G("disabled",o.formDisabled)("entity",o.entity))},dependencies:[m.Q,_.O,S.H,ht.S,G.K,I.O,$.j,Ot,Mt,Zt,ae],styles:[".abas[_ngcontent-%COMP%]{margin-top:15px}"]})}}return i})();var fe=l(4468);function he(i,a){1&i&&(t.j41(0,"div",2),t.nrm(1,"span",3),t.k0s())}function _e(i,a){if(1&i&&(t.j41(0,"div",7)(1,"small",8),t.EFF(2,"Ativado em"),t.k0s(),t.j41(3,"b"),t.EFF(4),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(4),t.JRh(e.formatDate(e.produto.data_ativado))}}function ge(i,a){if(1&i&&(t.j41(0,"div",7)(1,"small",8),t.EFF(2,"Desativado em"),t.k0s(),t.j41(3,"b"),t.EFF(4),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(4),t.JRh(e.formatDate(e.produto.data_desativado))}}function ve(i,a){if(1&i&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s()()),2&i){const e=a.$implicit;t.R7$(2),t.JRh(null==e.cliente||null==e.cliente.tipo_cliente?null:e.cliente.tipo_cliente.nome),t.R7$(2),t.JRh(null==e.cliente?null:e.cliente.nome)}}function be(i,a){if(1&i&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s()()),2&i){const e=a.$implicit;t.R7$(2),t.JRh(null==e.solucao?null:e.solucao.nome),t.R7$(2),t.JRh(null==e.solucao?null:e.solucao.sigla),t.R7$(2),t.JRh(null==e.solucao?null:e.solucao.descricao)}}function Pe(i,a){if(1&i&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s()()),2&i){const e=a.$implicit;t.R7$(2),t.JRh(null==e.cadeia_valor_processo||null==e.cadeia_valor_processo.cadeia_valor?null:e.cadeia_valor_processo.cadeia_valor.nome),t.R7$(2),t.JRh(null==e.cadeia_valor_processo?null:e.cadeia_valor_processo.nome)}}function Ce(i,a){if(1&i&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s()()),2&i){const e=a.$implicit,s=t.XpG(2);t.R7$(2),t.JRh(null==e.produto_relacionado?null:e.produto_relacionado.nome),t.R7$(2),t.JRh(s.lookup.getValue(s.lookup.TIPO_PRODUTO,null==e.produto_relacionado?null:e.produto_relacionado.tipo)),t.R7$(2),t.JRh(null==e.produto_relacionado||null==e.produto_relacionado.unidade?null:e.produto_relacionado.unidade.nome),t.R7$(2),t.JRh(null==e.produto_relacionado?null:e.produto_relacionado.descricao)}}function ye(i,a){if(1&i&&(t.qex(0),t.j41(1,"div",4)(2,"div")(3,"h4"),t.EFF(4),t.j41(5,"b"),t.EFF(6),t.k0s(),t.EFF(7),t.k0s()()(),t.j41(8,"div",5)(9,"div",6)(10,"div",7)(11,"small",8),t.EFF(12,"Descri\xe7\xe3o"),t.k0s(),t.j41(13,"b"),t.EFF(14),t.k0s()(),t.j41(15,"div",7)(16,"small",8),t.EFF(17,"Unidade"),t.k0s(),t.j41(18,"b"),t.EFF(19),t.k0s()(),t.DNE(20,_e,5,1,"div",9)(21,ge,5,1,"div",9),t.k0s()(),t.j41(22,"div",10)(23,"span",11),t.EFF(24,"Respons\xe1vel:"),t.k0s(),t.j41(25,"strong"),t.EFF(26),t.k0s()(),t.j41(27,"tabs")(28,"tab",12)(29,"table",13)(30,"thead")(31,"tr")(32,"th",14),t.EFF(33,"Tipo de cliente"),t.k0s(),t.j41(34,"th",14),t.EFF(35,"Cliente"),t.k0s()()(),t.j41(36,"tbody"),t.DNE(37,ve,5,2,"tr",15),t.k0s()()(),t.j41(38,"tab",16)(39,"table",13)(40,"thead")(41,"tr")(42,"th",14),t.EFF(43,"Nome"),t.k0s(),t.j41(44,"th",14),t.EFF(45,"Sigla/Nome Fantasia"),t.k0s(),t.j41(46,"th",14),t.EFF(47,"Descri\xe7\xe3o"),t.k0s()()(),t.j41(48,"tbody"),t.DNE(49,be,7,3,"tr",15),t.k0s()()(),t.j41(50,"tab",17)(51,"table",13)(52,"thead")(53,"tr")(54,"th",14),t.EFF(55,"Cadeia de valor"),t.k0s(),t.j41(56,"th",14),t.EFF(57,"Processo"),t.k0s()()(),t.j41(58,"tbody"),t.DNE(59,Pe,5,2,"tr",15),t.k0s()()(),t.j41(60,"tab",18)(61,"table",13)(62,"thead")(63,"tr")(64,"th",14),t.EFF(65,"Nome"),t.k0s(),t.j41(66,"th",14),t.EFF(67,"Tipo"),t.k0s(),t.j41(68,"th",14),t.EFF(69,"Unidade"),t.k0s(),t.j41(70,"th",14),t.EFF(71,"Descri\xe7\xe3o"),t.k0s()()(),t.j41(72,"tbody"),t.DNE(73,Ce,9,4,"tr",15),t.k0s()()()(),t.bVm()),2&i){const e=t.XpG();t.R7$(4),t.SpI("ID #",e.produto.identificador," - "),t.R7$(2),t.JRh(e.produto.nome),t.R7$(),t.SpI(" - ",e.produto.nome_fantasia,""),t.R7$(7),t.JRh(e.produto.descricao),t.R7$(5),t.JRh(null==e.produto.unidade?null:e.produto.unidade.nome),t.R7$(),t.Y8G("ngIf",e.produto.data_ativado),t.R7$(),t.Y8G("ngIf",!e.produto.data_ativado),t.R7$(5),t.JRh(null==e.produto.responsavel?null:e.produto.responsavel.nome),t.R7$(11),t.Y8G("ngForOf",e.produto.produto_cliente),t.R7$(12),t.Y8G("ngForOf",e.produto.produto_solucoes),t.R7$(10),t.Y8G("ngForOf",e.produto.produto_processo_cadeia_valor),t.R7$(14),t.Y8G("ngForOf",e.produto.produto_produto)}}let Fe=(()=>{class i extends fe.V{constructor(e){super(e),this.injector=e,this.produtoDaoService=e.get(f),this.loading=!0}ngOnInit(){super.ngOnInit(),this.carregaProdutoDetalhado()}carregaProdutoDetalhado(){var e=this;return(0,d.A)(function*(){e.produto=yield e.produtoDaoService.getById(e.metadata.produto.id,["produtoProcessoCadeiaValor.cadeiaValorProcesso.cadeiaValor.unidade","produtoProduto.produtoRelacionado.unidade","responsavel","unidade","produtoCliente.cliente.tipoCliente","produtoSolucoes.solucao"]),e.loading=!1})()}formatDate(e){return null==e?"":`${e.getDate().toString().padStart(2,"0")}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getFullYear()} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}`}static{this.\u0275fac=function(s){return new(s||i)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["produto-show"]],features:[t.Vt3],decls:2,vars:2,consts:[["class","spinner-border","role","status",4,"ngIf"],[4,"ngIf"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"bg-dark-subtle","d-flex","p-2","px-4"],[1,"bg-body-secondary","p-3","mb-4"],[1,"row"],[1,"col-md-3"],[1,"d-block","text-muted"],["class","col-md-3",4,"ngIf"],[1,"mb-4"],[1,"fw-bold"],["key","CLIENTES","label","Clientes"],[1,"table"],["scope","col"],[4,"ngFor","ngForOf"],["key","SOLUCAO","label","Solu\xe7\xf5es"],["key","PROCESSOS","label","Processos (cadeias de valor)"],["key","PRODUTOS","label","Produtos relacionados"]],template:function(s,o){1&s&&t.DNE(0,he,2,0,"div",0)(1,ye,74,12,"ng-container",1),2&s&&(t.Y8G("ngIf",o.loading),t.R7$(),t.Y8G("ngIf",o.produto))},dependencies:[v.Sq,v.bT,I.O,$.j],styles:["th[_ngcontent-%COMP%]{font-weight:700}"]})}}return i})();var Ee=l(568);function Re(i,a){if(1&i&&t.nrm(0,"input-select",10),2&i){const e=t.XpG();t.Y8G("size",12)("items",e.lookup.TIPO_ATIVO_INATIVO)("control",e.form.controls.status)}}let De=(()=>{class i extends D.g{constructor(e){super(e),this.injector=e,this.enableStatus=!0,this.lookup=e.get(Ee.s),this.usuarioDao=e.get(A._),this.unidadeDao=e.get(O.s),this.clienteDao=e.get(B.K),this.modalWidth=500,this.form=this.fh.FormBuilder({id:{default:""},nome:{default:""},status:{default:""},unidade_id:{default:""},cliente_id:{default:""}},this.cdRef)}ngOnInit(){super.ngOnInit(),this.snapshot=this.snapshot||this.modalRoute||this.route.snapshot,this.urlParams=this.snapshot.paramMap,this.queryParams=this.go.decodeParam(this.snapshot.queryParams),this.metadata=this.go.getMetadata(this.snapshot.queryParams.idroute),this.form?.controls.nome.setValue(this.metadata.nome),this.form?.controls.id.setValue(this.metadata.id),this.form?.controls.status.setValue(this.metadata.status),this.form?.controls.unidade_id.setValue(this.metadata.unidade_id),this.form?.controls.cliente_id.setValue(this.metadata.cliente_id),this.enableStatus=null==this.metadata.enableStatus||this.metadata.enableStatus}onSubmitClick(){var e=this;return(0,d.A)(function*(){e.loading=!0;try{let s={nome:e.form?.controls.nome.value,id:e.form?.controls.id.value,unidade_id:e.form?.controls.unidade_id.value,cliente_id:e.form?.controls.cliente_id.value,status:e.form?.controls.status.value};e.go.setModalResult(e.modalRoute?.queryParams?.idroute,s),e.close()}catch(s){e.error(s?.message||s?.error||s||"Erro desconhecido")}finally{e.loading=!1}})()}static{this.\u0275fac=function(s){return new(s||i)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["produto-filter"]],viewQuery:function(s,o){if(1&s&&t.GBs(m.Q,5),2&s){let n;t.mGM(n=t.lsd())&&(o.editableForm=n.first)}},features:[t.Vt3],decls:10,vars:14,consts:[["unidade",""],["cliente",""],["confirmLabel","Buscar",3,"submit","cancel","form"],[1,"row"],[1,"col-md-12"],["label","Nome","icon","bi bi-textarea-t","controlName","this.form.nome",3,"size","control"],["label","ID#","icon","bi bi-textarea-t","controlName","this.form.id",3,"size","control"],["label","Unidade","controlName","unidade_id",3,"size","control","dao"],["label","Cliente","controlName","cliente_id",3,"size","control","dao"],["label","Status","controlName","this.form.status",3,"size","items","control",4,"ngIf"],["label","Status","controlName","this.form.status",3,"size","items","control"]],template:function(s,o){if(1&s){const n=t.RV6();t.j41(0,"editable-form",2),t.bIt("submit",function(){return t.eBV(n),t.Njj(o.onSubmitClick())})("cancel",function(){return t.eBV(n),t.Njj(o.onCancel())}),t.j41(1,"div",3)(2,"div",4),t.nrm(3,"input-text",5)(4,"input-text",6)(5,"input-search",7,0)(7,"input-search",8,1),t.DNE(9,Re,1,3,"input-select",9),t.k0s()()()}2&s&&(t.Y8G("form",o.form),t.R7$(3),t.Y8G("size",12)("control",o.form.controls.nome),t.BMQ("maxlength",250),t.R7$(),t.Y8G("size",12)("control",o.form.controls.id),t.BMQ("maxlength",10),t.R7$(),t.Y8G("size",6)("control",o.form.controls.unidade_id)("dao",o.unidadeDao),t.R7$(2),t.Y8G("size",6)("control",o.form.controls.cliente_id)("dao",o.clienteDao),t.R7$(2),t.Y8G("ngIf",o.enableStatus))},dependencies:[v.bT,m.Q,_.O,S.H,G.K]})}}return i})(),w=(()=>{class i{constructor(e,s){this.auth=e,this.router=s}canActivate(e,s){return this.auth.isUsuarioDeveloper()||this.auth.isGestorAlgumaAreaTrabalho(!1)}static{this.\u0275fac=function(s){return new(s||i)(t.KVO(k.u),t.KVO(j.Ix))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const je=[{path:"",component:pt,canActivate:[E.q],resolve:{config:R.L},runGuardsAndResolvers:"always",data:{title:"Produtos"}},{path:"new",component:M,canActivate:[E.q,w],resolve:{config:R.L},runGuardsAndResolvers:"always",data:{title:"Inclus\xe3o de produto",modal:!0}},{path:"filter",component:De,canActivate:[E.q],resolve:{config:R.L},runGuardsAndResolvers:"always",data:{title:"Busca Avan\xe7ada",modal:!0}},{path:":id/edit",component:M,canActivate:[E.q,w],resolve:{config:R.L},runGuardsAndResolvers:"always",data:{title:"Edi\xe7\xe3o de produto",modal:!0}},{path:":id/show",component:Fe,canActivate:[E.q],resolve:{config:R.L},runGuardsAndResolvers:"always",data:{title:"Visualiza\xe7\xe3o de produto",modal:!0}}];let Se=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[j.iI.forChild(je),j.iI]})}}return i})();var Ge=l(8832),Te=l(8425);let ke=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[v.MD,Te.h,Ge.X1,Se]})}}return i})()}}]);
"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[2757],{2757:(F,u,n)=>{n.r(u),n.d(u,{ListenersModule:()=>O});var v=n(6610),m=n(8069),s=n(3308),p=n(2119),h=n(2220),d=n(3982),o=n(3279);let f=(()=>{class i extends d.y{constructor(e){super(e,"editor-montar"),this.injector=e,this.documentoDao=e.get(p.c)}ngOnInit(){super.ngOnInit()}documentoPendenteSei(e){var t=this;return(0,s.A)(function*(){const r=yield t.documentoDao.documentoPendenteSei(e);if(r){const a=yield t.execute("setConteudoDocumento",[0,r.conteudo]);a?.length&&(yield t.documentoDao.update(r.id,{status:h.j.STATUS_GERADO,numero_documento:a}))}})()}loadToolbarButtons(e){var t=this;return(0,s.A)(function*(){t.gb.toolbarButtons=[]})()}static{this.\u0275fac=function(t){return new(t||i)(o.rXU(o.zZn))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-editor-montar"]],features:[o.Vt3],decls:2,vars:0,template:function(t,r){1&t&&(o.j41(0,"p"),o.EFF(1,"editor-montar works!"),o.k0s())}})}}return i})(),y=(()=>{class i extends d.y{constructor(e){super(e,"petrvs-listener"),this.injector=e}ngOnInit(){}static{this.\u0275fac=function(t){return new(t||i)(o.rXU(o.zZn))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-petrvs-listener"]],features:[o.Vt3],decls:2,vars:0,template:function(t,r){1&t&&(o.j41(0,"p"),o.EFF(1,"petrvs-listener works!"),o.k0s())}})}}return i})();var b=n(5362);let A=(()=>{class i extends d.y{constructor(e){super(e,"procedimento_escolher_tipo"),this.injector=e,this.tipoProcessoDao=e.get(b.W)}ngOnInit(){super.ngOnInit()}loadToolbarButtons(){var e=this;return(0,s.A)(function*(){e.gb.toolbarButtons=[{icon:"bi bi-folder-check",color:"btn-outline-primary",hint:"Atualizar tipos de processos",onClick:e.atualizarTiposProcessos.bind(e)}]})()}atualizarTiposProcessos(){var e=this;return(0,s.A)(function*(){let t=yield e.execute("getTiposProcessos",[]);(yield e.tipoProcessoDao.atualizar(t))?e.dialog.alert("Atualiza\xe7\xe3o","Atualiza\xe7\xe3o realizada com sucesso!"):e.dialog.alert("ERROR","Aconteceu algum problema ao tentar realizar a atualiza\xe7\xe3o!")})()}static{this.\u0275fac=function(t){return new(t||i)(o.rXU(o.zZn))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-procedimento-escolher-tipo"]],features:[o.Vt3],decls:2,vars:0,template:function(t,r){1&t&&(o.j41(0,"p"),o.EFF(1,"procedimento-escolher-tipo works!"),o.k0s())}})}}return i})();var C=n(3214),x=n(7509),D=n(9047),T=n(5917),z=n(6295),g=n(4282);const E=[{path:"editor-montar",component:f},{path:"procedimento-trabalhar",component:(()=>{class i extends d.y{constructor(e){super(e,"procedimento_trabalhar"),this.injector=e,this.dao=e.get(x.M),this.tipoDocumentoDao=e.get(D.Y)}loadToolbarButtons(e){var t=this;return(0,s.A)(function*(){let r=[];if(e.includes("plano")&&r.push({icon:"bi bi-list-check",color:"btn-outline-primary",hint:"Gerar termo de ades\xe3o",onClick:t.gerarTermoAdesao.bind(t)}),e.includes("entrega")){let a=[];e.includes("concluir_entrega")&&a.push({icon:"bi bi-check-circle",color:"btn-outline-primary",label:"Concluir "+t.lex.translate("entrega"),onClick:t.concluirEntrega.bind(t)}),r.push({icon:"bi bi-boxes",color:"btn-outline-secondary",hint:"Incluir "+t.lex.translate("entrega"),onClick:t.incluirEntrega.bind(t),items:a.length?a:void 0})}if(e.includes("atualizar")&&r.push({icon:"bi bi-file-check",color:"btn-outline-warning",hint:"Atualizar tipos de documentos",onClick:t.atualizarTiposDocumentos.bind(t)}),e.find(a=>["incluir","concluir","atividades"].includes(a))){let a=[];e.includes("incluir")&&a.push({icon:"bi bi-plus-circle",color:"btn-outline-primary",label:"Incluir "+t.lex.translate("atividade"),onClick:t.incluirAtividade.bind(t)}),e.includes("concluir")&&a.push({icon:"bi bi-check-circle",color:"btn-outline-primary",label:"Concluir "+t.lex.translate("atividade"),onClick:t.concluirAtividade.bind(t)}),r.push({icon:"bi bi-activity",color:"btn-outline-success",hint:t.lex.translate("atividade"),onClick:t.atividades.bind(t),items:a.length?a:void 0})}t.gb.toolbarButtons=r})()}incluirAtividade(){var e=this;return(0,s.A)(function*(){let t=yield e.execute("getSeiKeys",[]);t&&e.go.navigate({route:["gestao","atividade","new"]},{metadata:{sei:t},modal:!0})})()}atividades(){var e=this;return(0,s.A)(function*(){let t=yield e.execute("getProcessoKeys",[]);t&&e.go.navigate({route:["gestao","atividade"],params:{filter:{numero_processo:t.numero_processo}}},{modal:!0,modalWidth:1200})})()}concluirAtividade(){var e=this;return(0,s.A)(function*(){if(yield e.execute("getDocumentKeys",[])){const r=yield g.b.modalSelect({fixedFilter:[["status","==","INICIADO"]]});r&&(r.metadados?.pausado?(yield e.dialog.confirm("Atividade pausada","Para concluir \xe9 necess\xe1rio primeiro reiniciar a atividade. Deseja reiniciar?"))&&e.go.navigate({route:["gestao","atividade",r.id,"pausar"],params:{reiniciar:!0}},{modal:!0,modalClose:a=>{a?.length&&e.go.navigate({route:["gestao","atividade",r.id,"concluir"]},{modal:!0})}}):e.go.navigate({route:["gestao","atividade",r.id,"concluir"]},{modal:!0}))}})()}concluirEntrega(){var e=this;return(0,s.A)(function*(){let t=yield e.execute("getProcessoKeys",[]);t&&e.go.navigate({route:["gestao","atividade","entrega","concluir"],params:{id_processo:t.id_processo}},{modal:!0})})()}incluirEntrega(){var e=this;return(0,s.A)(function*(){let t=yield e.execute("getSeiKeys",[]);if(t){const r=yield g.b.modalSelect({fixedFilter:[["status","==","NAOCONCLUIDO"]]});if(r){const a=new T.N;a.id=e.dao.generateUuid(),a.usuario=e.auth.usuario,a.usuario_id=e.auth.usuario.id,a.atividade_id=r.id||"",a.comentarios=[],a._status="ADD",e.go.navigate({route:["gestao","atividade","tarefa"]},{metadata:{entrega:a,atividade:r,sei:t},modalClose:c=>{c&&(0,s.A)(function*(){try{const l=e.injector.get(C.U);e.dialog.showSppinerOverlay("Salvando dados do formul\xe1rio"),yield l.save(c)}catch(l){e.dialog.alert("Error",l.message?l.message:l)}finally{e.dialog.closeSppinerOverlay()}})()}})}}})()}gerarTermoAdesao(){var e=this;return(0,s.A)(function*(){const t=yield z.r.modalSelect();if(t){let r=yield e.execute("getProcessoKeys",[]);e.go.navigate({route:["gestao","plano-trabalho","termo"]},{metadata:{plano:t,processo:r},modalClose:a=>{a?.termo?.length&&(0,s.A)(function*(){e.dialog.showSppinerOverlay("Gerando documento no sei...");try{const c=yield e.execute("incluirDocumento",[r.id_processo,a.codigo_tipo_documento]);if(c){const l=e.injector.get(p.c),k=Object.assign(new h.j,{especie:"TCR",conteudo:a?.termo,id_processo:r.id_processo,id_documento:c.id_documento,numero_processo:c.numero_processo,plano_trabalho_id:t.id,tipo_documento_id:a.tipo_documento_id,status:"AGUARDANDO_SEI"});yield l.save(k),yield e.execute("recarregarArvore",[c.urlReload]),yield e.execute("abrirEditor",[c.urlEditor,c.idUser])}}catch(c){e.dialog.alert("Error",c.message?c.message:c)}finally{e.dialog.closeSppinerOverlay()}})()}})}})()}atualizarTiposDocumentos(){var e=this;return(0,s.A)(function*(){let t=yield e.execute("getTiposDocumentos",[]);(yield e.tipoDocumentoDao.atualizar(t))?e.dialog.alert("Atualiza\xe7\xe3o","Atualiza\xe7\xe3o realizada com sucesso!"):e.dialog.alert("ERROR","Aconteceu algum problema ao tentar realizar a atualiza\xe7\xe3o!")})()}static{this.\u0275fac=function(t){return new(t||i)(o.rXU(o.zZn))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-procedimento-trabalhar"]],features:[o.Vt3],decls:2,vars:0,template:function(t,r){1&t&&(o.j41(0,"p"),o.EFF(1,"procedimento-trabalhar works!"),o.k0s())}})}}return i})()},{path:"procedimento-escolher-tipo",component:A},{path:"petrvs",component:y}];let P=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[m.iI.forChild(E),m.iI]})}}return i})(),O=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[v.MD,P]})}}return i})()}}]);
"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[3622],{3622:(S,f,l)=>{l.r(f),l.d(f,{EntregaModule:()=>H});var r=l(6610),y=l(8832),G=l(9455),h=l(8069),u=l(1620),d=l(6819),C=l(3308),v=l(1641),p=l(1385),Q=l(291);class m extends Q.C{constructor(s){super(),this.nome="",this.descricao="",this.tipo_indicador="PORCENTAGEM",this.lista_qualitativos=[],this.etiquetas=[],this.checklist=[],this.unidade_id=null,this.initialization(s)}}var b=l(24),g=l(3535),t=l(3279),O=l(16),T=l(158),R=l(3678),L=l(1230);const D=["itemQualitativo"];function F(a,s){if(1&a&&(t.j41(0,"div",6)(1,"div",7)(2,"label",8),t.EFF(3,"\xa0"),t.k0s(),t.j41(4,"input-multiselect",9),t.nrm(5,"input-text",10),t.k0s()()()),2&a){const o=t.XpG();t.R7$(4),t.Y8G("addItemHandle",o.addItemHandleItemQualitativo.bind(o)),t.R7$(),t.BMQ("maxlength",250)}}let c=(()=>{class a extends b.n{constructor(o){super(o,m,p.u),this.injector=o,this.listaQualitativos=[],this.etiquetas=[],this.checklist=[],this.validate=(i,e)=>{let n=null;return["nome","tipo_indicador","descricao"].indexOf(e)>=0&&!i.value?.length&&(n="Obrigat\xf3rio"),n},this.formValidation=i=>{let e=null;return"QUALITATIVO"==this.form?.controls.tipo_indicador.value&&!this.form?.controls.lista_qualitativos.value.length&&(e="Quando o tipo da entrega for Qualitativo, \xe9 necess\xe1ria a inclus\xe3o de ao menos um item de qualitativo!"),e},this.titleEdit=i=>"Editando "+this.lex.translate("Entrega")+": "+(i?.nome||""),this.unidadeDao=o.get(g.s),this.modalWidth=900,this.title="Inclus\xe3o de "+this.lex.translate("Entregas"),this.join=["unidade"],this.form=this.fh.FormBuilder({nome:{default:""},descricao:{default:""},tipo_indicador:{default:""},qualitativo:{default:""},lista_qualitativos:{default:[]},item_qualitativo:{default:""},unidade_id:{default:null},etiquetas:{default:[]},checklist:{default:[]},etiqueta_texto:{default:""},etiqueta_icone:{default:null},etiqueta_cor:{default:null}},this.cdRef,this.validate),this.formChecklist=this.fh.FormBuilder({id:{default:""},texto:{default:""},checked:{default:!1}},this.cdRef)}loadData(o,i){let e=Object.assign({},i.value);i.patchValue(this.util.fillForm(e,o)),this.loadListaQualitativos()}initializeData(o){o.patchValue(new m)}saveData(o){var i=this;return(0,C.A)(function*(){return new Promise((e,n)=>{const I=i.util.fill(new m,i.entity);e(i.util.fillForm(I,i.form.value))})})()}incluirQualitativo(o){let i=o.trim().replace(" ","%"),e=this.form.controls.lista_qualitativos.value;!e.find(n=>n==i)&&i.length&&(this.clearErros(),e.push(i),this.form.controls.lista_qualitativos.setValue(e),this.form?.controls.qualitativo.setValue(""),this.loadListaQualitativos())}excluirQualitativo(o){let i=this.form.controls.lista_qualitativos.value;i.find(e=>e==o)&&(this.form.controls.lista_qualitativos.setValue(i.filter(e=>e!=o)),this.loadListaQualitativos())}loadListaQualitativos(){this.listaQualitativos=this.form.controls.lista_qualitativos.value||[]}addItemHandleItemQualitativo(){let o;const i=this.form.controls.item_qualitativo.value,e=this.util.onlyAlphanumeric(i).toUpperCase();return i?.length&&this.util.validateLookupItem(this.form.controls.lista_qualitativos.value,e)&&(o={key:e,value:this.form.controls.item_qualitativo.value},this.form.controls.item_qualitativo.setValue("")),o}addItemHandleEtiquetas(){let o;const i=this.form.controls.etiqueta_texto.value,e=this.util.textHash(i);return i?.length&&this.util.validateLookupItem(this.form.controls.etiquetas.value,e)&&(o={key:e,value:this.form.controls.etiqueta_texto.value,color:this.form.controls.etiqueta_cor.value,icon:this.form.controls.etiqueta_icone.value},this.form.controls.etiqueta_texto.setValue(""),this.form.controls.etiqueta_icone.setValue(null),this.form.controls.etiqueta_cor.setValue(null)),o}static{this.\u0275fac=function(i){return new(i||a)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["app-entrega-form"]],viewQuery:function(i,e){if(1&i&&(t.GBs(v.Q,5),t.GBs(D,5)),2&i){let n;t.mGM(n=t.lsd())&&(e.editableForm=n.first),t.mGM(n=t.lsd())&&(e.itemQualitativo=n.first)}},features:[t.Vt3],decls:8,vars:13,consts:[["initialFocus","nome",3,"submit","cancel","form","disabled","title"],[1,"row"],["controlName","nome","required","",3,"size","label"],["controlName","descricao","required","",3,"size","rows","label"],["icon","bi bi-arrow-up-right-circle","controlName","tipo_indicador",3,"size","label","items"],["class","row col-6",4,"ngIf"],[1,"row","col-6"],[1,"col-12"],["for","itemQualitativo",1,"radio","control-label"],["label","Itens Qualitativos","controlName","lista_qualitativos",3,"addItemHandle"],["icon","far fa-edit","controlName","item_qualitativo"]],template:function(i,e){1&i&&(t.j41(0,"editable-form",0),t.bIt("submit",function(){return e.onSaveData()})("cancel",function(){return e.onCancel()}),t.j41(1,"div",1)(2,"div",1),t.nrm(3,"input-text",2),t.k0s(),t.j41(4,"div",1),t.nrm(5,"input-textarea",3)(6,"input-select",4),t.DNE(7,F,6,2,"div",5),t.k0s()()()),2&i&&(t.Y8G("form",e.form)("disabled",e.formDisabled)("title",e.isModal?"":e.title),t.R7$(3),t.Y8G("size",12)("label","Nome "+e.lex.translate("entrega")),t.BMQ("maxlength",1e3),t.R7$(2),t.Y8G("size",7)("rows",2)("label","Descri\xe7\xe3o "+e.lex.translate("entrega")),t.R7$(),t.Y8G("size",5)("label",e.lex.translate("Tipo de indicador"))("items",e.lookup.TIPO_INDICADOR),t.R7$(),t.Y8G("ngIf","QUALITATIVO"==(null==e.form?null:e.form.controls.tipo_indicador.value)||null))},dependencies:[r.bT,v.Q,O.H,T.S,R.K,L.b]})}}return a})();var E=l(5611),A=l(9062),N=l(2034),B=l(5852),V=l(2305),j=l(6764),q=l(5201);function M(a,s){1&a&&t.nrm(0,"toolbar")}function $(a,s){1&a&&t.nrm(0,"badge",11),2&a&&t.Y8G("label",s.$implicit.value)}function Y(a,s){if(1&a&&(t.j41(0,"div",9),t.DNE(1,$,1,1,"badge",10),t.k0s()),2&a){const o=s.row;t.R7$(),t.Y8G("ngForOf",o.lista_qualitativos)}}const z=[{path:"",component:(()=>{class a extends A.P{constructor(o){super(o,m,p.u),this.injector=o,this.filterWhere=i=>{let e=[],n=i.value;return n.nome?.length&&e.push(["nome","like","%"+n.nome.trim().replace(" ","%")+"%"]),n.tipo_indicador?.length&&e.push(["tipo_indicador","==",n.tipo_indicador]),e},this.join=["unidade:id,sigla,nome"],this.title=this.lex.translate("Modelos de Entregas"),this.code="MOD_ENTRG",this.unidadeDao=o.get(g.s),this.filter=this.fh.FormBuilder({nome:{default:""},tipo_indicador:{default:null}}),this.addOption(this.OPTION_INFORMACOES),this.addOption(this.OPTION_EXCLUIR,"MOD_ENTRG_EXCL"),this.addOption(this.OPTION_LOGS,"MOD_AUDIT_LOG")}static{this.\u0275fac=function(i){return new(i||a)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["app-entrega-list"]],viewQuery:function(i,e){if(1&i&&t.GBs(E._,5),2&i){let n;t.mGM(n=t.lsd())&&(e.grid=n.first)}},features:[t.Vt3],decls:11,vars:16,consts:[["columnQualitativos",""],[3,"select","dao","add","title","orderBy","groupBy","join","selectable","hasAdd","hasEdit"],[4,"ngIf"],["title","Nome","field","nome","orderBy","nome"],["title","Descri\xe7\xe3o","field","descricao","orderBy","descricao"],["type","select","field","tipo_indicador",3,"title","items"],["title","N\xedveis",3,"template"],["type","options",3,"onEdit","options"],[3,"rows"],[1,"one-per-line"],["color","light","icon","bi bi-check2-square",3,"label",4,"ngFor","ngForOf"],["color","light","icon","bi bi-check2-square",3,"label"]],template:function(i,e){if(1&i){const n=t.RV6();t.j41(0,"grid",1),t.bIt("select",function(P){return t.eBV(n),t.Njj(e.onSelect(P))}),t.DNE(1,M,1,0,"toolbar",2),t.j41(2,"columns"),t.nrm(3,"column",3)(4,"column",4)(5,"column",5),t.j41(6,"column",6),t.DNE(7,Y,2,1,"ng-template",null,0,t.C5r),t.k0s(),t.nrm(9,"column",7),t.k0s(),t.nrm(10,"pagination",8),t.k0s()}if(2&i){const n=t.sdS(8);t.Y8G("dao",e.dao)("add",e.add)("title",e.isModal?"":e.title)("orderBy",e.orderBy)("groupBy",e.groupBy)("join",e.join)("selectable",e.selectable)("hasAdd",!1)("hasEdit",!1),t.R7$(),t.Y8G("ngIf",!e.selectable),t.R7$(4),t.Y8G("title",e.lex.translate("Tipo do indicador"))("items",e.lookup.TIPO_INDICADOR),t.R7$(),t.Y8G("template",n),t.R7$(3),t.Y8G("onEdit",e.edit)("options",e.options),t.R7$(),t.Y8G("rows",e.rowsLimit)}},dependencies:[r.Sq,r.bT,E._,N.T,B.I,V.H,j.e,q.n]})}}return a})(),canActivate:[u.q],resolve:{config:d.L},runGuardsAndResolvers:"always",data:{title:"Entregas"}},{path:"new",component:c,canActivate:[u.q],resolve:{config:d.L},runGuardsAndResolvers:"always",data:{title:"Inclus\xe3o de Entrega",modal:!0}},{path:":id/edit",component:c,canActivate:[u.q],resolve:{config:d.L},runGuardsAndResolvers:"always",data:{title:"Edi\xe7\xe3o de Entrega",modal:!0}},{path:":id/consult",component:c,canActivate:[u.q],resolve:{config:d.L},runGuardsAndResolvers:"always",data:{title:"Consulta a Entrega",modal:!0}}];let U=(()=>{class a{static{this.\u0275fac=function(i){return new(i||a)}}static{this.\u0275mod=t.$C({type:a})}static{this.\u0275inj=t.G2t({imports:[h.iI.forChild(z),h.iI]})}}return a})(),H=(()=>{class a{static{this.\u0275fac=function(i){return new(i||a)}}static{this.\u0275mod=t.$C({type:a})}static{this.\u0275inj=t.G2t({imports:[r.MD,G.h,y.X1,U]})}}return a})()}}]);
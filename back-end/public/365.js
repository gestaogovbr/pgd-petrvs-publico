"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[365],{365:(Dt,y,l)=>{l.r(y),l.d(y,{SolucaoModule:()=>It});var h=l(6610),E=l(8069),u=l(3308),g=l(5611),c=l(9175),T=l(9492),A=l(3535),_=l(5413),I=l(291);class O extends I.C{constructor(s){super(),this.id_unidade="",this.id_solucao="",this.status=!0,this.initialization(s)}}class m extends I.C{constructor(s){super(),this.identificador=0,this.nome="",this.sigla="",this.descricao="",this.url="",this.solucoes_unidades=[],this.produtos_solucoes=[],this.initialization(s)}}var k=l(9062),t=l(3279),P=l(4796);let B=(()=>{class n{constructor(e){this.auth=e,this.solucao=[]}static{this.\u0275fac=function(a){return new(a||n)(t.KVO(P.u))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var F=l(2034),D=l(5852),Y=l(7772),w=l(2305),L=l(6764),$=l(114),N=l(9226),b=l(5201);function M(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",26),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.ativarTodas())}),t.EFF(1,"Ativar todas as Solu\xe7\xf5es "),t.k0s()}if(2&n){const e=t.XpG(2);t.Y8G("disabled",e.isUpdating)}}function V(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",27),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.desativarTodas())}),t.EFF(1,"Desativar todas as Solu\xe7\xf5es "),t.k0s()}if(2&n){const e=t.XpG(2);t.Y8G("disabled",e.isUpdating&&(null==e.grid||null==e.grid.items?null:e.grid.items.length))}}function z(n,s){if(1&n&&(t.j41(0,"toolbar"),t.DNE(1,M,2,1,"button",24)(2,V,2,1,"button",25),t.k0s()),2&n){let e,a;const o=t.XpG();t.R7$(),t.Y8G("ngIf",o.isCurador&&(null===(e=null==o.grid||null==o.grid.items?null:o.grid.items.length)||void 0===e||e)),t.R7$(),t.Y8G("ngIf",o.isCurador&&(null===(a=null==o.grid||null==o.grid.items?null:o.grid.items.length)||void 0===a||a))}}function X(n,s){1&n&&(t.j41(0,"span"),t.EFF(1,"Unidade"),t.k0s())}function Q(n,s){1&n&&(t.j41(0,"span"),t.EFF(1,"Nome"),t.k0s())}function x(n,s){1&n&&(t.j41(0,"span"),t.EFF(1,"#ID"),t.k0s())}function H(n,s){1&n&&(t.j41(0,"span"),t.EFF(1,"Status"),t.k0s())}function Z(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s(),t.nrm(2,"br")),2&n){const e=s.row;t.R7$(),t.SpI(" ",e.identificador,"")}}function J(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s(),t.nrm(2,"br")),2&n){const e=s.row;t.R7$(),t.SpI(" ",e.nome,"")}}function W(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s(),t.nrm(2,"br")),2&n){const e=s.row;t.R7$(),t.SpI(" ",e.sigla,"")}}function K(n,s){if(1&n&&t.nrm(0,"badge",29),2&n){const e=s.row,a=t.XpG(2);t.Y8G("color",e.deleted_at?"secondary":a.isActive[e.id]?"success":"danger")("label",e.deleted_at?"Exclu\xeddo":a.isActive[e.id]?"Ativo":"Inativo")}}function q(n,s){if(1&n&&(t.j41(0,"column",28),t.DNE(1,K,1,2,"ng-template",null,4,t.C5r),t.k0s()),2&n){const e=t.sdS(2);t.Y8G("template",e)}}function tt(n,s){if(1&n){const e=t.RV6();t.j41(0,"input-switch",31),t.bIt("change",function(o){const i=t.eBV(e).row,r=t.XpG(2);return t.Njj(r.ativarDesativar(i,o))}),t.k0s()}if(2&n){const e=s.row,a=t.XpG(2);t.Y8G("size",12)("value",a.isActive[e.id]?"true":"false")("valueOn","true")("valueOff","false")("disabled",e.deleted_at)}}function et(n,s){if(1&n&&(t.j41(0,"column",30),t.DNE(1,tt,1,5,"ng-template",null,5,t.C5r),t.k0s()),2&n){const e=t.sdS(2);t.Y8G("template",e)}}let ot=(()=>{class n extends k.P{constructor(e,a){super(e,m,c.Y),this.injector=e,this.botoes=[],this.isUpdating=!1,this.isSearching=!1,this.solucoesUnidades=[],this.isActive={},this.unidadeId="",this.instituidoraObtida=!1,this.filterWhere=o=>{let i=[],r=o.value;return r.nome?.length&&i.push(["or",["sigla","like","%"+r.nome.trim().replace(" ","%")+"%"],["nome","like","%"+r.nome.trim().replace(" ","%")+"%"]]),r.id?.length&&i.push(["identificador","=",r.id]),r.unidade_id?.length&&i.push(["unidade_ativa","==",this.instituidoraObtida?r.unidade_id:"XX"]),"ativo"==r.status&&i.push(["unidade_ativa","==",r.unidade_id??this.unidadeId]),"inativo"==r.status&&i.push(["unidade_inativa","==",r.unidade_id??this.unidadeId]),i},this.catalogoService=e.get(B),this.usuarioDao=e.get(_._),this.unidadeDao=e.get(A.s),this.solucaoUnidadeDao=e.get(T.k),this.solucaoDao=e.get(c.Y),this.title=this.lex.translate("Solu\xe7\xf5es"),this.filter=this.fh.FormBuilder({agrupar:{default:!0},nome:{default:this.metadata?.nome??""},unidade_id:{default:this.auth.unidade?.id},id:{default:""},status:{default:""}}),this.orderBy=[["identificador","desc"]],this.auth.hasPermissionTo("MOD_SOLUCOES_EXCL")&&this.options.push({icon:"bi bi-trash",label:"Excluir",onClick:this.delete.bind(this)}),this.isCurador=this.auth.isUsuarioCurador()}ngOnInit(){var e=()=>super.ngOnInit,a=this;return(0,u.A)(function*(){e().call(a),a.isSearching="search"==a.queryParams.mode,a.isSearching&&(a.filter?.controls.status.setValue("ativo"),a.saveUsuarioConfig());const o=yield a.getInstituidora();a.unidadeId=o?.id,a.filter?.controls.unidade_id.setValue(o?.id),a.instituidoraObtida=!0,a.saveUsuarioConfig(),a.onLoad(),a.loadingSolucoesUnidades()})()}getInstituidora(){var e=this;return(0,u.A)(function*(){return yield e.unidadeDao.obterInstituidora(e.auth.unidade?.id)})()}loadingSolucoesUnidades(){var e=this;return(0,u.A)(function*(){let a=e.auth.unidade?.id;e.solucoesUnidades=yield e.solucaoUnidadeDao?.query({where:[["id_unidade","==",a]]}).asPromise(),Object.keys(e.isActive).forEach(o=>delete e.isActive[o]),e.solucoesUnidades.forEach(o=>{e.isActive[o.id_solucao]=e.ativo(o.id_solucao)})})()}dynamicButtons(e){let a=[];return e._status||a.push({label:"Detalhes",icon:"bi bi-eye",color:"btn-outline-success",onClick:this.showDetalhes.bind(this)}),this.isCurador&&a.push({label:"Excluir",icon:"bi bi-trash",color:"btn-outline-danger",onClick:this.delete.bind(this)}),a}showDetalhes(e){var a=this;return(0,u.A)(function*(){a.go.navigate({route:["gestao","solucao",e.id,"consult"]},{metadata:{solucao:e}})})()}onAgruparChange(e){const a=this.filter.controls.agrupar.value;(a&&!this.groupBy?.length||!a&&this.groupBy?.length)&&(this.groupBy=a?[{field:"unidade.sigla",label:"Unidade"}]:[],this.grid.reloadFilter())}onBuscaAvancada(){var a,e=this;this.go.navigate({route:["gestao","solucao","filter"]},{metadata:{nome:this.filter?.controls.nome.value,id:this.filter?.controls.id.value,status:this.filter?.controls.status.value},modalClose:(a=(0,u.A)(function*(o){o&&e.filter&&(e.filter?.controls.nome.setValue(o.nome),e.filter?.controls.id.setValue(o.id),e.filter?.controls.status.setValue(o.status),e.grid.reloadFilter())}),function(i){return a.apply(this,arguments)})})}onFilterClear(){this.filter?.reset(),this.grid.reloadFilter(),this.cdRef.markForCheck()}ativarDesativar(e,a){var o=this;return(0,u.A)(function*(){if(!o.loading){o.loading=!0;try{let i=o.auth.unidade?.id;if(null==i)return;let r=o.getSolucaoUnidade(e.id,i);if(null!==r){let d=o.ativo(e.id),S=yield o.solucaoUnidadeDao.update(r.id,{id:r.id,status:!d}),C=r.id;o.solucoesUnidades=o.solucoesUnidades.filter(Ft=>Ft.id!=C),o.solucoesUnidades.push(S),o.isActive[e.id]=!d}else{r=new O,r.id_solucao=e.id,r.id_unidade=i;let d=yield o.solucaoUnidadeDao?.save(r);o.solucoesUnidades.push(d),o.isActive[e.id]=!0}}catch(i){console.error("Erro ao atualizar o produto",i),o.error(i.error?.message||i.message||i)}finally{o.isUpdating=!1,o.loading=!1}}})()}ativarTodas(){var e=this;return(0,u.A)(function*(){e.confirm("Ativar todas as Solu\xe7\xf5es","Deseja realmente ativar todas as Solu\xe7\xf5es?",(0,u.A)(function*(){e.loading=!0;try{let a=e.auth.unidade?.id;if(null==a)return;yield e.solucaoDao.ativarTodas(a),e.loadingSolucoesUnidades()}catch(a){console.error("Erro ao ativar as Solu\xe7\xf5es",a),e.error(a.error?.message||a.message||a)}finally{e.isUpdating=!1,e.loading=!1}}))})()}desativarTodas(){var e=this;return(0,u.A)(function*(){e.confirm("Desativar todas as Solu\xe7\xf5es","Deseja realmente desativar todas as Solu\xe7\xf5es?",(0,u.A)(function*(){e.loading=!0;try{let a=e.auth.unidade?.id;if(null==a)return;yield e.solucaoDao.desativarTodas(a),e.loadingSolucoesUnidades()}catch(a){console.error("Erro ao desativar as Solu\xe7\xf5es",a),e.error(a.error?.message||a.message||a)}finally{e.isUpdating=!1,e.loading=!1}}))})()}ativo(e){let a=this.auth.unidade?.id,o=this.getSolucaoUnidade(e,a);return!!o&&!!o.status}getSolucaoUnidade(e,a){const o=this.solucoesUnidades.findIndex(i=>i.id_solucao===e&&i.id_unidade===a);return-1==o?null:this.solucoesUnidades[o]}confirm(e,a,o){window.confirm(`${e}\n\n${a}`)&&o()}static{this.\u0275fac=function(a){return new(a||n)(t.rXU(t.zZn),t.rXU(c.Y))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-solucao-list"]],viewQuery:function(a,o){if(1&a&&t.GBs(g._,5),2&a){let i;t.mGM(i=t.lsd())&&(o.grid=i.first)}},features:[t.Vt3],decls:34,vars:32,consts:[["unidade",""],["columnID",""],["columnNome",""],["columnSigla",""],["columnStatus",""],["columnAtivar",""],["labelAdd","Incluir Nova Solu\xe7\xe3o",3,"select","dao","add","title","orderBy","groupBy","join","selectable","hasAdd","hasEdit","hasDelete"],[4,"ngIf"],["deletedLabel","Mostrar Exclu\xeddos",3,"deleted","form","where","submit","collapseChange","collapsed"],[1,"row"],[1,"col-md-4"],["label","Unidade Instituidora","controlName","unidade_id",3,"size","control","dao"],[1,"col-md-8","busca-avancada"],[1,"busca-avancada-link"],[3,"click"],[1,"busca-avancada-clear"],[1,"busca-avancada-filtros-aplicados"],["title","ID#",3,"template"],["title","Nome",3,"template"],["title","Sigla/Nome Fantasia",3,"template"],["title","Status","titleHint","Status na sua unidade instituidora",3,"template",4,"ngIf"],["title","Ativar/Desativar","titleHint","Ativar para sua unidade instituidora, permitindo que a Solu\xe7\xe3o esteja dispon\xedvel para vincula\xe7\xe3o de Produtos e Servi\xe7os nas unidades executoras subordinadas",3,"template",4,"ngIf"],["type","options",3,"onEdit","dynamicButtons"],[3,"rows"],["type","button","class","btn btn-outline-success",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-outline-danger",3,"disabled","click",4,"ngIf"],["type","button",1,"btn","btn-outline-success",3,"click","disabled"],["type","button",1,"btn","btn-outline-danger",3,"click","disabled"],["title","Status","titleHint","Status na sua unidade instituidora",3,"template"],[3,"color","label"],["title","Ativar/Desativar","titleHint","Ativar para sua unidade instituidora, permitindo que a Solu\xe7\xe3o esteja dispon\xedvel para vincula\xe7\xe3o de Produtos e Servi\xe7os nas unidades executoras subordinadas",3,"template"],["scale","small",3,"change","size","value","valueOn","valueOff","disabled"]],template:function(a,o){if(1&a){const i=t.RV6();t.j41(0,"grid",6),t.bIt("select",function(d){return t.eBV(i),t.Njj(o.onSelect(d))}),t.DNE(1,z,3,2,"toolbar",7),t.j41(2,"filter",8)(3,"div",9)(4,"div",10),t.nrm(5,"input-search",11,0),t.k0s(),t.j41(7,"div",12)(8,"div",13)(9,"a",14),t.bIt("click",function(){return t.eBV(i),t.Njj(o.onBuscaAvancada())}),t.EFF(10,"Busca Avan\xe7ada"),t.k0s()(),t.j41(11,"div",15)(12,"a",14),t.bIt("click",function(){return t.eBV(i),t.Njj(o.onFilterClear())}),t.EFF(13,"Limpar filtros de busca"),t.k0s()(),t.j41(14,"div",16),t.EFF(15,"Filtros aplicados: "),t.DNE(16,X,2,0,"span",7)(17,Q,2,0,"span",7)(18,x,2,0,"span",7)(19,H,2,0,"span",7),t.k0s()()()(),t.j41(20,"columns")(21,"column",17),t.DNE(22,Z,3,1,"ng-template",null,1,t.C5r),t.k0s(),t.j41(24,"column",18),t.DNE(25,J,3,1,"ng-template",null,2,t.C5r),t.k0s(),t.j41(27,"column",19),t.DNE(28,W,3,1,"ng-template",null,3,t.C5r),t.k0s(),t.DNE(30,q,3,1,"column",20)(31,et,3,1,"column",21),t.nrm(32,"column",22),t.k0s(),t.nrm(33,"pagination",23),t.k0s()}if(2&a){const i=t.sdS(23),r=t.sdS(26),d=t.sdS(29);t.Y8G("dao",o.dao)("add",o.add)("title",o.isModal?"":o.title)("orderBy",o.orderBy)("groupBy",o.groupBy)("join",o.join)("selectable",o.selectable)("hasAdd",o.isCurador)("hasEdit",o.auth.hasPermissionTo("MOD_SOLUCOES_EDT")&&o.isCurador)("hasDelete",o.auth.hasPermissionTo("MOD_SOLUCOES_DEL")&&o.isCurador),t.R7$(),t.Y8G("ngIf",!o.selectable),t.R7$(),t.Y8G("deleted",!o.isSearching&&o.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",o.filter)("where",o.filterWhere)("submit",o.filterSubmit.bind(o))("collapseChange",o.filterCollapseChange.bind(o))("collapsed",!o.selectable&&o.filterCollapsed),t.R7$(3),t.Y8G("size",6)("control",o.filter.controls.unidade_id)("dao",o.unidadeDao),t.R7$(11),t.Y8G("ngIf",(null==o.filter.controls.unidade_id.value?null:o.filter.controls.unidade_id.value.length)>0),t.R7$(),t.Y8G("ngIf",(null==o.filter.controls.nome.value?null:o.filter.controls.nome.value.length)>0),t.R7$(),t.Y8G("ngIf",(null==o.filter.controls.id.value?null:o.filter.controls.id.value.length)>0),t.R7$(),t.Y8G("ngIf",(null==o.filter.controls.status.value?null:o.filter.controls.status.value.length)>0),t.R7$(2),t.Y8G("template",i),t.R7$(3),t.Y8G("template",r),t.R7$(3),t.Y8G("template",d),t.R7$(3),t.Y8G("ngIf",!o.isSearching),t.R7$(),t.Y8G("ngIf",o.isCurador&&!o.isSearching),t.R7$(),t.Y8G("onEdit",o.edit)("dynamicButtons",o.dynamicButtons.bind(o)),t.R7$(),t.Y8G("rows",o.rowsLimit)}},dependencies:[h.bT,g._,F.T,D.I,Y.i,w.H,L.e,$.S,N.O,b.n],styles:["filter[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{align-items:end}.busca-avancada[_ngcontent-%COMP%]   .busca-avancada-link[_ngcontent-%COMP%], .busca-avancada[_ngcontent-%COMP%]   .busca-avancada-clear[_ngcontent-%COMP%]{margin-bottom:6px}.busca-avancada[_ngcontent-%COMP%]   .busca-avancada-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .busca-avancada[_ngcontent-%COMP%]   .busca-avancada-clear[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-weight:700;text-decoration:none;cursor:pointer;color:#000}.busca-avancada[_ngcontent-%COMP%]   .busca-avancada-filtros-aplicados[_ngcontent-%COMP%]{margin-top:4px;font-size:12px}.busca-avancada[_ngcontent-%COMP%]   .busca-avancada-filtros-aplicados[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;background-color:#ccc;padding:1px 5px;margin-right:3px;border-radius:3px}.ativar-desativar[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse}"]})}}return n})();var p=l(1620),f=l(6819),v=l(1641),at=l(24),G=l(16);const nt=["usuario"];let R=(()=>{class n extends at.n{constructor(e){super(e,m,c.Y),this.injector=e,this.usuarioDao=e.get(_._),this.modalWidth=1300,this.form=this.fh.FormBuilder({nome:{default:""},sigla:{default:""},unidade_id:{default:""},descricao:{default:""},url:{default:""}})}loadData(e,a){var o=this;return(0,u.A)(function*(){let i=Object.assign({},a.value);a.patchValue(o.util.fillForm(i,e))})()}initializeData(e){var a=this;return(0,u.A)(function*(){e.patchValue(new m),a.entity=new m,yield a.loadData(a.entity,a.form)})()}saveData(e){return new Promise((a,o)=>{const i=this.util.fill(new m,this.entity);a(this.util.fillForm(i,this.form.value))})}static{this.\u0275fac=function(a){return new(a||n)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-solucao-form"]],viewQuery:function(a,o){if(1&a&&(t.GBs(v.Q,5),t.GBs(nt,5)),2&a){let i;t.mGM(i=t.lsd())&&(o.editableForm=i.first),t.mGM(i=t.lsd())&&(o.usuario=i.first)}},features:[t.Vt3],decls:11,vars:15,consts:[["initialFocus","nome",3,"submit","cancel","form","disabled","title"],[1,"row"],[1,"col-md-4"],["label","Nome da Solu\xe7\xe3o","icon","bi bi-textarea-t","controlName","nome","labelInfo","Nome formal da Solu\xe7\xe3o. Ex: Programa de Gest\xe3o e Desempenho","required","",3,"size","control"],[1,"col-md-8"],["label","Sigla/Nome Fantasia","icon","bi bi-textarea-t","controlName","nome","labelInfo","Nome informal da Solu\xe7\xe3o. Ex: PGD","required","",3,"size","control"],[1,"col-md-6"],["label","Descri\xe7\xe3o","icon","bi bi-textarea-t","controlName","descricao","labelInfo","Objetivo e aplicabilidade da solu\xe7\xe3o. Ex: Programa indutor de melhoria de desempenho individual e institucional.","required","",3,"size","control"],["required","","label","URL","icon","bi bi-textarea-t","controlName","url","labelInfo","P\xe1gina oficial da Solu\xe7\xe3o. Ex: www.gov.br/pgd",3,"size","control"]],template:function(a,o){1&a&&(t.j41(0,"editable-form",0),t.bIt("submit",function(){return o.onSaveData()})("cancel",function(){return o.onCancel()}),t.j41(1,"div",1)(2,"div",2),t.nrm(3,"input-text",3),t.k0s(),t.j41(4,"div",4),t.nrm(5,"input-text",5),t.k0s()(),t.j41(6,"div",1)(7,"div",6),t.nrm(8,"input-text",7),t.k0s(),t.j41(9,"div",6),t.nrm(10,"input-text",8),t.k0s()()()),2&a&&(t.Y8G("form",o.form)("disabled",o.formDisabled)("title",o.isModal?"":o.title),t.R7$(3),t.Y8G("size",8)("control",o.form.controls.nome),t.BMQ("maxlength",250),t.R7$(2),t.Y8G("size",8)("control",o.form.controls.sigla),t.BMQ("maxlength",250),t.R7$(3),t.Y8G("size",6)("control",o.form.controls.descricao),t.BMQ("maxlength",250),t.R7$(2),t.Y8G("size",6)("control",o.form.controls.url),t.BMQ("maxlength",250))},dependencies:[v.Q,G.H]})}}return n})();var j=l(4795),it=l(568),U=l(3678);let st=(()=>{class n extends j.g{constructor(e){super(e),this.injector=e,this.lookup=e.get(it.s),this.usuarioDao=e.get(_._),this.modalWidth=500,this.form=this.fh.FormBuilder({id:{default:""},nome:{default:""},status:{default:""}},this.cdRef)}ngOnInit(){super.ngOnInit(),this.snapshot=this.snapshot||this.modalRoute||this.route.snapshot,this.urlParams=this.snapshot.paramMap,this.queryParams=this.go.decodeParam(this.snapshot.queryParams),this.metadata=this.go.getMetadata(this.snapshot.queryParams.idroute),this.form?.controls.nome.setValue(this.metadata.nome),this.form?.controls.id.setValue(this.metadata.id),this.form?.controls.status.setValue(this.metadata.status)}onSubmitClick(){var e=this;return(0,u.A)(function*(){e.loading=!0;try{let a={nome:e.form?.controls.nome.value,id:e.form?.controls.id.value,status:e.form?.controls.status.value};e.go.setModalResult(e.modalRoute?.queryParams?.idroute,a),e.close()}catch(a){e.error(a?.message||a?.error||a||"Erro desconhecido")}finally{e.loading=!1}})()}static{this.\u0275fac=function(a){return new(a||n)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["solucao-filtro"]],viewQuery:function(a,o){if(1&a&&t.GBs(v.Q,5),2&a){let i;t.mGM(i=t.lsd())&&(o.editableForm=i.first)}},features:[t.Vt3],decls:6,vars:10,consts:[["confirmLabel","Buscar",3,"submit","cancel","form"],[1,"row"],[1,"col-md-12"],["label","Nome/Sigla/Nome Fantasia","icon","bi bi-textarea-t","controlName","this.form.nome",3,"size","control"],["label","ID#","icon","bi bi-textarea-t","controlName","this.form.id",3,"size","control"],["label","Status","controlName","this.form.status",3,"size","items","control"]],template:function(a,o){1&a&&(t.j41(0,"editable-form",0),t.bIt("submit",function(){return o.onSubmitClick()})("cancel",function(){return o.onCancel()}),t.j41(1,"div",1)(2,"div",2),t.nrm(3,"input-text",3)(4,"input-text",4)(5,"input-select",5),t.k0s()()()),2&a&&(t.Y8G("form",o.form),t.R7$(3),t.Y8G("size",12)("control",o.form.controls.nome),t.BMQ("maxlength",250),t.R7$(),t.Y8G("size",12)("control",o.form.controls.id),t.BMQ("maxlength",10),t.R7$(),t.Y8G("size",12)("items",o.lookup.TIPO_ATIVO_INATIVO)("control",o.form.controls.status))},dependencies:[v.Q,G.H,U.K]})}}return n})();var lt=l(4468),rt=l(8857);const ut=["unidade"];function dt(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=s.row;t.R7$(),t.SpI(" ",e.produto.identificador,"")}}function ct(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=s.row;t.R7$(),t.SpI(" ",e.produto.nome,"")}}function mt(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=s.row;t.R7$(),t.SpI(" ",null==e.produto.unidade?null:e.produto.unidade.sigla,"")}}function pt(n,s){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=s.row,a=t.XpG();t.R7$(),t.JRh(a.lookup.getValue(a.lookup.TIPO_PRODUTO,null==e.produto?null:e.produto.tipo))}}function ft(n,s){if(1&n&&t.nrm(0,"badge",17),2&n){const e=s.row,a=t.XpG();t.Y8G("color",a.getStatusColor(e.produto))("label",a.getStatusText(e.produto))}}let ht=(()=>{class n extends j.g{set entity(e){super.entity=e}get entity(){return super.entity}constructor(e){super(e),this.injector=e,this.unidades=[],this.items=[],this.filter=this.fh.FormBuilder({unidade_id:{default:this.auth.unidade?.id}})}ngOnInit(){super.ngOnInit(),this.loadItens(),this.loadUnidades()}loadItens(){this.items=this.entity?.produtos_solucoes||[],this.unidade?.selectedItem&&(this.items=this.items.filter(e=>e.produto?.unidade_id==this.unidade?.selectedItem?.key))}loadUnidades(){if(!this.entity||!this.entity?.solucoes_unidades)return void(this.unidades=[]);const e=new Map;this.entity.solucoes_unidades.forEach(a=>{const o=a?.unidade;o&&!e.has(o.id)&&e.set(o.id,o)}),this.unidades=Array.from(e.values()).sort((a,o)=>a.sigla.localeCompare(o.sigla)).map(a=>({key:a.id,value:a.sigla}))}dynamicButtons(e){let a=[];return a.push({label:"Detalhes",icon:"bi bi-eye",color:"btn-outline-success",onClick:this.showProduto.bind(this)}),a}showProduto(e){var a=this;return(0,u.A)(function*(){a.go.navigate({route:["gestao","produto",e.produto_id,"show"]},{})})()}isAtivo(e){return e.data_ativado&&!e.data_desativado||!1}getStatusColor(e){return this.isAtivo(e)?"success":"danger"}getStatusText(e){return this.isAtivo(e)?"Ativo":"Inativo"}onUnidadeChange(e){this.loadItens()}static{this.\u0275fac=function(a){return new(a||n)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["solucao-list-produto"]],viewQuery:function(a,o){if(1&a&&(t.GBs(g._,5),t.GBs(ut,5)),2&a){let i;t.mGM(i=t.lsd())&&(o.grid=i.first),t.mGM(i=t.lsd())&&(o.unidade=i.first)}},inputs:{entity:"entity"},features:[t.Vt3],decls:23,vars:14,consts:[["gridProdutos",""],["unidade",""],["columnID",""],["columnNome",""],["columnUnidade",""],["columnTipo",""],["columnStatus",""],["noMargin","",3,"items","selectable","hasDelete","hasEdit","hasAdd"],[1,"row"],[1,"col-md-4"],["controlName","unidade_id","label","Unidade Instituidora",3,"change","size","items","control"],["title","ID#",3,"template"],["title","Nome",3,"template"],["title","Unidade",3,"template"],["title","Tipo",3,"template"],["title","Status",3,"template"],["type","options",3,"dynamicButtons"],[3,"color","label"]],template:function(a,o){if(1&a){const i=t.RV6();t.j41(0,"grid",7,0)(2,"div",8)(3,"div",9)(4,"input-select",10,1),t.bIt("change",function(d){return t.eBV(i),t.Njj(o.onUnidadeChange(d))}),t.k0s()()(),t.j41(6,"columns")(7,"column",11),t.DNE(8,dt,2,1,"ng-template",null,2,t.C5r),t.k0s(),t.j41(10,"column",12),t.DNE(11,ct,2,1,"ng-template",null,3,t.C5r),t.k0s(),t.j41(13,"column",13),t.DNE(14,mt,2,1,"ng-template",null,4,t.C5r),t.k0s(),t.j41(16,"column",14),t.DNE(17,pt,2,1,"ng-template",null,5,t.C5r),t.k0s(),t.j41(19,"column",15),t.DNE(20,ft,1,2,"ng-template",null,6,t.C5r),t.k0s(),t.nrm(22,"column",16),t.k0s()()}if(2&a){const i=t.sdS(9),r=t.sdS(12),d=t.sdS(15),S=t.sdS(18),C=t.sdS(21);t.Y8G("items",o.items)("selectable",!1)("hasDelete",!1)("hasEdit",!1)("hasAdd",!1),t.R7$(4),t.Y8G("size",12)("items",o.unidades)("control",null==o.form||null==o.form.controls?null:o.form.controls.unidade_id),t.R7$(3),t.Y8G("template",i),t.R7$(3),t.Y8G("template",r),t.R7$(3),t.Y8G("template",d),t.R7$(3),t.Y8G("template",S),t.R7$(3),t.Y8G("template",C),t.R7$(3),t.Y8G("dynamicButtons",o.dynamicButtons.bind(o))}},dependencies:[g._,F.T,D.I,U.K,b.n]})}}return n})();function gt(n,s){1&n&&(t.j41(0,"div",3),t.nrm(1,"span",4),t.k0s())}function vt(n,s){1&n&&t.nrm(0,"badge",15),2&n&&t.Y8G("label",s.$implicit.sigla)}function _t(n,s){if(1&n&&(t.qex(0),t.j41(1,"div",5)(2,"div")(3,"h4"),t.EFF(4),t.j41(5,"b"),t.EFF(6),t.k0s(),t.EFF(7),t.k0s()()(),t.j41(8,"div",6)(9,"div",7)(10,"div",8)(11,"small",9),t.EFF(12,"Descri\xe7\xe3o"),t.k0s(),t.j41(13,"b"),t.EFF(14),t.k0s()(),t.j41(15,"div",8)(16,"small",9),t.EFF(17,"URL"),t.k0s(),t.j41(18,"b"),t.EFF(19),t.k0s()()(),t.j41(20,"div",7)(21,"div",10)(22,"small",9),t.EFF(23,"Unidades ativas"),t.k0s(),t.j41(24,"div",11),t.DNE(25,vt,1,1,"badge",12),t.k0s()()()(),t.j41(26,"separator",13),t.nrm(27,"solucao-list-produto",14,0),t.k0s(),t.bVm()),2&n){const e=t.XpG();t.R7$(4),t.SpI("ID #",e.solucao.identificador," - "),t.R7$(2),t.JRh(e.solucao.nome),t.R7$(),t.SpI(" - ",e.solucao.sigla,""),t.R7$(7),t.JRh(e.solucao.descricao),t.R7$(5),t.JRh(e.solucao.url),t.R7$(6),t.Y8G("ngForOf",e.unidadesAtivas),t.R7$(2),t.Y8G("entity",e.solucao)}}const St=[{path:"",component:ot,canActivate:[p.q],resolve:{config:f.L},runGuardsAndResolvers:"always",data:{title:"Solu\xe7\xf5es"}},{path:"new",component:R,canActivate:[p.q],resolve:{config:f.L},runGuardsAndResolvers:"always",data:{title:"Solu\xe7\xf5es (Cadastro)",modal:!0}},{path:":id/edit",component:R,canActivate:[p.q],resolve:{config:f.L},runGuardsAndResolvers:"always",data:{title:"Solu\xe7\xf5es (Edi\xe7\xe3o)",modal:!0}},{path:"filter",component:st,canActivate:[p.q],resolve:{config:f.L},runGuardsAndResolvers:"always",data:{title:"Solu\xe7\xf5es (Busca Avan\xe7ada)",modal:!0}},{path:":id/consult",component:(()=>{class n extends lt.V{constructor(e){super(e),this.injector=e,this.solucaoDaoService=e.get(c.Y),this.loading=!0}ngOnInit(){super.ngOnInit(),this.carregaSolucaoDetalhado()}carregaSolucaoDetalhado(){var e=this;return(0,u.A)(function*(){e.solucao=yield e.solucaoDaoService.getById(e.urlParams.get("id")||"",["solucoesUnidades.unidade","produtosSolucoes.produto","produtosSolucoes.produto.unidade"]),e.loading=!1})()}ativo(e){return 1==e}get unidadesAtivas(){return this.solucao?.solucoes_unidades?.filter(e=>e.status).map(e=>e.unidade)||[]}isProdutoAtivo(e){return e.data_ativado&&!e.data_desativado}static{this.\u0275fac=function(a){return new(a||n)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["solucao-show"]],features:[t.Vt3],decls:2,vars:2,consts:[["produtos",""],["class","spinner-border","role","status",4,"ngIf"],[4,"ngIf"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"bg-dark-subtle","d-flex","p-2","px-4"],[1,"solucao-show","bg-body-secondary","mb-3"],[1,"row"],[1,"col-md-6"],[1,"d-block"],[1,"col-md-12"],[1,"unidades"],["color","secondary",3,"label",4,"ngFor","ngForOf"],["title","Produtos e Servi\xe7os cadastrados"],[3,"entity"],["color","secondary",3,"label"]],template:function(a,o){1&a&&t.DNE(0,gt,2,0,"div",1)(1,_t,29,7,"ng-container",2),2&a&&(t.Y8G("ngIf",o.loading),t.R7$(),t.Y8G("ngIf",o.solucao))},dependencies:[h.Sq,h.bT,rt.F,b.n,ht],styles:[".solucao-show[_ngcontent-%COMP%]{display:flex;gap:20px;width:100%;flex-direction:column;padding:10px 20px 20px}.unidades[_ngcontent-%COMP%]{display:flex;gap:5px}"]})}}return n})(),canActivate:[p.q],resolve:{config:f.L},runGuardsAndResolvers:"always",data:{title:"Solu\xe7\xf5es (Detalhamento)",modal:!0}}];let Ct=(()=>{class n{static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[E.iI.forChild(St),E.iI]})}}return n})();var yt=l(8832),Et=l(9455);let It=(()=>{class n{static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[h.MD,Et.h,yt.X1,Ct]})}}return n})()}}]);
"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[5670],{5670:(W,g,s)=>{s.r(g),s.d(g,{PreferenciaModule:()=>J});var u=s(6610),b=s(8069),f=s(1620),m=s(6819),l=s(3308),r=s(1641),h=s(24),c=s(3130),G=s(5413),e=s(3279),y=s(2305),E=s(114),D=s(16),R=s(3678),U=s(4054),j=s(1230),T=s(8857),B=s(8313);const $=["notificacoes"];function V(n,d){1&n&&(e.j41(0,"div",11)(1,"div",12),e.nrm(2,"span",13),e.k0s()())}function A(n,d){if(1&n&&(e.j41(0,"div",14)(1,"separator",15)(2,"div",4),e.nrm(3,"input-switch",16)(4,"input-switch",17),e.k0s()(),e.j41(5,"separator",18),e.nrm(6,"input-select",19),e.k0s()()),2&n){const i=e.XpG();e.R7$(),e.Y8G("title","Prefer\xeancias de exibi\xe7\xe3o "+i.lex.translate("usu\xe1rio")),e.R7$(2),e.Y8G("size",12)("label","Ocultar menu lateral do sei no Controle de "+i.lex.translate("Processo")),e.R7$(),e.Y8G("size",12),e.R7$(2),e.Y8G("items",i.lookup.THEMES)}}function N(n,d){if(1&n&&(e.j41(0,"separator",20),e.nrm(1,"notificacoes-config",21,0),e.k0s()),2&n){const i=e.XpG();e.R7$(),e.Y8G("entity",i.entity)("disabled",i.formDisabled)}}let v=(()=>{class n extends h.n{constructor(i){super(i,c.P,G._),this.injector=i,this.etiquetas=!1,this.carregando=!1,this.toolbarButtons=[{label:"Resetar",icon:"bi bi-backspace",onClick:()=>{this.loading=!0,this.dao.update(this.usuarioId,{config:new c.$}).then(t=>{this.initializeData(this.form)}).finally(()=>{this.loading=!1})}}],this.validate=(t,a)=>null,this.titleEdit=t=>"Editando "+this.lex.translate("Prefer\xeancia")+" "+this.lex.translate("do Usu\xe1rio")+": "+(t?.apelido||""),this.form=this.fh.FormBuilder({etiquetas:{default:[]},etiqueta_texto:{default:""},etiqueta_icone:{default:null},etiqueta_cor:{default:null},theme:{default:null},ocultar_menu_sei:{default:!0},ocultar_container_petrvs:{default:!1}},this.cdRef,this.validate)}get isPanel(){return null!=this.panel}ngOnInit(){super.ngOnInit(),this.urlParams.get("id")&&(this.usuarioId=this.urlParams.get("id")),this.etiquetas=!!this.queryParams.etiquetas}loadData(i,t){var a=this;return(0,l.A)(function*(){let o=Object.assign({},t.value);o=a.util.fillForm(o,i.config||{}),o=a.util.fillForm(o,i.notificacoes||{}),t.patchValue(o)})()}initializeData(i){var t=this;return(0,l.A)(function*(){t.carregando=!0;try{t.entity=yield t.dao.getById(t.usuarioId),yield t.loadData(t.entity,i)}finally{t.carregando=!1}})()}saveData(i){return new Promise((t,a)=>{this.notificacoes?.saveData();let o=this.util.fill(new c.$,this.form.value);Promise.all([this.auth.updateUsuarioConfig(this.usuarioId,o),this.auth.updateUsuarioNotificacoes(this.usuarioId,this.entity.notificacoes)]).then(p=>{this.usuarioId==this.auth.usuario.id?this.auth.authSession().then(K=>t(!this.isPanel)).catch(a):t(!this.isPanel)}).catch(a)})}addItemHandleEtiquetas(){let i;const t=this.form.controls.etiqueta_texto.value,a=this.util.textHash(t);return t?.length&&this.util.validateLookupItem(this.form.controls.etiquetas.value,a)&&(i={key:a,value:this.form.controls.etiqueta_texto.value,color:this.form.controls.etiqueta_cor.value,icon:this.form.controls.etiqueta_icone.value},this.form.controls.etiqueta_texto.setValue(""),this.form.controls.etiqueta_icone.setValue(null),this.form.controls.etiqueta_cor.setValue(null)),i}static{this.\u0275fac=function(t){return new(t||n)(e.rXU(e.zZn))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["preferencia-form-usuario"]],viewQuery:function(t,a){if(1&t&&(e.GBs(r.Q,5),e.GBs($,5)),2&t){let o;e.mGM(o=e.lsd())&&(a.editableForm=o.first),e.mGM(o=e.lsd())&&(a.notificacoes=o.first)}},inputs:{panel:"panel",usuarioId:"usuarioId"},features:[e.Vt3],decls:12,vars:17,consts:[["notificacoes",""],["class","d-flex justify-content-center",4,"ngIf"],[3,"buttons"],[3,"submit","cancel","form","noButtons"],[1,"row"],["class","col-md-6",4,"ngIf"],["label","Etiquetas","multiselectStyle","inline","controlName","etiquetas",3,"size","addItemHandle"],["label","Texto","controlName","etiqueta_texto",3,"size"],["label","\xcdcone","icon","fas fa-sign-out-alt","controlName","etiqueta_icone","liveSearch","",3,"size","items"],["label","Cor","controlName","etiqueta_cor",3,"size"],["transparent","","title","Notifica\xe7\xf5es",4,"ngIf"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"col-md-6"],["transparent","",3,"title"],["scale","small","labelPosition","right","controlName","ocultar_menu_sei",3,"size","label"],["scale","small","labelPosition","right","label","Ocultar o container Petrvs","controlName","ocultar_container_petrvs",3,"size"],["transparent","","title","Tema"],["controlName","theme",3,"items"],["transparent","","title","Notifica\xe7\xf5es"],[3,"entity","disabled"]],template:function(t,a){1&t&&(e.DNE(0,V,3,0,"div",1),e.j41(1,"div"),e.nrm(2,"toolbar",2),e.j41(3,"editable-form",3),e.bIt("submit",function(){return a.onSaveData()})("cancel",function(){return a.onCancel()}),e.j41(4,"div",4),e.DNE(5,A,7,5,"div",5),e.j41(6,"div")(7,"input-multiselect",6),e.nrm(8,"input-text",7)(9,"input-select",8)(10,"input-color",9),e.k0s()()(),e.DNE(11,N,3,2,"separator",10),e.k0s()()),2&t&&(e.Y8G("ngIf",a.carregando),e.R7$(),e.AVh("d-none",a.carregando),e.R7$(),e.Y8G("buttons",a.toolbarButtons),e.R7$(),e.Y8G("form",a.form)("noButtons",a.isPanel?"true":void 0),e.R7$(2),e.Y8G("ngIf",!a.etiquetas),e.R7$(),e.HbH(a.etiquetas?"col-md-12":"col-md-6"),e.R7$(),e.Y8G("size",12)("addItemHandle",a.addItemHandleEtiquetas.bind(a)),e.R7$(),e.Y8G("size",5),e.BMQ("maxlength",250),e.R7$(),e.Y8G("size",3)("items",a.lookup.ICONES),e.R7$(),e.Y8G("size",4),e.R7$(),e.Y8G("ngIf",a.entity&&!a.etiquetas))},dependencies:[u.bT,y.H,r.Q,E.S,D.H,R.K,U.f,j.b,T.F,B.d]})}}return n})();var Y=s(4468),P=s(4058),z=s(7509);function S(n,d){1&n&&(e.j41(0,"div",2)(1,"div",3),e.nrm(2,"span",4),e.k0s()())}let I=(()=>{class n extends h.n{constructor(i){super(i,P.J,z.M),this.injector=i,this.carregando=!1,this.validate=(t,a)=>null,this.titleEdit=t=>"Editando "+this.lex.translate("Prefer\xeancia")+" "+this.lex.translate("da Entidade")+": "+(t?.nome||""),this.form=this.fh.FormBuilder({},this.cdRef,this.validate)}get isPanel(){return null!=this.panel}loadData(i,t){var a=this;return(0,l.A)(function*(){let o=Object.assign({},t.value);t.patchValue(a.util.fillForm(o,i))})()}initializeData(i){var t=this;return(0,l.A)(function*(){t.carregando=!0;try{t.entity=new P.J,yield t.loadData(t.entity,i)}finally{t.carregando=!1}})()}saveData(i){return new Promise((t,a)=>{t(!this.isPanel)})}static{this.\u0275fac=function(t){return new(t||n)(e.rXU(e.zZn))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["preferencia-form-petrvs"]],viewQuery:function(t,a){if(1&t&&e.GBs(r.Q,5),2&t){let o;e.mGM(o=e.lsd())&&(a.editableForm=o.first)}},inputs:{panel:"panel"},features:[e.Vt3],decls:4,vars:5,consts:[["class","d-flex justify-content-center",4,"ngIf"],[3,"submit","cancel","form","noButtons"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(t,a){1&t&&(e.DNE(0,S,3,0,"div",0),e.j41(1,"div")(2,"editable-form",1),e.bIt("submit",function(){return a.onSaveData()})("cancel",function(){return a.onCancel()}),e.EFF(3," Em desenvolvimento "),e.k0s()()),2&t&&(e.Y8G("ngIf",a.carregando),e.R7$(),e.AVh("d-none",a.carregando),e.R7$(),e.Y8G("form",a.form)("noButtons",a.isPanel?"true":void 0))},dependencies:[u.bT,r.Q]})}}return n})();var F=s(2075),C=s(6774);function q(n,d){if(1&n&&(e.j41(0,"tab",9),e.EFF(1," Em desenvolvimento "),e.k0s()),2&n){const i=e.XpG();e.Y8G("label",i.lex.translate("Entidade"))}}let Q=(()=>{class n extends Y.V{constructor(i){super(i),this.injector=i,this.mensagemCarregando="Carregando dados do formul\xe1rio...",this.mensagemSalvando="Salvando dados do formul\xe1rio...",this.form=this.fh.FormBuilder({})}get forceInvalid(){return!!this.petrvs?.form?.invalid||!!this.usuario?.form?.invalid}onSaveData(){var i=this;return(0,l.A)(function*(){if(i.forceInvalid)i.petrvs?.form?.invalid||(i.editableForm.error="Form Petrvs com erro"),i.usuario?.form?.invalid||(i.editableForm.error="Form do usu\xe1rio com erro");else{i.submitting=!0;try{yield Promise.all([i.petrvs?.onSaveData(),i.usuario?.onSaveData()]),i.dialog.alert("Aten\xe7\xe3o","Algumas modifica\xe7\xf5es s\xf3 surtir\xe3o efeito ap\xf3s atualizar a p\xe1gina.\nPor motivos de seguran\xe7a esse procedimento, de atualizar a pagina, dever\xe1 ser executado pelo usu\xe1rio."),i.go.back()}catch(t){i.editableForm.error=t.message?t.message:t}finally{i.submitting=!1}}})()}onCancel(){this.close()}static{this.\u0275fac=function(t){return new(t||n)(e.rXU(e.zZn))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-preferencia-form"]],viewQuery:function(t,a){if(1&t&&(e.GBs(r.Q,5),e.GBs(I,5),e.GBs(v,5)),2&t){let o;e.mGM(o=e.lsd())&&(a.editableForm=o.first),e.mGM(o=e.lsd())&&(a.petrvs=o.first),e.mGM(o=e.lsd())&&(a.usuario=o.first)}},features:[e.Vt3],decls:9,vars:6,consts:[["usuario",""],["petrvs",""],[3,"submit","cancel","form","forceInvalid","title"],["display","","right",""],["key","USUARIO",3,"label"],["panel","",3,"usuarioId"],["key","PETRVS","label","Petrvs"],["panel",""],["key","ENTIDADE",3,"label",4,"ngIf"],["key","ENTIDADE",3,"label"]],template:function(t,a){if(1&t){const o=e.RV6();e.j41(0,"editable-form",2),e.bIt("submit",function(){return e.eBV(o),e.Njj(a.onSaveData())})("cancel",function(){return e.eBV(o),e.Njj(a.onCancel())}),e.j41(1,"tabs",3)(2,"tab",4),e.nrm(3,"preferencia-form-usuario",5,0),e.k0s(),e.j41(5,"tab",6),e.nrm(6,"preferencia-form-petrvs",7,1),e.k0s(),e.DNE(8,q,2,1,"tab",8),e.k0s()()}2&t&&(e.Y8G("form",a.form)("forceInvalid",a.forceInvalid)("title",a.isModal?"":a.title),e.R7$(2),e.Y8G("label",a.lex.translate("Usu\xe1rio")),e.R7$(),e.Y8G("usuarioId",a.auth.usuario.id),e.R7$(5),e.Y8G("ngIf",a.auth.entidade))},dependencies:[u.bT,r.Q,F.O,C.j,I,v]})}}return n})();var M=s(3535),O=s(204);function H(n,d){1&n&&(e.j41(0,"div",6)(1,"div",7),e.nrm(2,"span",8),e.k0s()())}const X=[{path:"",component:Q,canActivate:[f.q],resolve:{config:m.L},runGuardsAndResolvers:"always",data:{title:"Prefer\xeancias"}},{path:"usuario/:id",component:v,canActivate:[f.q],resolve:{config:m.L},runGuardsAndResolvers:"always",data:{title:"Prefer\xeancias do Usu\xe1rio"}},{path:"unidade/:id",component:(()=>{class n extends h.n{constructor(i){super(i,O.h,M.s),this.injector=i,this.etiquetas=!1,this.carregando=!1,this.toolbarButtons=[{label:"Resetar",icon:"bi bi-backspace",onClick:()=>{this.loading=!0,this.dao.update(this.usuarioId,{config:new c.$}).then(t=>{this.initializeData(this.form)}).finally(()=>{this.loading=!1})}}],this.validate=(t,a)=>null,this.form=this.fh.FormBuilder({etiquetas:{default:[]},etiqueta_texto:{default:""},etiqueta_icone:{default:null},etiqueta_cor:{default:null},theme:{default:null},ocultar_menu_sei:{default:!0},ocultar_container_petrvs:{default:!1}},this.cdRef,this.validate)}get isPanel(){return null!=this.panel}ngOnInit(){super.ngOnInit(),this.urlParams.get("id")&&(this.usuarioId=this.urlParams.get("id")),this.etiquetas=!!this.queryParams.etiquetas}loadData(i,t){return(0,l.A)(function*(){let a=Object.assign({},t.value);t.patchValue(a)})()}initializeData(i){var t=this;return(0,l.A)(function*(){t.carregando=!0;try{t.entity=yield t.dao.getById(t.usuarioId),yield t.loadData(t.entity,i)}finally{t.carregando=!1}})()}saveData(i){return new Promise((t,a)=>{let o=this.util.fill(new c.$,this.form.value);Promise.all([this.auth.updateUsuarioConfig(this.usuarioId,o),this.auth.updateUsuarioNotificacoes(this.usuarioId,this.entity.notificacoes)]).then(p=>{this.usuarioId==this.auth.usuario.id?this.auth.authSession().then(K=>t(!this.isPanel)).catch(a):t(!this.isPanel)}).catch(a)})}addItemHandleEtiquetas(){let i;const t=this.form.controls.etiqueta_texto.value,a=this.util.textHash(t);return t?.length&&this.util.validateLookupItem(this.form.controls.etiquetas.value,a)&&(i={key:a,value:this.form.controls.etiqueta_texto.value,color:this.form.controls.etiqueta_cor.value,icon:this.form.controls.etiqueta_icone.value},this.form.controls.etiqueta_texto.setValue(""),this.form.controls.etiqueta_icone.setValue(null),this.form.controls.etiqueta_cor.setValue(null)),i}static{this.\u0275fac=function(t){return new(t||n)(e.rXU(e.zZn))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-preferencia-form-unidade"]],viewQuery:function(t,a){if(1&t&&e.GBs(r.Q,5),2&t){let o;e.mGM(o=e.lsd())&&(a.editableForm=o.first)}},inputs:{panel:"panel",usuarioId:"usuarioId"},features:[e.Vt3],decls:7,vars:7,consts:[["class","d-flex justify-content-center",4,"ngIf"],[3,"buttons"],[3,"submit","cancel","title","form","disabled"],["display","","right",""],["key","ETIQUETAS","label","Etiquetas"],["key","ATRIBUICOES","label","Atribui\xe7\xf5es"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(t,a){1&t&&(e.DNE(0,H,3,0,"div",0),e.j41(1,"div"),e.nrm(2,"toolbar",1),e.j41(3,"editable-form",2),e.bIt("submit",function(){return a.onSaveData()})("cancel",function(){return a.onCancel()}),e.j41(4,"tabs",3),e.nrm(5,"tab",4)(6,"tab",5),e.k0s()()()),2&t&&(e.Y8G("ngIf",a.carregando),e.R7$(),e.AVh("d-none",a.carregando),e.R7$(),e.Y8G("buttons",a.toolbarButtons),e.R7$(),e.Y8G("title",a.isModal?"":a.title)("form",a.form)("disabled",a.formDisabled))},dependencies:[u.bT,y.H,r.Q,F.O,C.j]})}}return n})(),canActivate:[f.q],resolve:{config:m.L},runGuardsAndResolvers:"always",data:{title:"Prefer\xeancias da Unidade"}}];let _=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[b.iI.forChild(X),b.iI]})}}return n})();var x=s(9455),L=s(8832),Z=s(3756);let J=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[u.MD,x.h,L.X1,_,Z.UteisModule]})}}return n})()}}]);
"use strict";(self.webpackChunkpetrvs=self.webpackChunkpetrvs||[]).push([[6696],{6696:(W,T,i)=>{i.r(T),i.d(T,{TemplateModule:()=>k});var u=i(6610),v=i(8069),r=i(1620),m=i(6819),d=i(4492),g=i(7055),E=i(5611),I=i(9062),b=i(2736),t=i(3279),P=i(2034),M=i(5852),y=i(7772),D=i(2305),O=i(6764),p=i(1641),C=i(16),G=i(3678),L=i(5201),R=i(6336);function B(s,n){1&s&&t.nrm(0,"toolbar")}function A(s,n){if(1&s&&(t.j41(0,"small"),t.EFF(1),t.k0s(),t.nrm(2,"br")(3,"badge",14)(4,"badge",15)),2&s){const o=n.row,l=t.XpG();t.R7$(),t.JRh(o.titulo),t.R7$(2),t.Y8G("label",o.numero),t.R7$(),t.Y8G("icon",l.lookup.getIcon(l.lookup.TEMPLATE_ESPECIE,o.especie))("label",l.lookup.getValue(l.lookup.TEMPLATE_ESPECIE,o.especie))("color",l.lookup.getColor(l.lookup.TEMPLATE_ESPECIE,o.especie))}}function S(s,n){if(1&s&&(t.j41(0,"editable-form",16)(1,"div",2),t.nrm(2,"input-text",17),t.k0s(),t.j41(3,"div"),t.nrm(4,"input-editor",18),t.k0s()()),2&s){const o=t.XpG();t.Y8G("disabled",!0)("form",o.form),t.R7$(2),t.Y8G("size",12)("control",o.form.controls.titulo),t.BMQ("maxlength",250),t.R7$(2),t.Y8G("size",12)("control",o.form.controls.conteudo)}}function Y(s,n){1&s&&(t.j41(0,"div",19),t.EFF(1," Nenhum template selecionado "),t.k0s())}function F(s,n){if(1&s&&t.nrm(0,"toolbar",20),2&s){const o=t.XpG();t.Y8G("buttons",o.selectButtons)}}let $=(()=>{class s extends I.P{constructor(o){super(o,d.B,g.Q),this.injector=o,this.listagem=!1,this.selectButtons=[{color:"btn-outline-success",label:"Selecionar",icon:"bi-check-circle",disabled:()=>!this.selected,onClick:()=>this.onSelect(this.selected)},{color:"btn-outline-danger",label:"Cancelar",icon:"bi bi-dash-circle",onClick:()=>this.close()}],this._dataset=[],this.filterWhere=l=>{let e=[],a=l.value;if(this.listagem){this.addParams={especie:a.especie};const c=this.lookup.TEMPLATE_ESPECIE.find(f=>f.key===a.especie);this.title=this.lex.translate("Templates")+" - "+c?.value}return e.push(["especie","==",a.especie]),a.titulo?.length&&e.push(["titulo","like","%"+a.titulo.trim().replace(" ","%")+"%"]),e},this.templateService=o.get(b.I),this.title=this.lex.translate("Termos de Ci\xeancia e Responsabilidade"),this.code="MOD_TEMP",this.modalWidth=1200,this.filter=this.fh.FormBuilder({titulo:{default:""},especie:{default:"OUTRO"}}),this.form=this.fh.FormBuilder({titulo:{default:""},conteudo:{default:""}}),this.addOption(this.OPTION_INFORMACOES),this.addOption(this.OPTION_EXCLUIR,"MOD_TEMP_EXCL"),this.addOption(this.OPTION_LOGS,"MOD_AUDIT_LOG")}ngAfterViewInit(){super.ngAfterViewInit(),this.addParams={especie:this.filter?.controls.especie.value},"listagem"==this.queryParams.modo?(this.title=this.lex.translate("Templates")+" - OUTRO",this.listagem=!0,this.options=this.options.filter(o=>"Associar TCR"!==o.label)):this.auth.hasPermissionTo("MOD_TEMP_EDT")&&this.options.push({icon:"bi bi-check-all",label:"Associar TCR",onClick:(o=>this.go.navigate({route:["cadastros","template",o.id,"termos"]},{modalClose:l=>console.log(l?.conteudo)})).bind(this)})}onTemplateSelect(o){this.selected=o||void 0,this.form.patchValue({titulo:this.selected?.titulo||"",conteudo:this.selected?.conteudo||""}),this.cdRef.detectChanges()}static{this.\u0275fac=function(l){return new(l||s)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["app-template-list"]],viewQuery:function(l,e){if(1&l&&t.GBs(E._,5),2&l){let a;t.mGM(a=t.lsd())&&(e.grid=a.first)}},features:[t.Vt3],decls:20,vars:30,consts:[["columnTemplate",""],["noSelected",""],[1,"row"],[3,"ngClass"],[3,"select","dao","add","title","orderBy","groupBy","join","selectable","hasAdd","hasEdit"],[4,"ngIf"],[3,"deleted","form","where","submit","collapseChange","collapsed"],["label","Esp\xe9cie","controlName","especie",3,"size","items"],["label","T\xedtulo","controlName","titulo","placeholder","T\xedtulo ...",3,"size","control"],["title","Template",3,"template"],["type","options",3,"onEdit","options"],[3,"rows"],["noButtons","",3,"disabled","form",4,"ngIf","ngIfElse"],[3,"buttons",4,"ngIf"],["icon","bi bi-hash",3,"label"],[3,"icon","label","color"],["noButtons","",3,"disabled","form"],["label","T\xedtulo",3,"size","control"],["label","Pre-view do template",3,"size","control"],[1,"block","w-100","text-center"],[3,"buttons"]],template:function(l,e){if(1&l){const a=t.RV6();t.j41(0,"div",2)(1,"div",3)(2,"grid",4),t.bIt("select",function(f){return t.eBV(a),t.Njj(e.onTemplateSelect(f))}),t.DNE(3,B,1,0,"toolbar",5),t.j41(4,"filter",6)(5,"div",2),t.nrm(6,"input-select",7),t.k0s(),t.j41(7,"div",2),t.nrm(8,"input-text",8),t.k0s()(),t.j41(9,"columns")(10,"column",9),t.DNE(11,A,5,5,"ng-template",null,0,t.C5r),t.k0s(),t.nrm(13,"column",10),t.k0s(),t.nrm(14,"pagination",11),t.k0s()(),t.j41(15,"div",3),t.DNE(16,S,5,7,"editable-form",12)(17,Y,2,0,"ng-template",null,1,t.C5r),t.k0s()(),t.DNE(19,F,1,1,"toolbar",13)}if(2&l){const a=t.sdS(12),c=t.sdS(18);t.R7$(),t.Y8G("ngClass",e.listagem?"col-12":"col-4"),t.R7$(),t.Y8G("dao",e.dao)("add",e.add)("title",e.isModal?"":e.title)("orderBy",e.orderBy)("groupBy",e.groupBy)("join",e.join)("selectable",e.selectable)("hasAdd",e.auth.hasPermissionTo("MOD_TEMP_INCL"))("hasEdit",e.auth.hasPermissionTo("MOD_TEMP_EDT")),t.R7$(),t.Y8G("ngIf",!e.selectable),t.R7$(),t.Y8G("deleted",e.auth.hasPermissionTo("MOD_AUDIT_DEL"))("form",e.filter)("where",e.filterWhere)("submit",e.filterSubmit.bind(e))("collapseChange",e.filterCollapseChange.bind(e))("collapsed",!e.selectable&&e.filterCollapsed),t.R7$(2),t.Y8G("size",12)("items",e.lookup.TEMPLATE_ESPECIE),t.R7$(2),t.Y8G("size",12)("control",e.filter.controls.titulo),t.BMQ("maxlength",250),t.R7$(2),t.Y8G("template",a),t.R7$(3),t.Y8G("onEdit",e.edit)("options",e.options),t.R7$(),t.Y8G("rows",e.rowsLimit),t.R7$(),t.Y8G("ngClass",e.listagem?"d-none":"col-8"),t.R7$(),t.Y8G("ngIf",e.selected)("ngIfElse",c),t.R7$(3),t.Y8G("ngIf",e.selectable)}},dependencies:[u.YU,u.bT,E._,P.T,M.I,y.i,D.H,O.e,p.Q,C.H,G.K,L.n,R.p]})}}return s})();var j=i(3308),N=i(24),z=i(8857);let h=(()=>{class s extends N.n{constructor(o){super(o,d.B,g.Q),this.injector=o,this.dataset=[],this.validate=(l,e)=>null,this.templateService=o.get(b.I),this.modalWidth=1200,this.form=this.fh.FormBuilder({titulo:{default:""},especie:{default:"OUTRO"},conteudo:{default:""}},this.cdRef,this.validate)}loadData(o,l){var e=this;return(0,j.A)(function*(){let a=Object.assign({},l.value);l.patchValue(e.util.fillForm(a,o)),e.dataset=yield e.templateService.dataset(l.controls.especie.value)})()}initializeData(o){this.loadData(new d.B({especie:this.queryParams?.especie||"OUTRO"}),o)}saveData(o){return new Promise((l,e)=>{const a=this.util.fill(new d.B,this.entity);a.dataset=this.templateService.prepareDatasetToSave(this.dataset),l(this.util.fillForm(a,this.form.value))})}static{this.\u0275fac=function(l){return new(l||s)(t.rXU(t.zZn))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["app-template-form"]],viewQuery:function(l,e){if(1&l&&t.GBs(p.Q,5),2&l){let a;t.mGM(a=t.lsd())&&(e.editableForm=a.first)}},features:[t.Vt3],decls:7,vars:8,consts:[["initialFocus","titulo",3,"submit","cancel","form","disabled","title"],[1,"row"],["label","T\xedtulo","icon","bi bi-upc","controlName","titulo","required","",3,"size"],["disabled","","label","Esp\xe9cie","controlName","especie",3,"size","items"],["title","Design"],["controlName","conteudo",3,"dataset"]],template:function(l,e){1&l&&(t.j41(0,"editable-form",0),t.bIt("submit",function(){return e.onSaveData()})("cancel",function(){return e.onCancel()}),t.j41(1,"div",1),t.nrm(2,"input-text",2)(3,"input-select",3),t.k0s(),t.nrm(4,"separator",4),t.j41(5,"div",1),t.nrm(6,"input-editor",5),t.k0s()()),2&l&&(t.Y8G("form",e.form)("disabled",e.formDisabled)("title",e.isModal?"":e.title),t.R7$(2),t.Y8G("size",8),t.BMQ("maxlength",250),t.R7$(),t.Y8G("size",4)("items",e.lookup.TEMPLATE_ESPECIE),t.R7$(3),t.Y8G("dataset",e.dataset))},dependencies:[p.Q,C.H,G.K,z.F,R.p]})}}return s})();const Q=[{path:"",component:$,canActivate:[r.q],resolve:{config:m.L},runGuardsAndResolvers:"always",data:{title:"Template"}},{path:"new",component:h,canActivate:[r.q],resolve:{config:m.L},runGuardsAndResolvers:"always",data:{title:"Inclus\xe3o",modal:!0}},{path:":id/edit",component:h,canActivate:[r.q],resolve:{config:m.L},runGuardsAndResolvers:"always",data:{title:"Edi\xe7\xe3o",modal:!0}},{path:":id/consult",component:h,canActivate:[r.q],resolve:{config:m.L},runGuardsAndResolvers:"always",data:{title:"Consultar",modal:!0}}];let U=(()=>{class s{static{this.\u0275fac=function(l){return new(l||s)}}static{this.\u0275mod=t.$C({type:s})}static{this.\u0275inj=t.G2t({imports:[v.iI.forChild(Q),v.iI]})}}return s})();var V=i(9455),X=i(8832);let k=(()=>{class s{static{this.\u0275fac=function(l){return new(l||s)}}static{this.\u0275mod=t.$C({type:s})}static{this.\u0275inj=t.G2t({imports:[u.MD,V.h,X.X1,U]})}}return s})()}}]);
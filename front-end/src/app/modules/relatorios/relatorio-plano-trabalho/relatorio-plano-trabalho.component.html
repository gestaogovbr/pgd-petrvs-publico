<grid [dao]="dao" 
    [title]="title" 
    [orderBy]="orderBy"
    [relatorios]="relatorios"
>
    <toolbar *ngIf="!selectable"></toolbar>
    <filter 
        [form]="filter" 
        [where]="filterWhere" 
        [submit]="filterSubmit.bind(this)" 
        [filter]="onButtonFilterClick"
        [collapseChange]="filterCollapseChange.bind(this)" 
        [collapsed]="!selectable && filterCollapsed"
        filterLabel="Consultar"
    >
        <div class="row">   
            <input-search 
                #unidade 
                [size]="4" 
                label="Unidade de Consulta"
                [control]="filter!.controls.unidade_id" 
                controlName="unidade_id" 
                [dao]="unidadeDao"
            ></input-search>  
            <input-datetime
                [size]="2"
                date
                label="Data início de consulta"
                controlName="data_inicio"
                [control]="filter!.controls.data_inicio"
                labelInfo="Data início de consulta"
            ></input-datetime>
            <input-datetime
                [size]="2"
                date
                label="Data fim da consulta"
                controlName="data_fim"
                [control]="filter!.controls.data_fim"
                labelInfo="Data fim da consulta"
            ></input-datetime>
            <input-switch
                [size]="1"
                label="Somente vigentes"
                controlName="somente_vigentes"
                [control]="filter!.controls.somente_vigentes"
            ></input-switch>
            <input-switch
                [size]="1"
                label="Períodos avaliativos"
                controlName="incluir_periodos_avaliativos"
                [control]="filter!.controls.incluir_periodos_avaliativos"
            ></input-switch>
            <input-switch
                [size]="1"
                label="Unidades Subordinadas"
                controlName="incluir_unidades_subordinadas"
                [control]="filter!.controls.incluir_unidades_subordinadas"
            ></input-switch>
            <input-switch
                [size]="1"
                label="Exportar para Excel"
                controlName="exportar"
                [control]="filter!.controls.exportar"
            ></input-switch>
        </div>
    </filter>
    
    <columns>
        <column title="#ID" [template]="columnID">
            <ng-template let-row="row" #columnID>
                <span>#{{row.numero}}</span>
            </ng-template>
        </column>
        <column title="Nome" [template]="columnNome">
            <ng-template let-row="row" #columnNome>
                <span> {{row.participanteNome}}</span>
            </ng-template>
        </column>
        <column title="Unidade Executora" [template]="columnUnidade">
            <ng-template let-row="row" #columnUnidade>
                <span>{{row.unidadeHierarquia}}</span>
            </ng-template>
        </column>
        <column title="Distribuição % da CHD no período" [template]="columnCHD">
            <ng-template let-row="row" #columnCHD>
               <span>{{row.chd | number:'1.2-2'}}%</span>
            </ng-template>
        </column>
        <column title="Status do PT" [template]="columnStatus">
            <ng-template let-row="row" #columnStatus>
               <span>{{lookup.getValue(lookup.PLANO_TRABALHO_STATUS, row.status)}}</span>
            </ng-template>
        </column>
        <column title="Modalidade" [template]="columnModalidade">
            <ng-template let-row="row" #columnModalidade>
                <span>{{row.tipoModalidadeNome}}</span>
            </ng-template>
        </column>
        <column title="Início da Vigência" [template]="columnDataInicio">
            <ng-template let-row="row" #columnDataInicio>
                <span>{{dao!.getDateFormatted(row.dataInicio)}}</span>
            </ng-template>
        </column>
        <column title="Fim da Vigência" [template]="columnDataFim">
            <ng-template let-row="row" #columnDataFim>
                <span>{{dao!.getDateFormatted(row.dataFim)}}</span><br>
            </ng-template>
        </column>
        <column title="Duração (dias)" [template]="columnDuracao">
            <ng-template let-row="row" #columnDuracao>
                <span>{{getDuracao(row)}}</span>
            </ng-template>
        </column>
        <column title="Períodos Avaliativos" [template]="columnPeriodos">
            <ng-template let-row="row" #columnPeriodos>
                <span>{{row.qtdePeriodosAvaliativos}}</span>
            </ng-template>
        </column>
    </columns>
    <pagination [rows]="rowsLimit"></pagination>
</grid>
